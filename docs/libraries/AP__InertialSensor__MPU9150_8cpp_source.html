<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>APM:Libraries: libraries/AP_InertialSensor/AP_InertialSensor_MPU9150.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_f8d151dc119ef4d37afa003c944b490a.html">AP_InertialSensor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_InertialSensor_MPU9150.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__InertialSensor__MPU9150_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">   (at your option) any later version.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   GNU General Public License for more details.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    -- Coded by Victor Mayoral Vilches --    </span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">    The MPU9150 is a sensor composed by a MPU6050 with a AK8975 on the auxiliary bus.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    Please check the following links for datasheets and documentation:</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">     - http://www.invensense.com/mems/gyro/documents/PS-MPU-9150A-00v4_3.pdf</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">     - http://www.invensense.com/mems/gyro/documents/RM-MPU-9150A-00v4_2.pdf</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">     Note that this is an experimental driver. It is not used by any</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">     actively maintained board and should be considered untested and</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">     unmaintained </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_LINUX</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Math_8h.html">AP_Math/AP_Math.h</a>&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__InertialSensor__MPU9150_8h.html">AP_InertialSensor_MPU9150.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span>     </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">const</span> <span class="keyword">extern</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/* Hardware registers needed by driver. */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html">   41</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structgyro__reg__s.html">gyro_reg_s</a> {</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a5105c144ad70de19943e264b1671a5a3">   42</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a5105c144ad70de19943e264b1671a5a3">who_am_i</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#aa9665dd5f98f0ab1fa8dd9d49cac6e33">   43</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#aa9665dd5f98f0ab1fa8dd9d49cac6e33">rate_div</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a2fbc4dfe001c08050454013fc02c5917">   44</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a2fbc4dfe001c08050454013fc02c5917">lpf</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#ad2fc146348e140f7bc98f14e0f9582b3">   45</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#ad2fc146348e140f7bc98f14e0f9582b3">prod_id</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#abfa67633f34ad61dc8b049f3e9764597">   46</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#abfa67633f34ad61dc8b049f3e9764597">user_ctrl</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a9d153d2b62f23ad33f6531bbca3956e0">   47</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a9d153d2b62f23ad33f6531bbca3956e0">fifo_en</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a91fa10855a435daaf726596a270f73c7">   48</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a91fa10855a435daaf726596a270f73c7">gyro_cfg</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a351ff236fd8f4b03d3d5327ba9b404d0">   49</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a351ff236fd8f4b03d3d5327ba9b404d0">accel_cfg</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#aa05bd9bf4f6508fbdef797b1ae206938">   50</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#aa05bd9bf4f6508fbdef797b1ae206938">motion_thr</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a723318001cb72adfc5daf9bc1aecff86">   51</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a723318001cb72adfc5daf9bc1aecff86">motion_dur</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a8821cdf8b2299223a9624b7fceb8e179">   52</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a8821cdf8b2299223a9624b7fceb8e179">fifo_count_h</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#ae12c2ec2e53ae52ccdfc8367e9573b4d">   53</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#ae12c2ec2e53ae52ccdfc8367e9573b4d">fifo_r_w</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a8e23f0002123e85dabbb2dbb5d17fab2">   54</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a8e23f0002123e85dabbb2dbb5d17fab2">raw_gyro</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a4e9cb7e0d2dc9fcd51be96bcbbdca7e9">   55</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a4e9cb7e0d2dc9fcd51be96bcbbdca7e9">raw_accel</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#ae826075a0e49cf76af845eb392ca1851">   56</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#ae826075a0e49cf76af845eb392ca1851">temp</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#af5fb4da13709220b563f5ae8a05d37ba">   57</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#af5fb4da13709220b563f5ae8a05d37ba">int_enable</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a7407ed8aec197aad4b9613befb6857c9">   58</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a7407ed8aec197aad4b9613befb6857c9">dmp_int_status</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a72b6dabdecbec3f00b3c1a20eaef4810">   59</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a72b6dabdecbec3f00b3c1a20eaef4810">int_status</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a290248f218fb90c487662fb60a0d33af">   60</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a290248f218fb90c487662fb60a0d33af">pwr_mgmt_1</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#adf19c6b499b06d392f4080045d90a92d">   61</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#adf19c6b499b06d392f4080045d90a92d">pwr_mgmt_2</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a52914f852faf074f8f5bdbc9a6f84aca">   62</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a52914f852faf074f8f5bdbc9a6f84aca">int_pin_cfg</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#acfc9b08944d93a1ac3a751c2baf96144">   63</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#acfc9b08944d93a1ac3a751c2baf96144">mem_r_w</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#af644a91f58eada88f649d5f6efc06317">   64</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#af644a91f58eada88f649d5f6efc06317">accel_offs</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a5f57519bdd489e05e9d5f99dee9903c0">   65</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a5f57519bdd489e05e9d5f99dee9903c0">i2c_mst</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a82935af9a817fb2c2b8850759e9f327b">   66</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a82935af9a817fb2c2b8850759e9f327b">bank_sel</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#ac9d47249624e82c1c15e7fae0d955a43">   67</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#ac9d47249624e82c1c15e7fae0d955a43">mem_start_addr</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#aee9708ff734bc281199a2c634ed4f47d">   68</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#aee9708ff734bc281199a2c634ed4f47d">prgm_start_h</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#adf919bf6643e818626af9526aeb39dc7">   69</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#adf919bf6643e818626af9526aeb39dc7">raw_compass</a>;    </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a968100aa5430d13b981f5ba5aab8128e">   70</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a968100aa5430d13b981f5ba5aab8128e">yg_offs_tc</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a4a16ba1f22c43815c1e3d907e6884fa2">   71</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a4a16ba1f22c43815c1e3d907e6884fa2">s0_addr</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#ad306b1f181d82524d28e87b9b2468fdd">   72</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#ad306b1f181d82524d28e87b9b2468fdd">s0_reg</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a38e9b3512aa315aa89d1041326db5230">   73</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a38e9b3512aa315aa89d1041326db5230">s0_ctrl</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#aa23ab4b42d437f911e42533fc753f741">   74</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#aa23ab4b42d437f911e42533fc753f741">s1_addr</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a6aca99fdbfd8733e96efb15e376c0322">   75</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a6aca99fdbfd8733e96efb15e376c0322">s1_reg</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a9746eb3c4dec61b1ac1b72d3c6cf4161">   76</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a9746eb3c4dec61b1ac1b72d3c6cf4161">s1_ctrl</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a02fcae4a6abbed1a2a4df6509bae0abe">   77</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a02fcae4a6abbed1a2a4df6509bae0abe">s4_ctrl</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#ad3e839528cbb212c3a6c0a317056a874">   78</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#ad3e839528cbb212c3a6c0a317056a874">s0_do</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a8b45c71683751fcccc4e62444b197794">   79</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a8b45c71683751fcccc4e62444b197794">s1_do</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structgyro__reg__s.html#a77be9b868554b470258d381f6fe8886b">   80</a></span>&#160;    uint8_t <a class="code" href="structgyro__reg__s.html#a77be9b868554b470258d381f6fe8886b">i2c_delay_ctrl</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">/* Information specific to a particular device. */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structhw__s.html">   84</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structhw__s.html">hw_s</a> {</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">   85</a></span>&#160;    uint8_t <a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structhw__s.html#a312ce9d536eb33b8935f88fbff27c3f9">   86</a></span>&#160;    uint16_t <a class="code" href="structhw__s.html#a312ce9d536eb33b8935f88fbff27c3f9">max_fifo</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structhw__s.html#a7f691f3774df003d15e0057a69eb4134">   87</a></span>&#160;    uint8_t <a class="code" href="structhw__s.html#a7f691f3774df003d15e0057a69eb4134">num_reg</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structhw__s.html#ac122f7273d4b73c9a8502aeddbe5ceda">   88</a></span>&#160;    uint16_t <a class="code" href="structhw__s.html#ac122f7273d4b73c9a8502aeddbe5ceda">temp_sens</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structhw__s.html#a2d295ff25b6d4dec1e4d6178826b23b8">   89</a></span>&#160;    int16_t <a class="code" href="structhw__s.html#a2d295ff25b6d4dec1e4d6178826b23b8">temp_offset</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structhw__s.html#a5c4e53ba09a44e6c60b2afebd2ca6802">   90</a></span>&#160;    uint16_t <a class="code" href="structhw__s.html#a5c4e53ba09a44e6c60b2afebd2ca6802">bank_size</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="structhw__s.html#a7e350a511f9b39930cab72b9335d3bd7">   91</a></span>&#160;    uint16_t <a class="code" href="structhw__s.html#a7e350a511f9b39930cab72b9335d3bd7">compass_fsr</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;};</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/* Information for self-test. */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structtest__s.html">   95</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtest__s.html">test_s</a> {</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structtest__s.html#a17221653f7937a6292e3f47140749a3c">   96</a></span>&#160;    uint32_t <a class="code" href="structtest__s.html#a17221653f7937a6292e3f47140749a3c">gyro_sens</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structtest__s.html#a4fd144bd8bab0a20a9cdfbea796c800d">   97</a></span>&#160;    uint32_t <a class="code" href="structtest__s.html#a4fd144bd8bab0a20a9cdfbea796c800d">accel_sens</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="structtest__s.html#aa88c0e7ab03b2b3cffe6e071134fb9f5">   98</a></span>&#160;    uint8_t <a class="code" href="structtest__s.html#aa88c0e7ab03b2b3cffe6e071134fb9f5">reg_rate_div</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="structtest__s.html#abb244f04695aab154efa63c22f56b16a">   99</a></span>&#160;    uint8_t <a class="code" href="structtest__s.html#abb244f04695aab154efa63c22f56b16a">reg_lpf</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="structtest__s.html#a39b47c5b3de48bce1e59d7d2e775146d">  100</a></span>&#160;    uint8_t <a class="code" href="structtest__s.html#a39b47c5b3de48bce1e59d7d2e775146d">reg_gyro_fsr</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structtest__s.html#a575a358ff497db504dd248f5081ca639">  101</a></span>&#160;    uint8_t <a class="code" href="structtest__s.html#a575a358ff497db504dd248f5081ca639">reg_accel_fsr</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="structtest__s.html#ae3f2173d149c15cfdb50584506fd07af">  102</a></span>&#160;    uint16_t <a class="code" href="structtest__s.html#ae3f2173d149c15cfdb50584506fd07af">wait_ms</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structtest__s.html#a69790070177fd8d4403243f53d80df81">  103</a></span>&#160;    uint8_t <a class="code" href="structtest__s.html#a69790070177fd8d4403243f53d80df81">packet_thresh</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="structtest__s.html#afacfcf92f07cd846fb0aaf889a30c582">  104</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structtest__s.html#afacfcf92f07cd846fb0aaf889a30c582">min_dps</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="structtest__s.html#ae588d6c0105bcd8f9144f42eee6c4835">  105</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structtest__s.html#ae588d6c0105bcd8f9144f42eee6c4835">max_dps</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="structtest__s.html#a3b47b72fbf8c152cb4389e3cd866ded9">  106</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structtest__s.html#a3b47b72fbf8c152cb4389e3cd866ded9">max_gyro_var</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="structtest__s.html#ae86aec181d0f1e4a29e9f9ae0735e8e1">  107</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structtest__s.html#ae86aec181d0f1e4a29e9f9ae0735e8e1">min_g</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structtest__s.html#a9ebd3195ac2f460f82873b9e6c36eb2c">  108</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structtest__s.html#a9ebd3195ac2f460f82873b9e6c36eb2c">max_g</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="structtest__s.html#a7f6071fb91426f467d9223c712560ee6">  109</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="structtest__s.html#a7f6071fb91426f467d9223c712560ee6">max_accel_var</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;};</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">/* Gyro driver state variables. */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structgyro__state__s.html">  113</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structgyro__state__s.html">gyro_state_s</a> {</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">  114</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structgyro__reg__s.html">gyro_reg_s</a> *<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">  115</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structhw__s.html">hw_s</a> *<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="structgyro__state__s.html#a5a1563d12b0aab5e65317621742f6f62">  116</a></span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtest__s.html">test_s</a> *<a class="code" href="structgyro__state__s.html#a5a1563d12b0aab5e65317621742f6f62">test</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;};</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">/* Filter configurations. The values correspond to the DLPF_CFG register.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">Note that the gyro and accel frequencies are slightly different.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> (DLPF_CFG register, RM-MPU-9150A00.pdf, pg. 13)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9">  123</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9">lpf_e</a> {</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a9f0263fbbdccd3c5a18fcb65be278d24">  124</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a9f0263fbbdccd3c5a18fcb65be278d24">INV_FILTER_256HZ_NOLPF2</a> = 0,</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9ab58e52e0b6be4cbaf0c7f32705a9fcec">  125</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9ab58e52e0b6be4cbaf0c7f32705a9fcec">INV_FILTER_188HZ</a> = 1,</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a0f288da0c97b325a6cb57f1223f0cf98">  126</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a0f288da0c97b325a6cb57f1223f0cf98">INV_FILTER_98HZ</a> = 2,</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a995b18a52a5bd919aa9c1411a2292110">  127</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a995b18a52a5bd919aa9c1411a2292110">INV_FILTER_42HZ</a> = 3,</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9aebecb86604e475ed8e2cb68340010ff1">  128</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9aebecb86604e475ed8e2cb68340010ff1">INV_FILTER_20HZ</a> = 4,</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a327619f406c6b2f6a221793881013508">  129</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a327619f406c6b2f6a221793881013508">INV_FILTER_10HZ</a> = 5,</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9abdaaf85666fd6a490ee01dcd8a315678">  130</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9abdaaf85666fd6a490ee01dcd8a315678">INV_FILTER_5HZ</a> = 6,</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a76de97a6c2f8eb3c5d1a73d717513f5d">  131</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a76de97a6c2f8eb3c5d1a73d717513f5d">INV_FILTER_2100HZ_NOLPF</a> = 7,</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a053f39f04904f6103090bcba3002c4a3">  132</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a053f39f04904f6103090bcba3002c4a3">NUM_FILTER</a></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;};</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/* Full scale ranges. FS_SEL register.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> (RM-MPU-9150A00.pdf, pg. 14)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90">  138</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90">gyro_fsr_e</a> {</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a5b8251a49db5cb8a676076b0b308ae35">  139</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a5b8251a49db5cb8a676076b0b308ae35">INV_FSR_250DPS</a> = 0,</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a50901470ff389927fd010081e2b8fd09">  140</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a50901470ff389927fd010081e2b8fd09">INV_FSR_500DPS</a> = 1,</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90aee922e0daa4fbb404c3db6c49d897a13">  141</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90aee922e0daa4fbb404c3db6c49d897a13">INV_FSR_1000DPS</a> = 2,</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90ac0c37efc1c8acd6f70c0c5a768e5b8be">  142</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90ac0c37efc1c8acd6f70c0c5a768e5b8be">INV_FSR_2000DPS</a> = 3,</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90ab50b300433c5bc3cbc7ae8adb980c815">  143</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90ab50b300433c5bc3cbc7ae8adb980c815">NUM_GYRO_FSR</a></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;};</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/* Full scale ranges. AFS_SEL register.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> (RM-MPU-9150A00.pdf, pg. 15)</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81e">  149</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81e">accel_fsr_e</a> {</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eae27c6f69463dab7de81fac0c51ff8aa7">  150</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eae27c6f69463dab7de81fac0c51ff8aa7">INV_FSR_2G</a> = 0,</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eaa91e3a89d0bbd01149fe71148595be6d">  151</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eaa91e3a89d0bbd01149fe71148595be6d">INV_FSR_4G</a> = 1,</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea0a40371bdda397d234c53d0ee2f3be8b">  152</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea0a40371bdda397d234c53d0ee2f3be8b">INV_FSR_8G</a> = 2,</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea6712e8563c97c11b458ef721d4f5f9d5">  153</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea6712e8563c97c11b458ef721d4f5f9d5">INV_FSR_16G</a> = 4,</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea6d466b2f73b176f1dfc8a3f94ae8a4df">  154</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea6d466b2f73b176f1dfc8a3f94ae8a4df">NUM_ACCEL_FSR</a></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;};</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">/* Clock sources. */</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207">  158</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207">clock_sel_e</a> {</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a92059acf8d0ff5b7e12580c15f88466f">  159</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a92059acf8d0ff5b7e12580c15f88466f">INV_CLK_INTERNAL</a> = 0,</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a01b240917a78674d3e387110a6a8f94c">  160</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a01b240917a78674d3e387110a6a8f94c">INV_CLK_PLL</a>,</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a7f075b0360037232fdf24f90de7be1d7">  161</a></span>&#160;    <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a7f075b0360037232fdf24f90de7be1d7">NUM_CLK</a></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;};</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a918c48fc034885089b181da782294c63">  164</a></span>&#160;<span class="preprocessor">#define MPU9150_ADDRESS                  0x68</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#abf02bf28541421d59f8be764f2b95407">  166</a></span>&#160;<span class="preprocessor">#define INV_X_GYRO      (0x40)</span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#acdd8ff833a34dba08ca2aa145eb92b44">  167</a></span>&#160;<span class="preprocessor">#define INV_Y_GYRO      (0x20)</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a50205b5cc6089b33b2561c854eb8b0fd">  168</a></span>&#160;<span class="preprocessor">#define INV_Z_GYRO      (0x10)</span></div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a3fdc30f9c0a26c2c4e2bb88921f91629">  169</a></span>&#160;<span class="preprocessor">#define INV_XYZ_GYRO    (INV_X_GYRO | INV_Y_GYRO | INV_Z_GYRO)</span></div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aa03f025a17ed491e70b88274e89c75c5">  170</a></span>&#160;<span class="preprocessor">#define INV_XYZ_ACCEL   (0x08)</span></div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a7fc9c1dbdcb2ac8cc2a4128a5799482a">  171</a></span>&#160;<span class="preprocessor">#define INV_XYZ_COMPASS (0x01)</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a0cddf0dffaf3bf65fd3ed92dda4f3193">  173</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DATA_READY       (0x0001)</span></div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a380dd1ef256931e99302c371ad7752f4">  174</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DMP              (0x0002)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aa38d7976e86186bf353cb89ca7561f29">  175</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_PLL_READY        (0x0004)</span></div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a5755e84f3a2e7d331f7612dbfea18ecc">  176</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_I2C_MST          (0x0008)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#af8e1684698ad837d0318a72b1ef73b13">  177</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_FIFO_OVERFLOW    (0x0010)</span></div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ad5eee7ff393f842ca4ae969cc0019030">  178</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_ZMOT             (0x0020)</span></div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aa1ab51fb5995e568edd425f8486cb2c8">  179</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_MOT              (0x0040)</span></div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a000cfa5230cb895c6bad322856465552">  180</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_FREE_FALL        (0x0080)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a2398e82f93220e3cfa1ef31bfb6d76bd">  181</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DMP_0            (0x0100)</span></div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a5ac2e94db5083456fa531fceee0997f5">  182</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DMP_1            (0x0200)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ab7543433b9679174597e00e5d7cb6279">  183</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DMP_2            (0x0400)</span></div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aea5cac4528bb19757de4eb4fa46a374f">  184</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DMP_3            (0x0800)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a4345dc987e1b65ef8ddc6160f592e144">  185</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DMP_4            (0x1000)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a101643480b83c302a4a3089fe9149e8e">  186</a></span>&#160;<span class="preprocessor">#define MPU_INT_STATUS_DMP_5            (0x2000)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ac52d7caf4efc485ef6faa1211bfe60dc">  188</a></span>&#160;<span class="preprocessor">#define BIT_I2C_MST_VDDIO   (0x80)</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ae3c4a18accb84992faaf2534a84a147c">  189</a></span>&#160;<span class="preprocessor">#define BIT_FIFO_EN         (0x40)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a02c3e9ddd63128f1c3cf50bf1e9b5fe6">  190</a></span>&#160;<span class="preprocessor">#define BIT_DMP_EN          (0x80)</span></div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#aeae2cc64314ad05f3a93d2358a2369db">  191</a></span>&#160;<span class="preprocessor">#define BIT_FIFO_RST        (0x04)</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a37d5ceb74c3568e4bab6dcdd0afaa95b">  192</a></span>&#160;<span class="preprocessor">#define BIT_DMP_RST         (0x08)</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#afb9b49ce5dd973b3c29ae72680924fa7">  193</a></span>&#160;<span class="preprocessor">#define BIT_FIFO_OVERFLOW   (0x10)</span></div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a45eec9dbc46778c356703dcf90b9e0c3">  194</a></span>&#160;<span class="preprocessor">#define BIT_DATA_RDY_EN     (0x01)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a4dc5309ed09fc683d8e5a247feaad69d">  195</a></span>&#160;<span class="preprocessor">#define BIT_DMP_INT_EN      (0x02)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a6a8f2f7f3dd17bc05d9c6286d15c7ada">  196</a></span>&#160;<span class="preprocessor">#define BIT_MOT_INT_EN      (0x40)</span></div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a2d9aff1be96b1fc021ca96f251c3e72b">  197</a></span>&#160;<span class="preprocessor">#define BITS_FSR            (0x18)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a4d83411e736da86163a61828816a200a">  198</a></span>&#160;<span class="preprocessor">#define BITS_LPF            (0x07)</span></div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a3c9c0234d4a71c9d35bb0da64ea867eb">  199</a></span>&#160;<span class="preprocessor">#define BITS_HPF            (0x07)</span></div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a1823f90ac353cf4cde25d297a8627dd4">  200</a></span>&#160;<span class="preprocessor">#define BITS_CLK            (0x07)</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a3769fd3fa71deaef1e77ce14c26f679d">  201</a></span>&#160;<span class="preprocessor">#define BIT_FIFO_SIZE_1024  (0x40)</span></div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a0fa95b278851b0c05a9995f65ba2b895">  202</a></span>&#160;<span class="preprocessor">#define BIT_FIFO_SIZE_2048  (0x80)</span></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ac067df9d789eaae04585abfc5ffdb2b6">  203</a></span>&#160;<span class="preprocessor">#define BIT_FIFO_SIZE_4096  (0xC0)</span></div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#af4ce49fd1fc9b1461b5241f9ef4812f4">  204</a></span>&#160;<span class="preprocessor">#define BIT_RESET           (0x80)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a1fed8bd436e9b7dfccb1cae99ca89103">  205</a></span>&#160;<span class="preprocessor">#define BIT_SLEEP           (0x40)</span></div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ac4b33689dd697c1cf2411638a017c009">  206</a></span>&#160;<span class="preprocessor">#define BIT_S0_DELAY_EN     (0x01)</span></div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a22e4452fe8abca7fe12a2dc45194e6df">  207</a></span>&#160;<span class="preprocessor">#define BIT_S2_DELAY_EN     (0x04)</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#abc5c2ee59baeb02a0f761740466f3c28">  208</a></span>&#160;<span class="preprocessor">#define BITS_SLAVE_LENGTH   (0x0F)</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a5e8f3ccff1b3eeb95a938b207ca873ff">  209</a></span>&#160;<span class="preprocessor">#define BIT_SLAVE_BYTE_SW   (0x40)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#af616c3ecf97ffd7bde444f0b74e7453e">  210</a></span>&#160;<span class="preprocessor">#define BIT_SLAVE_GROUP     (0x10)</span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ae9440f48b6d70d900366dc040a8714d7">  211</a></span>&#160;<span class="preprocessor">#define BIT_SLAVE_EN        (0x80)</span></div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a8ef1963ec6fb3df5586e50959cf00a70">  212</a></span>&#160;<span class="preprocessor">#define BIT_I2C_READ        (0x80)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#ab470b625fa05ff228b3fdb94802b1c0d">  213</a></span>&#160;<span class="preprocessor">#define BITS_I2C_MASTER_DLY (0x1F)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#abcdedbd3098140aa14ad17bcaca8e176">  214</a></span>&#160;<span class="preprocessor">#define BIT_AUX_IF_EN       (0x20)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a8467782bedc44051c95643e303543655">  215</a></span>&#160;<span class="preprocessor">#define BIT_ACTL            (0x80)</span></div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a588b5a95724c4a68c6868faa78fd3a7f">  216</a></span>&#160;<span class="preprocessor">#define BIT_LATCH_EN        (0x20)</span></div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a1f50796ca0363292d9ac9cc1d29d9225">  217</a></span>&#160;<span class="preprocessor">#define BIT_ANY_RD_CLR      (0x10)</span></div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#add12a8d89e1a4c4e008b12a96dd4c75d">  218</a></span>&#160;<span class="preprocessor">#define BIT_BYPASS_EN       (0x02)</span></div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a75b1479e451b747afb3b24cbc4df99f7">  219</a></span>&#160;<span class="preprocessor">#define BITS_WOM_EN         (0xC0)</span></div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a63e6f23af37626aa1498d8c248f259e7">  220</a></span>&#160;<span class="preprocessor">#define BIT_LPA_CYCLE       (0x20)</span></div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#acfc46ee2ea036d16b3df45c8fb241b5b">  221</a></span>&#160;<span class="preprocessor">#define BIT_STBY_XA         (0x20)</span></div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a49e6d38569bfc4b58ccc45dbb19001fa">  222</a></span>&#160;<span class="preprocessor">#define BIT_STBY_YA         (0x10)</span></div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#afac8114288bae2db7ea7dbf0f6fb755c">  223</a></span>&#160;<span class="preprocessor">#define BIT_STBY_ZA         (0x08)</span></div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a82256fedeffe5b2443ab3ae34cf032d9">  224</a></span>&#160;<span class="preprocessor">#define BIT_STBY_XG         (0x04)</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#abf1c0a844906a5e887a659971a4af417">  225</a></span>&#160;<span class="preprocessor">#define BIT_STBY_YG         (0x02)</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a30967a4efdf3c3f1e39814e72a4168b0">  226</a></span>&#160;<span class="preprocessor">#define BIT_STBY_ZG         (0x01)</span></div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a04a57159e34387dafe9b86b171c4654c">  227</a></span>&#160;<span class="preprocessor">#define BIT_STBY_XYZA       (BIT_STBY_XA | BIT_STBY_YA | BIT_STBY_ZA)</span></div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a4e2ef22b94b90f9b83394dfe1f688ce4">  228</a></span>&#160;<span class="preprocessor">#define BIT_STBY_XYZG       (BIT_STBY_XG | BIT_STBY_YG | BIT_STBY_ZG)</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">// AK8975_SECONDARY</span></div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a23d89b226ebcb340dd8f6483024c0966">  230</a></span>&#160;<span class="preprocessor">#define SUPPORTS_AK89xx_HIGH_SENS   (0x00)</span></div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#abf6b94b644d324f4389c652bfd875ce7">  231</a></span>&#160;<span class="preprocessor">#define AK89xx_FSR                  (9830)</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a227dd94fe4db261a37a8c6d5119cf6ec">  232</a></span>&#160;<span class="preprocessor">#define MAX_COMPASS_SAMPLE_RATE (100)</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">// Gyroscope scale (uncertain where the 0.01745 value comes from)</span></div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a5ae2d167ada156e125ef1697ea98a507">  235</a></span>&#160;<span class="preprocessor">#define MPU9150_GYRO_SCALE_2000  (0.0174532f / 16.4f)</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a733d5e162b9d8e87a3fdebcd589730b1">  236</a></span>&#160;<span class="preprocessor">#define MPU9150_GYRO_SCALE_1000  (0.0174532f / 32.8f)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a64b70b7fc108f97bf6d6fd815d650329">  237</a></span>&#160;<span class="preprocessor">#define MPU9150_GYRO_SCALE_500  (0.0174532f / 65.5f)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a60ee57d49e91892ba1849306f714993c">  238</a></span>&#160;<span class="preprocessor">#define MPU9150_GYRO_SCALE_250  (0.0174532f / 131f)</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">// Accelerometer scale adjustment</span></div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a09e599a19098f75d4a10b92e1aacd7ff">  241</a></span>&#160;<span class="preprocessor">#define MPU9150_ACCEL_SCALE_16G    (GRAVITY_MSS / 2048.0f)</span></div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a9c1a6d0937c2cb3a22c2e18d0fa3336b">  242</a></span>&#160;<span class="preprocessor">#define MPU9150_ACCEL_SCALE_8G    (GRAVITY_MSS / 4096.0f)</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a98fa99e55a2e046b1cebed9a5b65f1f6">  243</a></span>&#160;<span class="preprocessor">#define MPU9150_ACCEL_SCALE_4G    (GRAVITY_MSS / 8192.0f)</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a7872c2553e37dc476923725add0259b0">  244</a></span>&#160;<span class="preprocessor">#define MPU9150_ACCEL_SCALE_2G    (GRAVITY_MSS / 16384.0f)</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a5448c351fc95ff052b110eee80e5f75c">  247</a></span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structgyro__reg__s.html">gyro_reg_s</a> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a5448c351fc95ff052b110eee80e5f75c">reg</a> = {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">/*    .who_am_i      */</span> 0x75,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">/*    .rate_div      */</span> 0x19,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">/*    .lpf           */</span> 0x1A,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">/*    .prod_id       */</span> 0x0C,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">/*    .user_ctrl     */</span> 0x6A,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">/*    .fifo_en       */</span> 0x23,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">/*    .gyro_cfg      */</span> 0x1B,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">/*    .accel_cfg     */</span> 0x1C,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">/*    .motion_thr    */</span> 0x1F,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">/*    .motion_dur    */</span> 0x20,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">/*    .fifo_count_h  */</span> 0x72,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/*    .fifo_r_w      */</span> 0x74,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/*    .raw_gyro      */</span> 0x43,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">/*    .raw_accel     */</span> 0x3B,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">/*    .temp          */</span> 0x41,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/*    .int_enable    */</span> 0x38,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/*    .dmp_int_status*/</span> 0x39,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">/*    .int_status    */</span> 0x3A,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">/*    .pwr_mgmt_1    */</span> 0x6B,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">/*    .pwr_mgmt_2    */</span> 0x6C,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">/*    .int_pin_cfg   */</span> 0x37,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/*    .mem_r_w       */</span> 0x6F,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">/*    .accel_offs    */</span> 0x06,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">/*    .i2c_mst       */</span> 0x24,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">/*    .bank_sel      */</span> 0x6D,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">/*    .mem_start_addr*/</span> 0x6E,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">/*    .prgm_start_h  */</span> 0x70,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">/*    .raw_compass   */</span> 0x49,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">/*    .yg_offs_tc    */</span> 0x01,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">/*    .s0_addr       */</span> 0x25,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">/*    .s0_reg        */</span> 0x26,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">/*    .s0_ctrl       */</span> 0x27,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">/*    .s1_addr       */</span> 0x28,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">/*    .s1_reg        */</span> 0x29,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">/*    .s1_ctrl       */</span> 0x2A,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">/*    .s4_ctrl       */</span> 0x34,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">/*    .s0_do         */</span> 0x63,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">/*    .s1_do         */</span> 0x64,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">/*    .i2c_delay_ctrl*/</span> 0x67</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;};</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a7fefd0bb47e09b7e39e25e9795cd7edc">  289</a></span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structhw__s.html">hw_s</a> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a7fefd0bb47e09b7e39e25e9795cd7edc">hw</a> = {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">/*    .addr          */</span> 0x68,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">/*    .max_fifo      */</span> 1024,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">/*    .num_reg       */</span> 118,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">/*    .temp_sens     */</span> 340,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">/*    .temp_offset   */</span> -521,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/*    .bank_size     */</span> 256,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">/*    .compass_fsr   */</span> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#abf6b94b644d324f4389c652bfd875ce7">AK89xx_FSR</a></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;};</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a1e8f8b1ef7fb2c429e1ce7c2f9985530">  300</a></span>&#160;<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structtest__s.html">test_s</a> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a1e8f8b1ef7fb2c429e1ce7c2f9985530">test</a> = {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">/*    .gyro_sens     */</span> 32768/250,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">/*    .accel_sens    */</span> 32768/16,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/*    .reg_rate_div  */</span> 0,    <span class="comment">/* 1kHz. */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">/*    .reg_lpf       */</span> 1,    <span class="comment">/* 188Hz. */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">/*    .reg_gyro_fsr  */</span> 0,    <span class="comment">/* 250dps. */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">/*    .reg_accel_fsr */</span> 0x18, <span class="comment">/* 16g. */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">/*    .wait_ms       */</span> 50,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">/*    .packet_thresh */</span> 5,    <span class="comment">/* 5% */</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">/*    .min_dps       */</span> 10.f,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">/*    .max_dps       */</span> 105.f,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">/*    .max_gyro_var  */</span> 0.14f,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">/*    .min_g         */</span> 0.3f,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">/*    .max_g         */</span> 0.95f,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/*    .max_accel_var */</span> 0.14f</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;};</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="AP__InertialSensor__MPU9150_8cpp.html#a3854b4875f6db26c2a1a707885f1fc78">  317</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structgyro__state__s.html">gyro_state_s</a> <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a3854b4875f6db26c2a1a707885f1fc78">st</a> = {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">/*    .reg  */</span> &amp;<a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a5448c351fc95ff052b110eee80e5f75c">reg</a>,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">/*    .hw   */</span> &amp;<a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a7fefd0bb47e09b7e39e25e9795cd7edc">hw</a>,    </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">/*    .test */</span> &amp;test</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;};</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#abd0991b19af2539ec6e38357ef89bbad">  327</a></span>&#160;<a class="code" href="classAP__InertialSensor__MPU9150.html#abd0991b19af2539ec6e38357ef89bbad">AP_InertialSensor_MPU9150::AP_InertialSensor_MPU9150</a>(<a class="code" href="classAP__InertialSensor.html">AP_InertialSensor</a> &amp;imu) :</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="classAP__InertialSensor__Backend.html">AP_InertialSensor_Backend</a>(imu),</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    _have_sample_available(false),</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    _accel_filter(800, 10),</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    _gyro_filter(800, 10)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;{</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  detect the sensor</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a5ccaed9383c0dd4ba0450d690f2284b7">  339</a></span>&#160;<a class="code" href="classAP__InertialSensor__Backend.html">AP_InertialSensor_Backend</a> *<a class="code" href="classAP__InertialSensor__MPU9150.html#a5ccaed9383c0dd4ba0450d690f2284b7">AP_InertialSensor_MPU9150::detect</a>(<a class="code" href="classAP__InertialSensor.html">AP_InertialSensor</a> &amp;_imu)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html">AP_InertialSensor_MPU9150</a> *sensor = <span class="keyword">new</span> <a class="code" href="classAP__InertialSensor__MPU9150.html#abd0991b19af2539ec6e38357ef89bbad">AP_InertialSensor_MPU9150</a>(_imu);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (sensor == NULL) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (!sensor-&gt;<a class="code" href="classAP__InertialSensor__MPU9150.html#a5d916ede262de822fd6ab45c93e036ae">_init_sensor</a>()) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keyword">delete</span> sensor;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">return</span> sensor;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">  set the accel filter frequency</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#ab3866dd1e3527673f3aece3794eafd43">  355</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__InertialSensor__MPU9150.html#ab3866dd1e3527673f3aece3794eafd43">AP_InertialSensor_MPU9150::_set_accel_filter_frequency</a>(uint8_t filter_hz)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#a5f88576fe84b4acb03075b6b990b5b6b">_accel_filter</a>.<a class="code" href="classLowPassFilter2p.html#ac6157f65625e34dec2f7af4474dfb923">set_cutoff_frequency</a>(800, filter_hz);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  set the gyro filter frequency</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a11920de68c6ceee367d640799239bb32">  363</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__InertialSensor__MPU9150.html#a11920de68c6ceee367d640799239bb32">AP_InertialSensor_MPU9150::_set_gyro_filter_frequency</a>(uint8_t filter_hz)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#ace4b074c075fdd99482af65c8b8de98b">_gyro_filter</a>.<a class="code" href="classLowPassFilter2p.html#ac6157f65625e34dec2f7af4474dfb923">set_cutoff_frequency</a>(800, filter_hz);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a5d916ede262de822fd6ab45c93e036ae">  371</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__InertialSensor__MPU9150.html#a5d916ede262de822fd6ab45c93e036ae">AP_InertialSensor_MPU9150::_init_sensor</a>(<span class="keywordtype">void</span>) </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// Sensors pushed to the FIFO.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    uint8_t sensors;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// get pointer to i2c bus semaphore</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="classAP__HAL_1_1Semaphore.html">AP_HAL::Semaphore</a>* i2c_sem = hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a373424b46be08ef36d53844f88b5398e">get_semaphore</a>();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// take i2c bus sempahore</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> (!i2c_sem-&gt;<a class="code" href="classAP__HAL_1_1Semaphore.html#abd3a0affad8bb211981a979f30386589">take</a>(<a class="code" href="Semaphores_8h.html#ad664d2e6bf70a9194d608eb555dbcf8b">HAL_SEMAPHORE_BLOCK_FOREVER</a>)){</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }        </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// Init the sensor</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">//  Reset the device</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                           st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a290248f218fb90c487662fb60a0d33af">pwr_mgmt_1</a>, </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                           <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#af4ce49fd1fc9b1461b5241f9ef4812f4">BIT_RESET</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">delay</a>(100);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">//  Wake up the chip</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                           st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a290248f218fb90c487662fb60a0d33af">pwr_mgmt_1</a>, </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                           0x00);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// Check product revision</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">//  This registers are not documented in the register map.</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    uint8_t buff[6];</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span> (hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a5826f44fd0ab5a87db1c14f5a3d55561">readRegisters</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#af644a91f58eada88f649d5f6efc06317">accel_offs</a>, 6, buff) != 0) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1UARTDriver.html#a65c7824b8877f7a2f79365c8ffae8f56">printf</a>(<span class="stringliteral">&quot;AP_InertialSensor_MPU9150: couldn&#39;t read the registers to determine revision&quot;</span>);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">goto</span> failed;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }    </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// uint8_t rev;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// rev = ((buff[5] &amp; 0x01) &lt;&lt; 2) | ((buff[3] &amp; 0x01) &lt;&lt; 1) |</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">//     (buff[1] &amp; 0x01);</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// Do not do the checking, for some reason the MPU-9150 returns 0</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">// if (rev) {        </span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">//     if (rev == 1){</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">//         /* Congrats, these parts are better. */</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">//         ;</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">//     else if (rev == 2){</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">//         ;</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">//     else {</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">//         hal.scheduler-&gt;panic(&quot;AP_InertialSensor_MPU9150: Unsupported software product rev.\n&quot;);</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">//         goto failed;</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// } else {</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">//         hal.scheduler-&gt;panic(&quot;Product ID read as 0 indicates device is either incompatible or an MPU3050.\n&quot;);</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">//         goto failed;            </span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// Set gyro full-scale range [250, 500, 1000, 2000]</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#ac5ee90a87aaa7360d3f2d11f2a981726">mpu_set_gyro_fsr</a>(2000)){</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1UARTDriver.html#a65c7824b8877f7a2f79365c8ffae8f56">printf</a>(<span class="stringliteral">&quot;AP_InertialSensor_MPU9150: mpu_set_gyro_fsr.\n&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">goto</span> failed;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// Set the accel full-scale range</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#a2ec9ed7e9e69228c1b049f8a581312a7">mpu_set_accel_fsr</a>(2)){</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1UARTDriver.html#a65c7824b8877f7a2f79365c8ffae8f56">printf</a>(<span class="stringliteral">&quot;AP_InertialSensor_MPU9150: mpu_set_accel_fsr.\n&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">goto</span> failed;    </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// Set digital low pass filter to 256Hz (DLPF disabled)</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#a1815cc1868c7c9e92c68e414cc1c8368">mpu_set_lpf</a>(256)) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1UARTDriver.html#a65c7824b8877f7a2f79365c8ffae8f56">printf</a>(<span class="stringliteral">&quot;AP_InertialSensor_MPU9150: mpu_set_lpf.\n&quot;</span>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">goto</span> failed;    </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// Set sampling rate (value must be between 4Hz and 1KHz)</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#a698a91c16b9e1e1639bb8981654bcf07">mpu_set_sample_rate</a>(800)){</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1UARTDriver.html#a65c7824b8877f7a2f79365c8ffae8f56">printf</a>(<span class="stringliteral">&quot;AP_InertialSensor_MPU9150: mpu_set_sample_rate.\n&quot;</span>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">goto</span> failed;    </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// Select which sensors are pushed to FIFO.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    sensors = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aa03f025a17ed491e70b88274e89c75c5">INV_XYZ_ACCEL</a>| <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a3fdc30f9c0a26c2c4e2bb88921f91629">INV_XYZ_GYRO</a>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#adcb93c24e742a509d7a3a83b49a12f94">mpu_configure_fifo</a>(sensors)){</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1UARTDriver.html#a65c7824b8877f7a2f79365c8ffae8f56">printf</a>(<span class="stringliteral">&quot;AP_InertialSensor_MPU9150: mpu_configure_fifo.\n&quot;</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">goto</span> failed;    </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// For now the compass is not used.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">// TODO adjust the functions to the ArduPilot API</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// setup_compass();</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// if (mpu_set_compass_sample_rate(10, 400))</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">//     return -1;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#a6e1dbb9ed5a2d759db59071da683b0fc">mpu_set_sensors</a>(sensors);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// Set the filter frecuency</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#ab3866dd1e3527673f3aece3794eafd43">_set_accel_filter_frequency</a>(<a class="code" href="classAP__InertialSensor__Backend.html#aa7fdfb9c9f28d883fbb109e13ded7f0f">_accel_filter_cutoff</a>());</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#a11920de68c6ceee367d640799239bb32">_set_gyro_filter_frequency</a>(<a class="code" href="classAP__InertialSensor__Backend.html#a9c376bd62d2a8e0262f887c6188d0af9">_gyro_filter_cutoff</a>());</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// give back i2c semaphore</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    i2c_sem-&gt;<a class="code" href="classAP__HAL_1_1Semaphore.html#afcdbf03d5bea9d83037acc93bfaea7ce">give</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#afdee893667354cb864fc58513cf53a72">_gyro_instance</a> = <a class="code" href="classAP__InertialSensor__Backend.html#a7bd7b202f34666e99378d209e1b87537">_imu</a>.<a class="code" href="classAP__InertialSensor.html#addd35f196d6b741c06453716f7bd9091">register_gyro</a>();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#a6ddc4d553b5ec3843d937e63ad77a08c">_accel_instance</a> = <a class="code" href="classAP__InertialSensor__Backend.html#a7bd7b202f34666e99378d209e1b87537">_imu</a>.<a class="code" href="classAP__InertialSensor.html#abcc47a3b7a03a08178904fd0aec0ee96">register_accel</a>();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// start the timer process to read samples    </span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#ac2c4230957d5dbd3c2fd104af2794b4f">register_timer_process</a>(<a class="code" href="functor_8h.html#a00e5874203cecc310017f9166f2c0e36">FUNCTOR_BIND_MEMBER</a>(&amp;<a class="code" href="classAP__InertialSensor__MPU9150.html#aabb66a96ba3568bc39fcb2ed8381e06d">AP_InertialSensor_MPU9150::_accumulate</a>, <span class="keywordtype">void</span>));</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;failed:</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// give back i2c semaphore</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    i2c_sem-&gt;<a class="code" href="classAP__HAL_1_1Semaphore.html#afcdbf03d5bea9d83037acc93bfaea7ce">give</a>();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#ac5ee90a87aaa7360d3f2d11f2a981726">  487</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#ac5ee90a87aaa7360d3f2d11f2a981726">AP_InertialSensor_MPU9150::mpu_set_gyro_fsr</a>(uint16_t fsr)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    uint8_t data;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">switch</span> (fsr) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">case</span> 250:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a5b8251a49db5cb8a676076b0b308ae35">INV_FSR_250DPS</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">case</span> 500:</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a50901470ff389927fd010081e2b8fd09">INV_FSR_500DPS</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">case</span> 1000:</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90aee922e0daa4fbb404c3db6c49d897a13">INV_FSR_1000DPS</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">case</span> 2000:</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90ac0c37efc1c8acd6f70c0c5a768e5b8be">INV_FSR_2000DPS</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                           st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a91fa10855a435daaf726596a270f73c7">gyro_cfg</a>,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                           data);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a2ec9ed7e9e69228c1b049f8a581312a7">  519</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a2ec9ed7e9e69228c1b049f8a581312a7">AP_InertialSensor_MPU9150::mpu_set_accel_fsr</a>(uint8_t fsr)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;{</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    uint8_t data;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">switch</span> (fsr) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eae27c6f69463dab7de81fac0c51ff8aa7">INV_FSR_2G</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eaa91e3a89d0bbd01149fe71148595be6d">INV_FSR_4G</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea0a40371bdda397d234c53d0ee2f3be8b">INV_FSR_8G</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea6712e8563c97c11b458ef721d4f5f9d5">INV_FSR_16G</a> &lt;&lt; 3;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                           st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a351ff236fd8f4b03d3d5327ba9b404d0">accel_cfg</a>,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                           data);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;}</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a1815cc1868c7c9e92c68e414cc1c8368">  552</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a1815cc1868c7c9e92c68e414cc1c8368">AP_InertialSensor_MPU9150::mpu_set_lpf</a>(uint16_t lpf)</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;{</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    uint8_t data;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">if</span> (lpf == 0) {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a9f0263fbbdccd3c5a18fcb65be278d24">INV_FILTER_256HZ_NOLPF2</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpf &gt;= 256){</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a9f0263fbbdccd3c5a18fcb65be278d24">INV_FILTER_256HZ_NOLPF2</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpf &gt;= 188){</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9ab58e52e0b6be4cbaf0c7f32705a9fcec">INV_FILTER_188HZ</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpf &gt;= 98){</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a0f288da0c97b325a6cb57f1223f0cf98">INV_FILTER_98HZ</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpf &gt;= 42){</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a995b18a52a5bd919aa9c1411a2292110">INV_FILTER_42HZ</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpf &gt;= 20){</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9aebecb86604e475ed8e2cb68340010ff1">INV_FILTER_20HZ</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpf &gt;= 10){</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a327619f406c6b2f6a221793881013508">INV_FILTER_10HZ</a>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9abdaaf85666fd6a490ee01dcd8a315678">INV_FILTER_5HZ</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                           st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a2fbc4dfe001c08050454013fc02c5917">lpf</a>,</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                           data);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a698a91c16b9e1e1639bb8981654bcf07">  591</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a698a91c16b9e1e1639bb8981654bcf07">AP_InertialSensor_MPU9150::mpu_set_sample_rate</a>(uint16_t rate)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;{</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    uint8_t data;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// uint16_t sample_rate;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">if</span> (rate &lt; 4){</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        rate = 4;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rate &gt; 1000){</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        rate = 1000;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    data = 1000 / rate - 1;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                               st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#aa9665dd5f98f0ab1fa8dd9d49cac6e33">rate_div</a>,</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                               data);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// sample_rate = 1000 / (1 + data);</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// mpu_set_compass_sample_rate(min(sample_rate, MAX_COMPASS_SAMPLE_RATE), rate);</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a52c42003f028832a315c4b8d5a827956">  625</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a52c42003f028832a315c4b8d5a827956">AP_InertialSensor_MPU9150::mpu_set_compass_sample_rate</a>(uint16_t rate, uint16_t chip_sample_rate)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;{</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    uint8_t div;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (!rate || rate &gt; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a227dd94fe4db261a37a8c6d5119cf6ec">MAX_COMPASS_SAMPLE_RATE</a>){</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    div = chip_sample_rate / rate - 1;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                           st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a02fcae4a6abbed1a2a4df6509bae0abe">s4_ctrl</a>,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                           div);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;}</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#adcb93c24e742a509d7a3a83b49a12f94">  648</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#adcb93c24e742a509d7a3a83b49a12f94">AP_InertialSensor_MPU9150::mpu_configure_fifo</a>(uint8_t sensors)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;{</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    int16_t <a class="code" href="Printf_8cpp.html#a5558580ea8d3854253a721ee58cff12d">result</a> = 0;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">/* Compass data isn&#39;t going into the FIFO. Stop trying. */</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    sensors &amp;= ~<a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a7fc9c1dbdcb2ac8cc2a4128a5799482a">INV_XYZ_COMPASS</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// Enable or disable the interrupts</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// set_int_enable(1);</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#a54e93b2cb6bab082dfd0644554bbab5f">set_int_enable</a>(0);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (sensors) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#a18a44cafa785c4cd017f08cc5a6890b6">mpu_reset_fifo</a>(sensors)) {            </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Printf_8cpp.html#a5558580ea8d3854253a721ee58cff12d">result</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a54e93b2cb6bab082dfd0644554bbab5f">  673</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a54e93b2cb6bab082dfd0644554bbab5f">AP_InertialSensor_MPU9150::set_int_enable</a>(uint8_t enable)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;{</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    uint8_t tmp;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (enable){</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        tmp = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a45eec9dbc46778c356703dcf90b9e0c3">BIT_DATA_RDY_EN</a>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        tmp = 0x00;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                           st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#af5fb4da13709220b563f5ae8a05d37ba">int_enable</a>,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                           tmp);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a18a44cafa785c4cd017f08cc5a6890b6">  693</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a18a44cafa785c4cd017f08cc5a6890b6">AP_InertialSensor_MPU9150::mpu_reset_fifo</a>(uint8_t sensors)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    uint8_t data;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    data = 0;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#af5fb4da13709220b563f5ae8a05d37ba">int_enable</a>, data);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a9d153d2b62f23ad33f6531bbca3956e0">fifo_en</a>, data);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#abfa67633f34ad61dc8b049f3e9764597">user_ctrl</a>, data);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aeae2cc64314ad05f3a93d2358a2369db">BIT_FIFO_RST</a>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#abfa67633f34ad61dc8b049f3e9764597">user_ctrl</a>, data);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#ae3c4a18accb84992faaf2534a84a147c">BIT_FIFO_EN</a>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// data = BIT_FIFO_EN | BIT_AUX_IF_EN;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#abfa67633f34ad61dc8b049f3e9764597">user_ctrl</a>, data);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">delay</a>(50);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// interrupts for the DMP</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// data = BIT_DATA_RDY_EN;</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    data = 0;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#af5fb4da13709220b563f5ae8a05d37ba">int_enable</a>, data);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// enable FIFO</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a9d153d2b62f23ad33f6531bbca3956e0">fifo_en</a>, sensors);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">/* This initialization is similar to the one in ak8975.c. </span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">        TODO: Use the ArduPilot APIs (write, read, ...), remove the st.chip_cfg cache vars</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> AP_InertialSensor_MPU9150::setup_compass(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    uint8_t data[4], akm_addr;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    mpu_set_bypass(1);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">/* Find compass. Possible addresses range from 0x0C to 0x0F. */</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">for</span> (akm_addr = 0x0C; akm_addr &lt;= 0x0F; akm_addr++) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="Printf_8cpp.html#a5558580ea8d3854253a721ee58cff12d">result</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        result = i2c_read(akm_addr, AKM_REG_WHOAMI, 1, data);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">if</span> (!result &amp;&amp; (data[0] == AKM_WHOAMI))</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (akm_addr &gt; 0x0F) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="comment">/* TODO: Handle this case in all compass-related functions. */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        log_e(<span class="stringliteral">&quot;Compass not found.\n&quot;</span>);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    st.chip_cfg.compass_addr = akm_addr;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    data[0] = AKM_POWER_DOWN;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.chip_cfg.compass_addr, AKM_REG_CNTL, 1, data))</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    delay_ms(1);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    data[0] = AKM_FUSE_ROM_ACCESS;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.chip_cfg.compass_addr, AKM_REG_CNTL, 1, data))</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    delay_ms(1);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">/* Get sensitivity adjustment data from fuse ROM. */</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> (i2c_read(st.chip_cfg.compass_addr, AKM_REG_ASAX, 3, data))</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    st.chip_cfg.mag_sens_adj[0] = (long)data[0] + 128;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    st.chip_cfg.mag_sens_adj[1] = (long)data[1] + 128;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    st.chip_cfg.mag_sens_adj[2] = (long)data[2] + 128;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    data[0] = AKM_POWER_DOWN;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.chip_cfg.compass_addr, AKM_REG_CNTL, 1, data))</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    delay_ms(1);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    mpu_set_bypass(0);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">/* Set up master mode, master clock, and ES bit. */</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    data[0] = 0x40;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a5f57519bdd489e05e9d5f99dee9903c0">i2c_mst</a>, 1, data))</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="comment">/* Slave 0 reads from AKM data registers. */</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    data[0] = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a8ef1963ec6fb3df5586e50959cf00a70">BIT_I2C_READ</a> | st.chip_cfg.compass_addr;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a4a16ba1f22c43815c1e3d907e6884fa2">s0_addr</a>, 1, data))</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">/* Compass reads start at this register. */</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    data[0] = AKM_REG_ST1;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#ad306b1f181d82524d28e87b9b2468fdd">s0_reg</a>, 1, data))</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">/* Enable slave 0, 8-byte reads. */</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    data[0] = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#ae9440f48b6d70d900366dc040a8714d7">BIT_SLAVE_EN</a> | 8;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a38e9b3512aa315aa89d1041326db5230">s0_ctrl</a>, 1, data))</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">/* Slave 1 changes AKM measurement mode. */</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    data[0] = st.chip_cfg.compass_addr;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#aa23ab4b42d437f911e42533fc753f741">s1_addr</a>, 1, data))</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">/* AKM measurement mode register. */</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    data[0] = AKM_REG_CNTL;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a6aca99fdbfd8733e96efb15e376c0322">s1_reg</a>, 1, data))</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">/* Enable slave 1, 1-byte writes. */</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    data[0] = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#ae9440f48b6d70d900366dc040a8714d7">BIT_SLAVE_EN</a> | 1;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a9746eb3c4dec61b1ac1b72d3c6cf4161">s1_ctrl</a>, 1, data))</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">/* Set slave 1 data. */</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    data[0] = AKM_SINGLE_MEASUREMENT;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a8b45c71683751fcccc4e62444b197794">s1_do</a>, 1, data))</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">/* Trigger slave 0 and slave 1 actions at each sample. */</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    data[0] = 0x03;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a77be9b868554b470258d381f6fe8886b">i2c_delay_ctrl</a>, 1, data))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">/* For the MPU9150, the auxiliary I2C bus needs to be set to VDD. */</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    data[0] = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#ac52d7caf4efc485ef6faa1211bfe60dc">BIT_I2C_MST_VDDIO</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span> (i2c_write(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a968100aa5430d13b981f5ba5aab8128e">yg_offs_tc</a>, 1, data))</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;}</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a6e1dbb9ed5a2d759db59071da683b0fc">  833</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a6e1dbb9ed5a2d759db59071da683b0fc">AP_InertialSensor_MPU9150::mpu_set_sensors</a>(uint8_t sensors)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;{</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    uint8_t data;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">// uint8_t user_ctrl;</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">if</span> (sensors &amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a3fdc30f9c0a26c2c4e2bb88921f91629">INV_XYZ_GYRO</a>){</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a01b240917a78674d3e387110a6a8f94c">INV_CLK_PLL</a>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sensors){</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        data = 0;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        data = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a1fed8bd436e9b7dfccb1cae99ca89103">BIT_SLEEP</a>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a290248f218fb90c487662fb60a0d33af">pwr_mgmt_1</a>, data);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    data = 0;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">if</span> (!(sensors &amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#abf02bf28541421d59f8be764f2b95407">INV_X_GYRO</a>)){</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        data |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a82256fedeffe5b2443ab3ae34cf032d9">BIT_STBY_XG</a>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    }</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">if</span> (!(sensors &amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#acdd8ff833a34dba08ca2aa145eb92b44">INV_Y_GYRO</a>)){</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        data |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#abf1c0a844906a5e887a659971a4af417">BIT_STBY_YG</a>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> (!(sensors &amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a50205b5cc6089b33b2561c854eb8b0fd">INV_Z_GYRO</a>)){</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        data |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a30967a4efdf3c3f1e39814e72a4168b0">BIT_STBY_ZG</a>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (!(sensors &amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aa03f025a17ed491e70b88274e89c75c5">INV_XYZ_ACCEL</a>)){</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        data |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a04a57159e34387dafe9b86b171c4654c">BIT_STBY_XYZA</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#adf19c6b499b06d392f4080045d90a92d">pwr_mgmt_2</a>, data);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">if</span> (sensors &amp;&amp; (sensors != INV_XYZ_ACCEL)){</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="comment">/* Latched interrupts only used in LP accel mode. */</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#ae5fc7843979ad7fe3ca5fab3f358769c">mpu_set_int_latched</a>(0);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">// // handle the compass, not implemented for now</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">// #ifdef AK89xx_SECONDARY</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">// #ifdef AK89xx_BYPASS</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">//     if (sensors &amp; INV_XYZ_COMPASS)</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">//         mpu_set_bypass(1);</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">//     else</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">//         mpu_set_bypass(0);</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">// #else</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">//     if (i2c_read(st.hw-&gt;addr, st.reg-&gt;user_ctrl, 1, &amp;user_ctrl))</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">//         return -1;</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">//     /* Handle AKM power management. */</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">//     if (sensors &amp; INV_XYZ_COMPASS) {</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">//         data = AKM_SINGLE_MEASUREMENT;</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">//         user_ctrl |= BIT_AUX_IF_EN;</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">//     } else {</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">//         data = AKM_POWER_DOWN;</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">//         user_ctrl &amp;= ~BIT_AUX_IF_EN;</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">//     if (st.chip_cfg.dmp_on)</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">//         user_ctrl |= BIT_DMP_EN;</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">//     else</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">//         user_ctrl &amp;= ~BIT_DMP_EN;</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">//     if (i2c_write(st.hw-&gt;addr, st.reg-&gt;s1_do, 1, &amp;data))</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">//         return -1;</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">//     /* Enable/disable I2C master mode. */</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">//     if (i2c_write(st.hw-&gt;addr, st.reg-&gt;user_ctrl, 1, &amp;user_ctrl))</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">//         return -1;</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">// #endif</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">delay</a>(50);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;}</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#ae5fc7843979ad7fe3ca5fab3f358769c">AP_InertialSensor_MPU9150::mpu_set_int_latched</a>(uint8_t enable)</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;{</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    uint8_t tmp;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">if</span> (st.chip_cfg.latched_int == enable){</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">if</span> (enable){</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        tmp = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a588b5a95724c4a68c6868faa78fd3a7f">BIT_LATCH_EN</a> | <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a1f50796ca0363292d9ac9cc1d29d9225">BIT_ANY_RD_CLR</a>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        tmp = 0;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span> (st.chip_cfg.bypass_mode){</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        tmp |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#add12a8d89e1a4c4e008b12a96dd4c75d">BIT_BYPASS_EN</a>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">if</span> (st.chip_cfg.active_low_int){</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        tmp |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a8467782bedc44051c95643e303543655">BIT_ACTL</a>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">writeRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>,st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a52914f852faf074f8f5bdbc9a6f84aca">int_pin_cfg</a>, tmp);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    st.chip_cfg.latched_int = enable;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;}</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a4ffc7c830891e19a289795dc80886b42">  957</a></span>&#160;int16_t <a class="code" href="classAP__InertialSensor__MPU9150.html#a4ffc7c830891e19a289795dc80886b42">AP_InertialSensor_MPU9150::mpu_read_fifo</a>(int16_t *gyro, int16_t *accel, uint32_t *timestamp,</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        uint8_t *sensors, uint8_t *more)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;{</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">/* Assumes maximum packet size is gyro (6) + accel (6). */</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    uint8_t data[12];</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    uint8_t packet_size = 0;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    uint16_t fifo_count, index = 0;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    uint8_t sensors_aux = <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aa03f025a17ed491e70b88274e89c75c5">INV_XYZ_ACCEL</a>| <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a3fdc30f9c0a26c2c4e2bb88921f91629">INV_XYZ_GYRO</a>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    sensors[0] = 0;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="comment">// We assume we want gyro and accel values</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    packet_size = 12;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// fifo_count_h register contains the number of samples in the FIFO</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a5826f44fd0ab5a87db1c14f5a3d55561">readRegisters</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a8821cdf8b2299223a9624b7fceb8e179">fifo_count_h</a>, 2, data);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    fifo_count = (data[0] &lt;&lt; 8) | data[1];</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">if</span> (fifo_count &lt; packet_size){</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// hal.console-&gt;printf(PTR(&quot;FIFO count: %hd\n&quot;, fifo_count));</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> (fifo_count &gt; (st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a312ce9d536eb33b8935f88fbff27c3f9">max_fifo</a> &gt;&gt; 1)) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="comment">/* FIFO is 50% full, better check overflow bit. */</span>        </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a87848503b8dd40b1e371161f1137757b">readRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a72b6dabdecbec3f00b3c1a20eaef4810">int_status</a>, data);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">if</span> (data[0] &amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#afb9b49ce5dd973b3c29ae72680924fa7">BIT_FIFO_OVERFLOW</a>) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <a class="code" href="classAP__InertialSensor__MPU9150.html#a18a44cafa785c4cd017f08cc5a6890b6">mpu_reset_fifo</a>(sensors_aux);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="keywordflow">return</span> -2;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    *timestamp = hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">millis</a>();    </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">// read the data</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a5826f44fd0ab5a87db1c14f5a3d55561">readRegisters</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#ae12c2ec2e53ae52ccdfc8367e9573b4d">fifo_r_w</a>, packet_size, data);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    more[0] = fifo_count / packet_size - 1;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    sensors[0] = 0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        accel[0] = (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        accel[1] = (data[index+2] &lt;&lt; 8) | data[index+3];</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        accel[2] = (data[index+4] &lt;&lt; 8) | data[index+5];</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        sensors[0] |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aa03f025a17ed491e70b88274e89c75c5">INV_XYZ_ACCEL</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        index += 6;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        gyro[0] = (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        sensors[0] |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#abf02bf28541421d59f8be764f2b95407">INV_X_GYRO</a>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        index += 2;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        gyro[1] = (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        sensors[0] |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#acdd8ff833a34dba08ca2aa145eb92b44">INV_Y_GYRO</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        index += 2;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        gyro[2] = (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        sensors[0] |= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a50205b5cc6089b33b2561c854eb8b0fd">INV_Z_GYRO</a>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        index += 2;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;}</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#aabb66a96ba3568bc39fcb2ed8381e06d"> 1023</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__InertialSensor__MPU9150.html#aabb66a96ba3568bc39fcb2ed8381e06d">AP_InertialSensor_MPU9150::_accumulate</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;{</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="comment">// get pointer to i2c bus semaphore</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="classAP__HAL_1_1Semaphore.html">AP_HAL::Semaphore</a>* i2c_sem = hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a373424b46be08ef36d53844f88b5398e">get_semaphore</a>();</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// take i2c bus sempahore</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">if</span> (!i2c_sem-&gt;<a class="code" href="classAP__HAL_1_1Semaphore.html#a266e91db5eecb64d8b934d09f5e972cf">take_nonblocking</a>()){</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="comment">// Read accelerometer FIFO to find out how many samples are available</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="comment">/* Assumes maximum packet size is gyro (6) + accel (6). */</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    uint8_t data[12];</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    uint8_t packet_size = 12;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    uint16_t fifo_count, index = 0;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    int16_t accel_x, accel_y, accel_z, gyro_x, gyro_y, gyro_z;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">// fifo_count_h register contains the number of samples in the FIFO</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a5826f44fd0ab5a87db1c14f5a3d55561">readRegisters</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a8821cdf8b2299223a9624b7fceb8e179">fifo_count_h</a>, 2, data);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    fifo_count = (data[0] &lt;&lt; 8) | data[1];</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">if</span> (fifo_count &lt; packet_size){</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="comment">// give back i2c semaphore</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        i2c_sem-&gt;<a class="code" href="classAP__HAL_1_1Semaphore.html#afcdbf03d5bea9d83037acc93bfaea7ce">give</a>();</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">// hal.console-&gt;printf(PTR(&quot;FIFO count: %hd\n&quot;, fifo_count));</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">if</span> (fifo_count &gt; (st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a312ce9d536eb33b8935f88fbff27c3f9">max_fifo</a> &gt;&gt; 1)) {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="comment">/* FIFO is 50% full, better check overflow bit. */</span>        </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a87848503b8dd40b1e371161f1137757b">readRegister</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#a72b6dabdecbec3f00b3c1a20eaef4810">int_status</a>, data);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">if</span> (data[0] &amp; <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#afb9b49ce5dd973b3c29ae72680924fa7">BIT_FIFO_OVERFLOW</a>) {            </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <a class="code" href="classAP__InertialSensor__MPU9150.html#a18a44cafa785c4cd017f08cc5a6890b6">mpu_reset_fifo</a>(<a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#aa03f025a17ed491e70b88274e89c75c5">INV_XYZ_ACCEL</a>| <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a3fdc30f9c0a26c2c4e2bb88921f91629">INV_XYZ_GYRO</a>);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            i2c_sem-&gt;<a class="code" href="classAP__HAL_1_1Semaphore.html#afcdbf03d5bea9d83037acc93bfaea7ce">give</a>();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }    </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">// read the samples</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">for</span> (uint16_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; fifo_count; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {        </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <a class="code" href="classVector3.html">Vector3f</a> accel, gyro;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">// read the data</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">// TODO check whether it&#39;s possible to read all the packages in a single call</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        hal.<a class="code" href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">i2c</a>-&gt;<a class="code" href="classAP__HAL_1_1I2CDriver.html#a5826f44fd0ab5a87db1c14f5a3d55561">readRegisters</a>(st.<a class="code" href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">hw</a>-&gt;<a class="code" href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">addr</a>, st.<a class="code" href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">reg</a>-&gt;<a class="code" href="structgyro__reg__s.html#ae12c2ec2e53ae52ccdfc8367e9573b4d">fifo_r_w</a>, packet_size, data);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="comment">// TODO, remove all the checking since it&#39;s being configured this way.</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            accel_x = (int16_t) (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            accel_y = (int16_t) (data[index+2] &lt;&lt; 8) | data[index+3];</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            accel_z = (int16_t) (data[index+4] &lt;&lt; 8) | data[index+5];</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            index += 6;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            gyro_x = (int16_t) (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            index += 2;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            gyro_y = (int16_t) (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            index += 2;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">if</span> (index != packet_size) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            gyro_z = (int16_t) (data[index+0] &lt;&lt; 8) | data[index+1];</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            index += 2;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        }        </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="comment">// reset the index</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        index = 0;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="comment">// TODO Revisit why AP_InertialSensor_L3G4200D uses a minus sign in the y and z component. Maybe this</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">//  is because the sensor is placed in the bottom side of the board?</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        accel = <a class="code" href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a>(accel_x, accel_y, accel_z);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        accel *= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a7872c2553e37dc476923725add0259b0">MPU9150_ACCEL_SCALE_2G</a>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <a class="code" href="classAP__InertialSensor__Backend.html#a12e2c1d206fcd62c683165312c836a50">_rotate_and_correct_accel</a>(<a class="code" href="classAP__InertialSensor__MPU9150.html#a6ddc4d553b5ec3843d937e63ad77a08c">_accel_instance</a>, accel);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <a class="code" href="classAP__InertialSensor__Backend.html#aade30ee28ab57ee50a9c98b7815f67e2">_notify_new_accel_raw_sample</a>(<a class="code" href="classAP__InertialSensor__MPU9150.html#a6ddc4d553b5ec3843d937e63ad77a08c">_accel_instance</a>, accel);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#ada2cb0aed6f26cddc6f6c0df1122af50">_accel_filtered</a> = <a class="code" href="classAP__InertialSensor__MPU9150.html#a5f88576fe84b4acb03075b6b990b5b6b">_accel_filter</a>.<a class="code" href="classLowPassFilter2p.html#a98a931a77f5b12f13ecb84fd57a4b7d4">apply</a>(accel);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        gyro = <a class="code" href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a>(gyro_x, gyro_y, gyro_z);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        gyro *= <a class="code" href="AP__InertialSensor__MPU9150_8cpp.html#a5ae2d167ada156e125ef1697ea98a507">MPU9150_GYRO_SCALE_2000</a>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <a class="code" href="classAP__InertialSensor__Backend.html#a6b5d3fdd263b6737d8116257d2ea05c4">_rotate_and_correct_gyro</a>(<a class="code" href="classAP__InertialSensor__MPU9150.html#afdee893667354cb864fc58513cf53a72">_gyro_instance</a>, gyro);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <a class="code" href="classAP__InertialSensor__Backend.html#a645e524ed783fe355af538d58966e4a9">_notify_new_gyro_raw_sample</a>(<a class="code" href="classAP__InertialSensor__MPU9150.html#afdee893667354cb864fc58513cf53a72">_gyro_instance</a>, gyro);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#a7a7b29b2a7c7bef644a00d7038310fad">_gyro_filtered</a> = <a class="code" href="classAP__InertialSensor__MPU9150.html#ace4b074c075fdd99482af65c8b8de98b">_gyro_filter</a>.<a class="code" href="classLowPassFilter2p.html#a98a931a77f5b12f13ecb84fd57a4b7d4">apply</a>(gyro);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#a8b29d0c8a58077df266cade06b1f9b8d">_have_sample_available</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// give back i2c semaphore</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    i2c_sem-&gt;<a class="code" href="classAP__HAL_1_1Semaphore.html#afcdbf03d5bea9d83037acc93bfaea7ce">give</a>();</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"><a class="line" href="classAP__InertialSensor__MPU9150.html#a30e80692dbda9ab89f47e53f185a6604"> 1111</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__InertialSensor__MPU9150.html#a30e80692dbda9ab89f47e53f185a6604">AP_InertialSensor_MPU9150::update</a>(<span class="keywordtype">void</span>) </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;{</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="classVector3.html">Vector3f</a> accel, gyro;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#ae7d4952721abae16479fef1f0ca37145">suspend_timer_procs</a>();</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    accel = <a class="code" href="classAP__InertialSensor__MPU9150.html#ada2cb0aed6f26cddc6f6c0df1122af50">_accel_filtered</a>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    gyro = <a class="code" href="classAP__InertialSensor__MPU9150.html#a7a7b29b2a7c7bef644a00d7038310fad">_gyro_filtered</a>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <a class="code" href="classAP__InertialSensor__MPU9150.html#a8b29d0c8a58077df266cade06b1f9b8d">_have_sample_available</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a7c51e7d405211cac2090dbd456223ef7">resume_timer_procs</a>();</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <a class="code" href="classAP__InertialSensor__Backend.html#a28212257f5b97b6e129f6b2d2c20424e">_publish_accel</a>(<a class="code" href="classAP__InertialSensor__MPU9150.html#a6ddc4d553b5ec3843d937e63ad77a08c">_accel_instance</a>, accel);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <a class="code" href="classAP__InertialSensor__Backend.html#a5dbcfeb327b4622ea03838db64660dc8">_publish_gyro</a>(<a class="code" href="classAP__InertialSensor__MPU9150.html#afdee893667354cb864fc58513cf53a72">_gyro_instance</a>, gyro);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#a7c31e7320d6e463766db7b3aba63f1ed">_last_accel_filter_hz</a> != <a class="code" href="classAP__InertialSensor__Backend.html#aa7fdfb9c9f28d883fbb109e13ded7f0f">_accel_filter_cutoff</a>()) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#ab3866dd1e3527673f3aece3794eafd43">_set_accel_filter_frequency</a>(<a class="code" href="classAP__InertialSensor__Backend.html#aa7fdfb9c9f28d883fbb109e13ded7f0f">_accel_filter_cutoff</a>());</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#a7c31e7320d6e463766db7b3aba63f1ed">_last_accel_filter_hz</a> = <a class="code" href="classAP__InertialSensor__Backend.html#aa7fdfb9c9f28d883fbb109e13ded7f0f">_accel_filter_cutoff</a>();</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__InertialSensor__MPU9150.html#a1f3240d9f982c9e272c899ca7a367dcb">_last_gyro_filter_hz</a> != <a class="code" href="classAP__InertialSensor__Backend.html#a9c376bd62d2a8e0262f887c6188d0af9">_gyro_filter_cutoff</a>()) {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#a11920de68c6ceee367d640799239bb32">_set_gyro_filter_frequency</a>(<a class="code" href="classAP__InertialSensor__Backend.html#a9c376bd62d2a8e0262f887c6188d0af9">_gyro_filter_cutoff</a>());</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <a class="code" href="classAP__InertialSensor__MPU9150.html#a1f3240d9f982c9e272c899ca7a367dcb">_last_gyro_filter_hz</a> = <a class="code" href="classAP__InertialSensor__Backend.html#a9c376bd62d2a8e0262f887c6188d0af9">_gyro_filter_cutoff</a>();</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;}</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="preprocessor">#endif // CONFIG_HAL_BOARD</span></div>
<div class="ttc" id="structtest__s_html_a3b47b72fbf8c152cb4389e3cd866ded9"><div class="ttname"><a href="structtest__s.html#a3b47b72fbf8c152cb4389e3cd866ded9">test_s::max_gyro_var</a></div><div class="ttdeci">float max_gyro_var</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00106">AP_InertialSensor_MPU9150.cpp:106</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a5f88576fe84b4acb03075b6b990b5b6b"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a5f88576fe84b4acb03075b6b990b5b6b">AP_InertialSensor_MPU9150::_accel_filter</a></div><div class="ttdeci">LowPassFilter2pVector3f _accel_filter</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00055">AP_InertialSensor_MPU9150.h:55</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a30e80692dbda9ab89f47e53f185a6604"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a30e80692dbda9ab89f47e53f185a6604">AP_InertialSensor_MPU9150::update</a></div><div class="ttdeci">bool update()</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l01111">AP_InertialSensor_MPU9150.cpp:1111</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_ac5ee90a87aaa7360d3f2d11f2a981726"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#ac5ee90a87aaa7360d3f2d11f2a981726">AP_InertialSensor_MPU9150::mpu_set_gyro_fsr</a></div><div class="ttdeci">int16_t mpu_set_gyro_fsr(uint16_t fsr)</div><div class="ttdoc">Set the gyro full-scale range. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00487">AP_InertialSensor_MPU9150.cpp:487</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a83acdc0eb37e8bfe0c2ae2348ded0a90ab50b300433c5bc3cbc7ae8adb980c815"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90ab50b300433c5bc3cbc7ae8adb980c815">NUM_GYRO_FSR</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00143">AP_InertialSensor_MPU9150.cpp:143</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a5105c144ad70de19943e264b1671a5a3"><div class="ttname"><a href="structgyro__reg__s.html#a5105c144ad70de19943e264b1671a5a3">gyro_reg_s::who_am_i</a></div><div class="ttdeci">uint8_t who_am_i</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00042">AP_InertialSensor_MPU9150.cpp:42</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_a5dbcfeb327b4622ea03838db64660dc8"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#a5dbcfeb327b4622ea03838db64660dc8">AP_InertialSensor_Backend::_publish_gyro</a></div><div class="ttdeci">void _publish_gyro(uint8_t instance, const Vector3f &amp;gyro)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8cpp_source.html#l00043">AP_InertialSensor_Backend.cpp:43</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_af4ce49fd1fc9b1461b5241f9ef4812f4"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#af4ce49fd1fc9b1461b5241f9ef4812f4">BIT_RESET</a></div><div class="ttdeci">#define BIT_RESET</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00204">AP_InertialSensor_MPU9150.cpp:204</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aec8501b935143099e5f729dee221a81eaa91e3a89d0bbd01149fe71148595be6d"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eaa91e3a89d0bbd01149fe71148595be6d">INV_FSR_4G</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00151">AP_InertialSensor_MPU9150.cpp:151</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_ace4b074c075fdd99482af65c8b8de98b"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#ace4b074c075fdd99482af65c8b8de98b">AP_InertialSensor_MPU9150::_gyro_filter</a></div><div class="ttdeci">LowPassFilter2pVector3f _gyro_filter</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00056">AP_InertialSensor_MPU9150.h:56</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a6aca99fdbfd8733e96efb15e376c0322"><div class="ttname"><a href="structgyro__reg__s.html#a6aca99fdbfd8733e96efb15e376c0322">gyro_reg_s::s1_reg</a></div><div class="ttdeci">uint8_t s1_reg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00075">AP_InertialSensor_MPU9150.cpp:75</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aec8501b935143099e5f729dee221a81ea6d466b2f73b176f1dfc8a3f94ae8a4df"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea6d466b2f73b176f1dfc8a3f94ae8a4df">NUM_ACCEL_FSR</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00154">AP_InertialSensor_MPU9150.cpp:154</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a968100aa5430d13b981f5ba5aab8128e"><div class="ttname"><a href="structgyro__reg__s.html#a968100aa5430d13b981f5ba5aab8128e">gyro_reg_s::yg_offs_tc</a></div><div class="ttdeci">uint8_t yg_offs_tc</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00070">AP_InertialSensor_MPU9150.cpp:70</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a5d916ede262de822fd6ab45c93e036ae"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a5d916ede262de822fd6ab45c93e036ae">AP_InertialSensor_MPU9150::_init_sensor</a></div><div class="ttdeci">bool _init_sensor()</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00371">AP_InertialSensor_MPU9150.cpp:371</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a290248f218fb90c487662fb60a0d33af"><div class="ttname"><a href="structgyro__reg__s.html#a290248f218fb90c487662fb60a0d33af">gyro_reg_s::pwr_mgmt_1</a></div><div class="ttdeci">uint8_t pwr_mgmt_1</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00060">AP_InertialSensor_MPU9150.cpp:60</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a75570f009627c6f4ddfb2d936d81e207a01b240917a78674d3e387110a6a8f94c"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a01b240917a78674d3e387110a6a8f94c">INV_CLK_PLL</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00160">AP_InertialSensor_MPU9150.cpp:160</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aec8501b935143099e5f729dee221a81eae27c6f69463dab7de81fac0c51ff8aa7"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81eae27c6f69463dab7de81fac0c51ff8aa7">INV_FSR_2G</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00150">AP_InertialSensor_MPU9150.cpp:150</a></div></div>
<div class="ttc" id="structtest__s_html_a69790070177fd8d4403243f53d80df81"><div class="ttname"><a href="structtest__s.html#a69790070177fd8d4403243f53d80df81">test_s::packet_thresh</a></div><div class="ttdeci">uint8_t packet_thresh</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00103">AP_InertialSensor_MPU9150.cpp:103</a></div></div>
<div class="ttc" id="structhw__s_html"><div class="ttname"><a href="structhw__s.html">hw_s</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00084">AP_InertialSensor_MPU9150.cpp:84</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_a26b68339fc68a562d8d3a1238d0ec8c1"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">AP_HAL::Scheduler::millis</a></div><div class="ttdeci">virtual uint32_t millis()=0</div></div>
<div class="ttc" id="structgyro__reg__s_html_aa05bd9bf4f6508fbdef797b1ae206938"><div class="ttname"><a href="structgyro__reg__s.html#aa05bd9bf4f6508fbdef797b1ae206938">gyro_reg_s::motion_thr</a></div><div class="ttdeci">uint8_t motion_thr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00050">AP_InertialSensor_MPU9150.cpp:50</a></div></div>
<div class="ttc" id="vector3_8h_html_af345ad77ba5e240c7ab72b4b2077e754"><div class="ttname"><a href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a></div><div class="ttdeci">Vector3&lt; float &gt; Vector3f</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00219">vector3.h:219</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a2ec9ed7e9e69228c1b049f8a581312a7"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a2ec9ed7e9e69228c1b049f8a581312a7">AP_InertialSensor_MPU9150::mpu_set_accel_fsr</a></div><div class="ttdeci">int16_t mpu_set_accel_fsr(uint8_t fsr)</div><div class="ttdoc">Set the accel full-scale range. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00519">AP_InertialSensor_MPU9150.cpp:519</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a83acdc0eb37e8bfe0c2ae2348ded0a90aee922e0daa4fbb404c3db6c49d897a13"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90aee922e0daa4fbb404c3db6c49d897a13">INV_FSR_1000DPS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00141">AP_InertialSensor_MPU9150.cpp:141</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_a645e524ed783fe355af538d58966e4a9"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#a645e524ed783fe355af538d58966e4a9">AP_InertialSensor_Backend::_notify_new_gyro_raw_sample</a></div><div class="ttdeci">void _notify_new_gyro_raw_sample(uint8_t instance, const Vector3f &amp;accel)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8cpp_source.html#l00057">AP_InertialSensor_Backend.cpp:57</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a8b45c71683751fcccc4e62444b197794"><div class="ttname"><a href="structgyro__reg__s.html#a8b45c71683751fcccc4e62444b197794">gyro_reg_s::s1_do</a></div><div class="ttdeci">uint8_t s1_do</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00079">AP_InertialSensor_MPU9150.cpp:79</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_aee9708ff734bc281199a2c634ed4f47d"><div class="ttname"><a href="structgyro__reg__s.html#aee9708ff734bc281199a2c634ed4f47d">gyro_reg_s::prgm_start_h</a></div><div class="ttdeci">uint8_t prgm_start_h</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00068">AP_InertialSensor_MPU9150.cpp:68</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a7872c2553e37dc476923725add0259b0"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a7872c2553e37dc476923725add0259b0">MPU9150_ACCEL_SCALE_2G</a></div><div class="ttdeci">#define MPU9150_ACCEL_SCALE_2G</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00244">AP_InertialSensor_MPU9150.cpp:244</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9a053f39f04904f6103090bcba3002c4a3"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a053f39f04904f6103090bcba3002c4a3">NUM_FILTER</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00132">AP_InertialSensor_MPU9150.cpp:132</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_ad2fc146348e140f7bc98f14e0f9582b3"><div class="ttname"><a href="structgyro__reg__s.html#ad2fc146348e140f7bc98f14e0f9582b3">gyro_reg_s::prod_id</a></div><div class="ttdeci">uint8_t prod_id</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00045">AP_InertialSensor_MPU9150.cpp:45</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a83acdc0eb37e8bfe0c2ae2348ded0a90"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90">gyro_fsr_e</a></div><div class="ttdeci">gyro_fsr_e</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00138">AP_InertialSensor_MPU9150.cpp:138</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a18a44cafa785c4cd017f08cc5a6890b6"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a18a44cafa785c4cd017f08cc5a6890b6">AP_InertialSensor_MPU9150::mpu_reset_fifo</a></div><div class="ttdeci">int16_t mpu_reset_fifo(uint8_t sensors)</div><div class="ttdoc">Reset FIFO read/write pointers. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00693">AP_InertialSensor_MPU9150.cpp:693</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a723318001cb72adfc5daf9bc1aecff86"><div class="ttname"><a href="structgyro__reg__s.html#a723318001cb72adfc5daf9bc1aecff86">gyro_reg_s::motion_dur</a></div><div class="ttdeci">uint8_t motion_dur</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00051">AP_InertialSensor_MPU9150.cpp:51</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_af5fb4da13709220b563f5ae8a05d37ba"><div class="ttname"><a href="structgyro__reg__s.html#af5fb4da13709220b563f5ae8a05d37ba">gyro_reg_s::int_enable</a></div><div class="ttdeci">uint8_t int_enable</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00057">AP_InertialSensor_MPU9150.cpp:57</a></div></div>
<div class="ttc" id="structtest__s_html_a17221653f7937a6292e3f47140749a3c"><div class="ttname"><a href="structtest__s.html#a17221653f7937a6292e3f47140749a3c">test_s::gyro_sens</a></div><div class="ttdeci">uint32_t gyro_sens</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00096">AP_InertialSensor_MPU9150.cpp:96</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_ada2cb0aed6f26cddc6f6c0df1122af50"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#ada2cb0aed6f26cddc6f6c0df1122af50">AP_InertialSensor_MPU9150::_accel_filtered</a></div><div class="ttdeci">Vector3f _accel_filtered</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00031">AP_InertialSensor_MPU9150.h:31</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_aa23ab4b42d437f911e42533fc753f741"><div class="ttname"><a href="structgyro__reg__s.html#aa23ab4b42d437f911e42533fc753f741">gyro_reg_s::s1_addr</a></div><div class="ttdeci">uint8_t s1_addr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00074">AP_InertialSensor_MPU9150.cpp:74</a></div></div>
<div class="ttc" id="structtest__s_html_a4fd144bd8bab0a20a9cdfbea796c800d"><div class="ttname"><a href="structtest__s.html#a4fd144bd8bab0a20a9cdfbea796c800d">test_s::accel_sens</a></div><div class="ttdeci">uint32_t accel_sens</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00097">AP_InertialSensor_MPU9150.cpp:97</a></div></div>
<div class="ttc" id="AP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_ad306b1f181d82524d28e87b9b2468fdd"><div class="ttname"><a href="structgyro__reg__s.html#ad306b1f181d82524d28e87b9b2468fdd">gyro_reg_s::s0_reg</a></div><div class="ttdeci">uint8_t s0_reg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00072">AP_InertialSensor_MPU9150.cpp:72</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a92168462febe0f5ab9556dc9ea4ddb7a"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">AP_HAL::HAL::console</a></div><div class="ttdeci">AP_HAL::UARTDriver * console</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00083">HAL.h:83</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a72b6dabdecbec3f00b3c1a20eaef4810"><div class="ttname"><a href="structgyro__reg__s.html#a72b6dabdecbec3f00b3c1a20eaef4810">gyro_reg_s::int_status</a></div><div class="ttdeci">uint8_t int_status</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00059">AP_InertialSensor_MPU9150.cpp:59</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_ae826075a0e49cf76af845eb392ca1851"><div class="ttname"><a href="structgyro__reg__s.html#ae826075a0e49cf76af845eb392ca1851">gyro_reg_s::temp</a></div><div class="ttdeci">uint8_t temp</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00056">AP_InertialSensor_MPU9150.cpp:56</a></div></div>
<div class="ttc" id="classAP__HAL_1_1I2CDriver_html_a5826f44fd0ab5a87db1c14f5a3d55561"><div class="ttname"><a href="classAP__HAL_1_1I2CDriver.html#a5826f44fd0ab5a87db1c14f5a3d55561">AP_HAL::I2CDriver::readRegisters</a></div><div class="ttdeci">virtual uint8_t readRegisters(uint8_t addr, uint8_t reg, uint8_t len, uint8_t *data)=0</div></div>
<div class="ttc" id="GCS__Console_2examples_2Console_2Console_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="GCS__Console_2examples_2Console_2Console_8cpp_source.html#l00055">Console.cpp:55</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a8821cdf8b2299223a9624b7fceb8e179"><div class="ttname"><a href="structgyro__reg__s.html#a8821cdf8b2299223a9624b7fceb8e179">gyro_reg_s::fifo_count_h</a></div><div class="ttdeci">uint8_t fifo_count_h</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00052">AP_InertialSensor_MPU9150.cpp:52</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a11920de68c6ceee367d640799239bb32"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a11920de68c6ceee367d640799239bb32">AP_InertialSensor_MPU9150::_set_gyro_filter_frequency</a></div><div class="ttdeci">void _set_gyro_filter_frequency(uint8_t filter_hz)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00363">AP_InertialSensor_MPU9150.cpp:363</a></div></div>
<div class="ttc" id="structhw__s_html_a312ce9d536eb33b8935f88fbff27c3f9"><div class="ttname"><a href="structhw__s.html#a312ce9d536eb33b8935f88fbff27c3f9">hw_s::max_fifo</a></div><div class="ttdeci">uint16_t max_fifo</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00086">AP_InertialSensor_MPU9150.cpp:86</a></div></div>
<div class="ttc" id="classLowPassFilter2p_html_a98a931a77f5b12f13ecb84fd57a4b7d4"><div class="ttname"><a href="classLowPassFilter2p.html#a98a931a77f5b12f13ecb84fd57a4b7d4">LowPassFilter2p::apply</a></div><div class="ttdeci">T apply(const T &amp;sample)</div><div class="ttdef"><b>Definition:</b> <a href="LowPassFilter2p_8cpp_source.html#l00085">LowPassFilter2p.cpp:85</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a5448c351fc95ff052b110eee80e5f75c"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a5448c351fc95ff052b110eee80e5f75c">reg</a></div><div class="ttdeci">const struct gyro_reg_s reg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00247">AP_InertialSensor_MPU9150.cpp:247</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aec8501b935143099e5f729dee221a81e"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81e">accel_fsr_e</a></div><div class="ttdeci">accel_fsr_e</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00149">AP_InertialSensor_MPU9150.cpp:149</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_af644a91f58eada88f649d5f6efc06317"><div class="ttname"><a href="structgyro__reg__s.html#af644a91f58eada88f649d5f6efc06317">gyro_reg_s::accel_offs</a></div><div class="ttdeci">uint8_t accel_offs</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00064">AP_InertialSensor_MPU9150.cpp:64</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a1e8f8b1ef7fb2c429e1ce7c2f9985530"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a1e8f8b1ef7fb2c429e1ce7c2f9985530">test</a></div><div class="ttdeci">const struct test_s test</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00300">AP_InertialSensor_MPU9150.cpp:300</a></div></div>
<div class="ttc" id="Semaphores_8h_html_ad664d2e6bf70a9194d608eb555dbcf8b"><div class="ttname"><a href="Semaphores_8h.html#ad664d2e6bf70a9194d608eb555dbcf8b">HAL_SEMAPHORE_BLOCK_FOREVER</a></div><div class="ttdeci">#define HAL_SEMAPHORE_BLOCK_FOREVER</div><div class="ttdef"><b>Definition:</b> <a href="Semaphores_8h_source.html#l00007">Semaphores.h:7</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a7fefd0bb47e09b7e39e25e9795cd7edc"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a7fefd0bb47e09b7e39e25e9795cd7edc">hw</a></div><div class="ttdeci">const struct hw_s hw</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00289">AP_InertialSensor_MPU9150.cpp:289</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aeae2cc64314ad05f3a93d2358a2369db"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aeae2cc64314ad05f3a93d2358a2369db">BIT_FIFO_RST</a></div><div class="ttdeci">#define BIT_FIFO_RST</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00191">AP_InertialSensor_MPU9150.cpp:191</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Semaphore_html_abd3a0affad8bb211981a979f30386589"><div class="ttname"><a href="classAP__HAL_1_1Semaphore.html#abd3a0affad8bb211981a979f30386589">AP_HAL::Semaphore::take</a></div><div class="ttdeci">virtual bool take(uint32_t timeout_ms) WARN_IF_UNUSED=0</div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a7c31e7320d6e463766db7b3aba63f1ed"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a7c31e7320d6e463766db7b3aba63f1ed">AP_InertialSensor_MPU9150::_last_accel_filter_hz</a></div><div class="ttdeci">uint8_t _last_accel_filter_hz</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00036">AP_InertialSensor_MPU9150.h:36</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a5ccaed9383c0dd4ba0450d690f2284b7"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a5ccaed9383c0dd4ba0450d690f2284b7">AP_InertialSensor_MPU9150::detect</a></div><div class="ttdeci">static AP_InertialSensor_Backend * detect(AP_InertialSensor &amp;imu)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00339">AP_InertialSensor_MPU9150.cpp:339</a></div></div>
<div class="ttc" id="structgyro__state__s_html_a458ad7d19aa1dc020276ec0d36951d0d"><div class="ttname"><a href="structgyro__state__s.html#a458ad7d19aa1dc020276ec0d36951d0d">gyro_state_s::reg</a></div><div class="ttdeci">const struct gyro_reg_s * reg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00114">AP_InertialSensor_MPU9150.cpp:114</a></div></div>
<div class="ttc" id="classAP__InertialSensor_html_addd35f196d6b741c06453716f7bd9091"><div class="ttname"><a href="classAP__InertialSensor.html#addd35f196d6b741c06453716f7bd9091">AP_InertialSensor::register_gyro</a></div><div class="ttdeci">uint8_t register_gyro(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8cpp_source.html#l00371">AP_InertialSensor.cpp:371</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_ac52d7caf4efc485ef6faa1211bfe60dc"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#ac52d7caf4efc485ef6faa1211bfe60dc">BIT_I2C_MST_VDDIO</a></div><div class="ttdeci">#define BIT_I2C_MST_VDDIO</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00188">AP_InertialSensor_MPU9150.cpp:188</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a1815cc1868c7c9e92c68e414cc1c8368"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a1815cc1868c7c9e92c68e414cc1c8368">AP_InertialSensor_MPU9150::mpu_set_lpf</a></div><div class="ttdeci">int16_t mpu_set_lpf(uint16_t lpf)</div><div class="ttdoc">Set digital low pass filter. The following LPF settings are supported: 188, 98, 42, 20, 10, 5. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00552">AP_InertialSensor_MPU9150.cpp:552</a></div></div>
<div class="ttc" id="structtest__s_html_abb244f04695aab154efa63c22f56b16a"><div class="ttname"><a href="structtest__s.html#abb244f04695aab154efa63c22f56b16a">test_s::reg_lpf</a></div><div class="ttdeci">uint8_t reg_lpf</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00099">AP_InertialSensor_MPU9150.cpp:99</a></div></div>
<div class="ttc" id="Printf_8cpp_html_a5558580ea8d3854253a721ee58cff12d"><div class="ttname"><a href="Printf_8cpp.html#a5558580ea8d3854253a721ee58cff12d">result</a></div><div class="ttdeci">const char * result</div><div class="ttdef"><b>Definition:</b> <a href="Printf_8cpp_source.html#l00013">Printf.cpp:13</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9ab58e52e0b6be4cbaf0c7f32705a9fcec"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9ab58e52e0b6be4cbaf0c7f32705a9fcec">INV_FILTER_188HZ</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00125">AP_InertialSensor_MPU9150.cpp:125</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_ae5fc7843979ad7fe3ca5fab3f358769c"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#ae5fc7843979ad7fe3ca5fab3f358769c">AP_InertialSensor_MPU9150::mpu_set_int_latched</a></div><div class="ttdeci">int16_t mpu_set_int_latched(uint8_t enable)</div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a5ae2d167ada156e125ef1697ea98a507"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a5ae2d167ada156e125ef1697ea98a507">MPU9150_GYRO_SCALE_2000</a></div><div class="ttdeci">#define MPU9150_GYRO_SCALE_2000</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00235">AP_InertialSensor_MPU9150.cpp:235</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_acfc9b08944d93a1ac3a751c2baf96144"><div class="ttname"><a href="structgyro__reg__s.html#acfc9b08944d93a1ac3a751c2baf96144">gyro_reg_s::mem_r_w</a></div><div class="ttdeci">uint8_t mem_r_w</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00063">AP_InertialSensor_MPU9150.cpp:63</a></div></div>
<div class="ttc" id="classAP__HAL_1_1I2CDriver_html_a373424b46be08ef36d53844f88b5398e"><div class="ttname"><a href="classAP__HAL_1_1I2CDriver.html#a373424b46be08ef36d53844f88b5398e">AP_HAL::I2CDriver::get_semaphore</a></div><div class="ttdeci">virtual AP_HAL::Semaphore * get_semaphore()=0</div></div>
<div class="ttc" id="structgyro__reg__s_html_a52914f852faf074f8f5bdbc9a6f84aca"><div class="ttname"><a href="structgyro__reg__s.html#a52914f852faf074f8f5bdbc9a6f84aca">gyro_reg_s::int_pin_cfg</a></div><div class="ttdeci">uint8_t int_pin_cfg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00062">AP_InertialSensor_MPU9150.cpp:62</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a83acdc0eb37e8bfe0c2ae2348ded0a90a5b8251a49db5cb8a676076b0b308ae35"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a5b8251a49db5cb8a676076b0b308ae35">INV_FSR_250DPS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00139">AP_InertialSensor_MPU9150.cpp:139</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a2fbc4dfe001c08050454013fc02c5917"><div class="ttname"><a href="structgyro__reg__s.html#a2fbc4dfe001c08050454013fc02c5917">gyro_reg_s::lpf</a></div><div class="ttdeci">uint8_t lpf</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00044">AP_InertialSensor_MPU9150.cpp:44</a></div></div>
<div class="ttc" id="structtest__s_html_ae86aec181d0f1e4a29e9f9ae0735e8e1"><div class="ttname"><a href="structtest__s.html#ae86aec181d0f1e4a29e9f9ae0735e8e1">test_s::min_g</a></div><div class="ttdeci">float min_g</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00107">AP_InertialSensor_MPU9150.cpp:107</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_ac9d47249624e82c1c15e7fae0d955a43"><div class="ttname"><a href="structgyro__reg__s.html#ac9d47249624e82c1c15e7fae0d955a43">gyro_reg_s::mem_start_addr</a></div><div class="ttdeci">uint8_t mem_start_addr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00067">AP_InertialSensor_MPU9150.cpp:67</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a1fed8bd436e9b7dfccb1cae99ca89103"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a1fed8bd436e9b7dfccb1cae99ca89103">BIT_SLEEP</a></div><div class="ttdeci">#define BIT_SLEEP</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00205">AP_InertialSensor_MPU9150.cpp:205</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_a7c51e7d405211cac2090dbd456223ef7"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#a7c51e7d405211cac2090dbd456223ef7">AP_HAL::Scheduler::resume_timer_procs</a></div><div class="ttdeci">virtual void resume_timer_procs()=0</div></div>
<div class="ttc" id="classAP__HAL_1_1I2CDriver_html_a8e28e01b86bd1cb03efb7162f340444e"><div class="ttname"><a href="classAP__HAL_1_1I2CDriver.html#a8e28e01b86bd1cb03efb7162f340444e">AP_HAL::I2CDriver::writeRegister</a></div><div class="ttdeci">virtual uint8_t writeRegister(uint8_t addr, uint8_t reg, uint8_t val)=0</div></div>
<div class="ttc" id="structhw__s_html_a7e350a511f9b39930cab72b9335d3bd7"><div class="ttname"><a href="structhw__s.html#a7e350a511f9b39930cab72b9335d3bd7">hw_s::compass_fsr</a></div><div class="ttdeci">uint16_t compass_fsr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00091">AP_InertialSensor_MPU9150.cpp:91</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a54e93b2cb6bab082dfd0644554bbab5f"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a54e93b2cb6bab082dfd0644554bbab5f">AP_InertialSensor_MPU9150::set_int_enable</a></div><div class="ttdeci">int16_t set_int_enable(uint8_t enable)</div><div class="ttdoc">Enable/disable data ready interrupt. If the DMP is on, the DMP interrupt is enabled. Otherwise, the data ready interrupt is used. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00673">AP_InertialSensor_MPU9150.cpp:673</a></div></div>
<div class="ttc" id="structtest__s_html_a9ebd3195ac2f460f82873b9e6c36eb2c"><div class="ttname"><a href="structtest__s.html#a9ebd3195ac2f460f82873b9e6c36eb2c">test_s::max_g</a></div><div class="ttdeci">float max_g</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00108">AP_InertialSensor_MPU9150.cpp:108</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_ab3175e2e6223ccfe82f957e41cc12b26"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">AP_HAL::Scheduler::delay</a></div><div class="ttdeci">virtual void delay(uint16_t ms)=0</div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a50205b5cc6089b33b2561c854eb8b0fd"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a50205b5cc6089b33b2561c854eb8b0fd">INV_Z_GYRO</a></div><div class="ttdeci">#define INV_Z_GYRO</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00168">AP_InertialSensor_MPU9150.cpp:168</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html"><div class="ttname"><a href="classAP__InertialSensor__Backend.html">AP_InertialSensor_Backend</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8h_source.html#l00029">AP_InertialSensor_Backend.h:29</a></div></div>
<div class="ttc" id="structhw__s_html_ac122f7273d4b73c9a8502aeddbe5ceda"><div class="ttname"><a href="structhw__s.html#ac122f7273d4b73c9a8502aeddbe5ceda">hw_s::temp_sens</a></div><div class="ttdeci">uint16_t temp_sens</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00088">AP_InertialSensor_MPU9150.cpp:88</a></div></div>
<div class="ttc" id="structhw__s_html_a7f691f3774df003d15e0057a69eb4134"><div class="ttname"><a href="structhw__s.html#a7f691f3774df003d15e0057a69eb4134">hw_s::num_reg</a></div><div class="ttdeci">uint8_t num_reg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00087">AP_InertialSensor_MPU9150.cpp:87</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_abd0991b19af2539ec6e38357ef89bbad"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#abd0991b19af2539ec6e38357ef89bbad">AP_InertialSensor_MPU9150::AP_InertialSensor_MPU9150</a></div><div class="ttdeci">AP_InertialSensor_MPU9150(AP_InertialSensor &amp;imu)</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00327">AP_InertialSensor_MPU9150.cpp:327</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_ab3866dd1e3527673f3aece3794eafd43"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#ab3866dd1e3527673f3aece3794eafd43">AP_InertialSensor_MPU9150::_set_accel_filter_frequency</a></div><div class="ttdeci">void _set_accel_filter_frequency(uint8_t filter_hz)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00355">AP_InertialSensor_MPU9150.cpp:355</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_abf02bf28541421d59f8be764f2b95407"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#abf02bf28541421d59f8be764f2b95407">INV_X_GYRO</a></div><div class="ttdeci">#define INV_X_GYRO</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00166">AP_InertialSensor_MPU9150.cpp:166</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aec8501b935143099e5f729dee221a81ea0a40371bdda397d234c53d0ee2f3be8b"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea0a40371bdda397d234c53d0ee2f3be8b">INV_FSR_8G</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00152">AP_InertialSensor_MPU9150.cpp:152</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html">AP_InertialSensor_MPU9150</a></div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00014">AP_InertialSensor_MPU9150.h:14</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Semaphore_html_a266e91db5eecb64d8b934d09f5e972cf"><div class="ttname"><a href="classAP__HAL_1_1Semaphore.html#a266e91db5eecb64d8b934d09f5e972cf">AP_HAL::Semaphore::take_nonblocking</a></div><div class="ttdeci">virtual bool take_nonblocking() WARN_IF_UNUSED=0</div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00015">HAL.h:15</a></div></div>
<div class="ttc" id="classAP__InertialSensor_html"><div class="ttname"><a href="classAP__InertialSensor.html">AP_InertialSensor</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8h_source.html#l00043">AP_InertialSensor.h:43</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_aabb66a96ba3568bc39fcb2ed8381e06d"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#aabb66a96ba3568bc39fcb2ed8381e06d">AP_InertialSensor_MPU9150::_accumulate</a></div><div class="ttdeci">void _accumulate(void)</div><div class="ttdoc">Accumulate values from accels and gyros. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l01023">AP_InertialSensor_MPU9150.cpp:1023</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_afdee893667354cb864fc58513cf53a72"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#afdee893667354cb864fc58513cf53a72">AP_InertialSensor_MPU9150::_gyro_instance</a></div><div class="ttdeci">uint8_t _gyro_instance</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00058">AP_InertialSensor_MPU9150.h:58</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Semaphore_html"><div class="ttname"><a href="classAP__HAL_1_1Semaphore.html">AP_HAL::Semaphore</a></div><div class="ttdef"><b>Definition:</b> <a href="Semaphores_8h_source.html#l00009">Semaphores.h:9</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_aa9665dd5f98f0ab1fa8dd9d49cac6e33"><div class="ttname"><a href="structgyro__reg__s.html#aa9665dd5f98f0ab1fa8dd9d49cac6e33">gyro_reg_s::rate_div</a></div><div class="ttdeci">uint8_t rate_div</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00043">AP_InertialSensor_MPU9150.cpp:43</a></div></div>
<div class="ttc" id="structgyro__reg__s_html"><div class="ttname"><a href="structgyro__reg__s.html">gyro_reg_s</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00041">AP_InertialSensor_MPU9150.cpp:41</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9a995b18a52a5bd919aa9c1411a2292110"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a995b18a52a5bd919aa9c1411a2292110">INV_FILTER_42HZ</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00127">AP_InertialSensor_MPU9150.cpp:127</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9aebecb86604e475ed8e2cb68340010ff1"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9aebecb86604e475ed8e2cb68340010ff1">INV_FILTER_20HZ</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00128">AP_InertialSensor_MPU9150.cpp:128</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_ad3e839528cbb212c3a6c0a317056a874"><div class="ttname"><a href="structgyro__reg__s.html#ad3e839528cbb212c3a6c0a317056a874">gyro_reg_s::s0_do</a></div><div class="ttdeci">uint8_t s0_do</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00078">AP_InertialSensor_MPU9150.cpp:78</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a7407ed8aec197aad4b9613befb6857c9"><div class="ttname"><a href="structgyro__reg__s.html#a7407ed8aec197aad4b9613befb6857c9">gyro_reg_s::dmp_int_status</a></div><div class="ttdeci">uint8_t dmp_int_status</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00058">AP_InertialSensor_MPU9150.cpp:58</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00010">AC_PID_test.cpp:10</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a77be9b868554b470258d381f6fe8886b"><div class="ttname"><a href="structgyro__reg__s.html#a77be9b868554b470258d381f6fe8886b">gyro_reg_s::i2c_delay_ctrl</a></div><div class="ttdeci">uint8_t i2c_delay_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00080">AP_InertialSensor_MPU9150.cpp:80</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a7a7b29b2a7c7bef644a00d7038310fad"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a7a7b29b2a7c7bef644a00d7038310fad">AP_InertialSensor_MPU9150::_gyro_filtered</a></div><div class="ttdeci">Vector3f _gyro_filtered</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00032">AP_InertialSensor_MPU9150.h:32</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a8b29d0c8a58077df266cade06b1f9b8d"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a8b29d0c8a58077df266cade06b1f9b8d">AP_InertialSensor_MPU9150::_have_sample_available</a></div><div class="ttdeci">bool _have_sample_available</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00033">AP_InertialSensor_MPU9150.h:33</a></div></div>
<div class="ttc" id="structtest__s_html_afacfcf92f07cd846fb0aaf889a30c582"><div class="ttname"><a href="structtest__s.html#afacfcf92f07cd846fb0aaf889a30c582">test_s::min_dps</a></div><div class="ttdeci">float min_dps</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00104">AP_InertialSensor_MPU9150.cpp:104</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_aa7fdfb9c9f28d883fbb109e13ded7f0f"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#aa7fdfb9c9f28d883fbb109e13ded7f0f">AP_InertialSensor_Backend::_accel_filter_cutoff</a></div><div class="ttdeci">uint8_t _accel_filter_cutoff(void) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8h_source.html#l00132">AP_InertialSensor_Backend.h:132</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_aade30ee28ab57ee50a9c98b7815f67e2"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#aade30ee28ab57ee50a9c98b7815f67e2">AP_InertialSensor_Backend::_notify_new_accel_raw_sample</a></div><div class="ttdeci">void _notify_new_accel_raw_sample(uint8_t instance, const Vector3f &amp;accel)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8cpp_source.html#l00110">AP_InertialSensor_Backend.cpp:110</a></div></div>
<div class="ttc" id="structtest__s_html_ae588d6c0105bcd8f9144f42eee6c4835"><div class="ttname"><a href="structtest__s.html#ae588d6c0105bcd8f9144f42eee6c4835">test_s::max_dps</a></div><div class="ttdeci">float max_dps</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00105">AP_InertialSensor_MPU9150.cpp:105</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a1f50796ca0363292d9ac9cc1d29d9225"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a1f50796ca0363292d9ac9cc1d29d9225">BIT_ANY_RD_CLR</a></div><div class="ttdeci">#define BIT_ANY_RD_CLR</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00217">AP_InertialSensor_MPU9150.cpp:217</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_abf6b94b644d324f4389c652bfd875ce7"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#abf6b94b644d324f4389c652bfd875ce7">AK89xx_FSR</a></div><div class="ttdeci">#define AK89xx_FSR</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00231">AP_InertialSensor_MPU9150.cpp:231</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9a76de97a6c2f8eb3c5d1a73d717513f5d"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a76de97a6c2f8eb3c5d1a73d717513f5d">INV_FILTER_2100HZ_NOLPF</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00131">AP_InertialSensor_MPU9150.cpp:131</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_a6b5d3fdd263b6737d8116257d2ea05c4"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#a6b5d3fdd263b6737d8116257d2ea05c4">AP_InertialSensor_Backend::_rotate_and_correct_gyro</a></div><div class="ttdeci">void _rotate_and_correct_gyro(uint8_t instance, Vector3f &amp;gyro)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8cpp_source.html#l00033">AP_InertialSensor_Backend.cpp:33</a></div></div>
<div class="ttc" id="structhw__s_html_a2d295ff25b6d4dec1e4d6178826b23b8"><div class="ttname"><a href="structhw__s.html#a2d295ff25b6d4dec1e4d6178826b23b8">hw_s::temp_offset</a></div><div class="ttdeci">int16_t temp_offset</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00089">AP_InertialSensor_MPU9150.cpp:89</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a698a91c16b9e1e1639bb8981654bcf07"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a698a91c16b9e1e1639bb8981654bcf07">AP_InertialSensor_MPU9150::mpu_set_sample_rate</a></div><div class="ttdeci">int16_t mpu_set_sample_rate(uint16_t rate)</div><div class="ttdoc">Set sampling rate. Sampling rate must be between 4Hz and 1kHz. </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00591">AP_InertialSensor_MPU9150.cpp:591</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a8ef1963ec6fb3df5586e50959cf00a70"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a8ef1963ec6fb3df5586e50959cf00a70">BIT_I2C_READ</a></div><div class="ttdeci">#define BIT_I2C_READ</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00212">AP_InertialSensor_MPU9150.cpp:212</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a227dd94fe4db261a37a8c6d5119cf6ec"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a227dd94fe4db261a37a8c6d5119cf6ec">MAX_COMPASS_SAMPLE_RATE</a></div><div class="ttdeci">#define MAX_COMPASS_SAMPLE_RATE</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00232">AP_InertialSensor_MPU9150.cpp:232</a></div></div>
<div class="ttc" id="AP__Math_8h_html"><div class="ttname"><a href="AP__Math_8h.html">AP_Math.h</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9a327619f406c6b2f6a221793881013508"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a327619f406c6b2f6a221793881013508">INV_FILTER_10HZ</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00129">AP_InertialSensor_MPU9150.cpp:129</a></div></div>
<div class="ttc" id="classAP__HAL_1_1I2CDriver_html_a87848503b8dd40b1e371161f1137757b"><div class="ttname"><a href="classAP__HAL_1_1I2CDriver.html#a87848503b8dd40b1e371161f1137757b">AP_HAL::I2CDriver::readRegister</a></div><div class="ttdeci">virtual uint8_t readRegister(uint8_t addr, uint8_t reg, uint8_t *data)=0</div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_adcb93c24e742a509d7a3a83b49a12f94"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#adcb93c24e742a509d7a3a83b49a12f94">AP_InertialSensor_MPU9150::mpu_configure_fifo</a></div><div class="ttdeci">int16_t mpu_configure_fifo(uint8_t sensors)</div><div class="ttdoc">Select which sensors are pushed to FIFO. sensors can contain a combination of the following flags:   ...</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00648">AP_InertialSensor_MPU9150.cpp:648</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Semaphore_html_afcdbf03d5bea9d83037acc93bfaea7ce"><div class="ttname"><a href="classAP__HAL_1_1Semaphore.html#afcdbf03d5bea9d83037acc93bfaea7ce">AP_HAL::Semaphore::give</a></div><div class="ttdeci">virtual bool give()=0</div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a3854b4875f6db26c2a1a707885f1fc78"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a3854b4875f6db26c2a1a707885f1fc78">st</a></div><div class="ttdeci">static struct gyro_state_s st</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00317">AP_InertialSensor_MPU9150.cpp:317</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a04a57159e34387dafe9b86b171c4654c"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a04a57159e34387dafe9b86b171c4654c">BIT_STBY_XYZA</a></div><div class="ttdeci">#define BIT_STBY_XYZA</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00227">AP_InertialSensor_MPU9150.cpp:227</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_add12a8d89e1a4c4e008b12a96dd4c75d"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#add12a8d89e1a4c4e008b12a96dd4c75d">BIT_BYPASS_EN</a></div><div class="ttdeci">#define BIT_BYPASS_EN</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00218">AP_InertialSensor_MPU9150.cpp:218</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a75570f009627c6f4ddfb2d936d81e207a7f075b0360037232fdf24f90de7be1d7"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a7f075b0360037232fdf24f90de7be1d7">NUM_CLK</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00161">AP_InertialSensor_MPU9150.cpp:161</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a4e9cb7e0d2dc9fcd51be96bcbbdca7e9"><div class="ttname"><a href="structgyro__reg__s.html#a4e9cb7e0d2dc9fcd51be96bcbbdca7e9">gyro_reg_s::raw_accel</a></div><div class="ttdeci">uint8_t raw_accel</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00055">AP_InertialSensor_MPU9150.cpp:55</a></div></div>
<div class="ttc" id="structhw__s_html_a41a7f24240decce6cd6a261f69e42d8c"><div class="ttname"><a href="structhw__s.html#a41a7f24240decce6cd6a261f69e42d8c">hw_s::addr</a></div><div class="ttdeci">uint8_t addr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00085">AP_InertialSensor_MPU9150.cpp:85</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a5f57519bdd489e05e9d5f99dee9903c0"><div class="ttname"><a href="structgyro__reg__s.html#a5f57519bdd489e05e9d5f99dee9903c0">gyro_reg_s::i2c_mst</a></div><div class="ttdeci">uint8_t i2c_mst</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00065">AP_InertialSensor_MPU9150.cpp:65</a></div></div>
<div class="ttc" id="structhw__s_html_a5c4e53ba09a44e6c60b2afebd2ca6802"><div class="ttname"><a href="structhw__s.html#a5c4e53ba09a44e6c60b2afebd2ca6802">hw_s::bank_size</a></div><div class="ttdeci">uint16_t bank_size</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00090">AP_InertialSensor_MPU9150.cpp:90</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_ae7d4952721abae16479fef1f0ca37145"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#ae7d4952721abae16479fef1f0ca37145">AP_HAL::Scheduler::suspend_timer_procs</a></div><div class="ttdeci">virtual void suspend_timer_procs()=0</div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_ae3c4a18accb84992faaf2534a84a147c"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#ae3c4a18accb84992faaf2534a84a147c">BIT_FIFO_EN</a></div><div class="ttdeci">#define BIT_FIFO_EN</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00189">AP_InertialSensor_MPU9150.cpp:189</a></div></div>
<div class="ttc" id="structgyro__state__s_html_ac280ecd767872a9664737fce8dd8e07b"><div class="ttname"><a href="structgyro__state__s.html#ac280ecd767872a9664737fce8dd8e07b">gyro_state_s::hw</a></div><div class="ttdeci">const struct hw_s * hw</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00115">AP_InertialSensor_MPU9150.cpp:115</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_adf19c6b499b06d392f4080045d90a92d"><div class="ttname"><a href="structgyro__reg__s.html#adf19c6b499b06d392f4080045d90a92d">gyro_reg_s::pwr_mgmt_2</a></div><div class="ttdeci">uint8_t pwr_mgmt_2</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00061">AP_InertialSensor_MPU9150.cpp:61</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_adf919bf6643e818626af9526aeb39dc7"><div class="ttname"><a href="structgyro__reg__s.html#adf919bf6643e818626af9526aeb39dc7">gyro_reg_s::raw_compass</a></div><div class="ttdeci">uint8_t raw_compass</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00069">AP_InertialSensor_MPU9150.cpp:69</a></div></div>
<div class="ttc" id="classLowPassFilter2p_html_ac6157f65625e34dec2f7af4474dfb923"><div class="ttname"><a href="classLowPassFilter2p.html#ac6157f65625e34dec2f7af4474dfb923">LowPassFilter2p::set_cutoff_frequency</a></div><div class="ttdeci">void set_cutoff_frequency(float sample_freq, float cutoff_freq)</div><div class="ttdef"><b>Definition:</b> <a href="LowPassFilter2p_8cpp_source.html#l00069">LowPassFilter2p.cpp:69</a></div></div>
<div class="ttc" id="classAP__HAL_1_1UARTDriver_html_a65c7824b8877f7a2f79365c8ffae8f56"><div class="ttname"><a href="classAP__HAL_1_1UARTDriver.html#a65c7824b8877f7a2f79365c8ffae8f56">AP_HAL::UARTDriver::printf</a></div><div class="ttdeci">void printf(const char *s,...) FORMAT(2</div><div class="ttdef"><b>Definition:</b> <a href="UARTDriver_8cpp_source.html#l00028">UARTDriver.cpp:28</a></div></div>
<div class="ttc" id="classAP__InertialSensor_html_abcc47a3b7a03a08178904fd0aec0ee96"><div class="ttname"><a href="classAP__InertialSensor.html#abcc47a3b7a03a08178904fd0aec0ee96">AP_InertialSensor::register_accel</a></div><div class="ttdeci">uint8_t register_accel(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8cpp_source.html#l00382">AP_InertialSensor.cpp:382</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a82935af9a817fb2c2b8850759e9f327b"><div class="ttname"><a href="structgyro__reg__s.html#a82935af9a817fb2c2b8850759e9f327b">gyro_reg_s::bank_sel</a></div><div class="ttdeci">uint8_t bank_sel</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00066">AP_InertialSensor_MPU9150.cpp:66</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_ac2c4230957d5dbd3c2fd104af2794b4f"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#ac2c4230957d5dbd3c2fd104af2794b4f">AP_HAL::Scheduler::register_timer_process</a></div><div class="ttdeci">virtual void register_timer_process(AP_HAL::MemberProc)=0</div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_afb9b49ce5dd973b3c29ae72680924fa7"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#afb9b49ce5dd973b3c29ae72680924fa7">BIT_FIFO_OVERFLOW</a></div><div class="ttdeci">#define BIT_FIFO_OVERFLOW</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00193">AP_InertialSensor_MPU9150.cpp:193</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a588b5a95724c4a68c6868faa78fd3a7f"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a588b5a95724c4a68c6868faa78fd3a7f">BIT_LATCH_EN</a></div><div class="ttdeci">#define BIT_LATCH_EN</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00216">AP_InertialSensor_MPU9150.cpp:216</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_a28212257f5b97b6e129f6b2d2c20424e"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#a28212257f5b97b6e129f6b2d2c20424e">AP_InertialSensor_Backend::_publish_accel</a></div><div class="ttdeci">void _publish_accel(uint8_t instance, const Vector3f &amp;accel)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8cpp_source.html#l00095">AP_InertialSensor_Backend.cpp:95</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a02fcae4a6abbed1a2a4df6509bae0abe"><div class="ttname"><a href="structgyro__reg__s.html#a02fcae4a6abbed1a2a4df6509bae0abe">gyro_reg_s::s4_ctrl</a></div><div class="ttdeci">uint8_t s4_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00077">AP_InertialSensor_MPU9150.cpp:77</a></div></div>
<div class="ttc" id="structtest__s_html_aa88c0e7ab03b2b3cffe6e071134fb9f5"><div class="ttname"><a href="structtest__s.html#aa88c0e7ab03b2b3cffe6e071134fb9f5">test_s::reg_rate_div</a></div><div class="ttdeci">uint8_t reg_rate_div</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00098">AP_InertialSensor_MPU9150.cpp:98</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a75570f009627c6f4ddfb2d936d81e207a92059acf8d0ff5b7e12580c15f88466f"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207a92059acf8d0ff5b7e12580c15f88466f">INV_CLK_INTERNAL</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00159">AP_InertialSensor_MPU9150.cpp:159</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a52c42003f028832a315c4b8d5a827956"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a52c42003f028832a315c4b8d5a827956">AP_InertialSensor_MPU9150::mpu_set_compass_sample_rate</a></div><div class="ttdeci">int16_t mpu_set_compass_sample_rate(uint16_t rate, uint16_t chip_sample_rate)</div><div class="ttdoc">Set compass sampling rate. The compass on the auxiliary I2C bus is read by the MPU hardware at a maxi...</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00625">AP_InertialSensor_MPU9150.cpp:625</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aec8501b935143099e5f729dee221a81ea6712e8563c97c11b458ef721d4f5f9d5"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aec8501b935143099e5f729dee221a81ea6712e8563c97c11b458ef721d4f5f9d5">INV_FSR_16G</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00153">AP_InertialSensor_MPU9150.cpp:153</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a3fdc30f9c0a26c2c4e2bb88921f91629"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a3fdc30f9c0a26c2c4e2bb88921f91629">INV_XYZ_GYRO</a></div><div class="ttdeci">#define INV_XYZ_GYRO</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00169">AP_InertialSensor_MPU9150.cpp:169</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_a9c376bd62d2a8e0262f887c6188d0af9"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#a9c376bd62d2a8e0262f887c6188d0af9">AP_InertialSensor_Backend::_gyro_filter_cutoff</a></div><div class="ttdeci">uint8_t _gyro_filter_cutoff(void) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8h_source.html#l00135">AP_InertialSensor_Backend.h:135</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a82256fedeffe5b2443ab3ae34cf032d9"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a82256fedeffe5b2443ab3ae34cf032d9">BIT_STBY_XG</a></div><div class="ttdeci">#define BIT_STBY_XG</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00224">AP_InertialSensor_MPU9150.cpp:224</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a7fc9c1dbdcb2ac8cc2a4128a5799482a"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a7fc9c1dbdcb2ac8cc2a4128a5799482a">INV_XYZ_COMPASS</a></div><div class="ttdeci">#define INV_XYZ_COMPASS</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00171">AP_InertialSensor_MPU9150.cpp:171</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9a9f0263fbbdccd3c5a18fcb65be278d24"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a9f0263fbbdccd3c5a18fcb65be278d24">INV_FILTER_256HZ_NOLPF2</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00124">AP_InertialSensor_MPU9150.cpp:124</a></div></div>
<div class="ttc" id="structgyro__state__s_html_a5a1563d12b0aab5e65317621742f6f62"><div class="ttname"><a href="structgyro__state__s.html#a5a1563d12b0aab5e65317621742f6f62">gyro_state_s::test</a></div><div class="ttdeci">const struct test_s * test</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00116">AP_InertialSensor_MPU9150.cpp:116</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_abf1c0a844906a5e887a659971a4af417"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#abf1c0a844906a5e887a659971a4af417">BIT_STBY_YG</a></div><div class="ttdeci">#define BIT_STBY_YG</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00225">AP_InertialSensor_MPU9150.cpp:225</a></div></div>
<div class="ttc" id="structtest__s_html_ae3f2173d149c15cfdb50584506fd07af"><div class="ttname"><a href="structtest__s.html#ae3f2173d149c15cfdb50584506fd07af">test_s::wait_ms</a></div><div class="ttdeci">uint16_t wait_ms</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00102">AP_InertialSensor_MPU9150.cpp:102</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a83acdc0eb37e8bfe0c2ae2348ded0a90ac0c37efc1c8acd6f70c0c5a768e5b8be"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90ac0c37efc1c8acd6f70c0c5a768e5b8be">INV_FSR_2000DPS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00142">AP_InertialSensor_MPU9150.cpp:142</a></div></div>
<div class="ttc" id="classVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="structtest__s_html"><div class="ttname"><a href="structtest__s.html">test_s</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00095">AP_InertialSensor_MPU9150.cpp:95</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9a0f288da0c97b325a6cb57f1223f0cf98"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9a0f288da0c97b325a6cb57f1223f0cf98">INV_FILTER_98HZ</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00126">AP_InertialSensor_MPU9150.cpp:126</a></div></div>
<div class="ttc" id="functor_8h_html_a00e5874203cecc310017f9166f2c0e36"><div class="ttname"><a href="functor_8h.html#a00e5874203cecc310017f9166f2c0e36">FUNCTOR_BIND_MEMBER</a></div><div class="ttdeci">#define FUNCTOR_BIND_MEMBER(func, rettype,...)</div><div class="ttdef"><b>Definition:</b> <a href="functor_8h_source.html#l00032">functor.h:32</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a9d153d2b62f23ad33f6531bbca3956e0"><div class="ttname"><a href="structgyro__reg__s.html#a9d153d2b62f23ad33f6531bbca3956e0">gyro_reg_s::fifo_en</a></div><div class="ttdeci">uint8_t fifo_en</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00047">AP_InertialSensor_MPU9150.cpp:47</a></div></div>
<div class="ttc" id="structtest__s_html_a7f6071fb91426f467d9223c712560ee6"><div class="ttname"><a href="structtest__s.html#a7f6071fb91426f467d9223c712560ee6">test_s::max_accel_var</a></div><div class="ttdeci">float max_accel_var</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00109">AP_InertialSensor_MPU9150.cpp:109</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a9746eb3c4dec61b1ac1b72d3c6cf4161"><div class="ttname"><a href="structgyro__reg__s.html#a9746eb3c4dec61b1ac1b72d3c6cf4161">gyro_reg_s::s1_ctrl</a></div><div class="ttdeci">uint8_t s1_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00076">AP_InertialSensor_MPU9150.cpp:76</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a13174c9000b72e696d9414d87fcf1a8b"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a13174c9000b72e696d9414d87fcf1a8b">AP_HAL::HAL::i2c</a></div><div class="ttdeci">AP_HAL::I2CDriver * i2c</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00077">HAL.h:77</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a38e9b3512aa315aa89d1041326db5230"><div class="ttname"><a href="structgyro__reg__s.html#a38e9b3512aa315aa89d1041326db5230">gyro_reg_s::s0_ctrl</a></div><div class="ttdeci">uint8_t s0_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00073">AP_InertialSensor_MPU9150.cpp:73</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_a7bd7b202f34666e99378d209e1b87537"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#a7bd7b202f34666e99378d209e1b87537">AP_InertialSensor_Backend::_imu</a></div><div class="ttdeci">AP_InertialSensor &amp; _imu</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8h_source.html#l00078">AP_InertialSensor_Backend.h:78</a></div></div>
<div class="ttc" id="structgyro__state__s_html"><div class="ttname"><a href="structgyro__state__s.html">gyro_state_s</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00113">AP_InertialSensor_MPU9150.cpp:113</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a75570f009627c6f4ddfb2d936d81e207"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a75570f009627c6f4ddfb2d936d81e207">clock_sel_e</a></div><div class="ttdeci">clock_sel_e</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00158">AP_InertialSensor_MPU9150.cpp:158</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a4a16ba1f22c43815c1e3d907e6884fa2"><div class="ttname"><a href="structgyro__reg__s.html#a4a16ba1f22c43815c1e3d907e6884fa2">gyro_reg_s::s0_addr</a></div><div class="ttdeci">uint8_t s0_addr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00071">AP_InertialSensor_MPU9150.cpp:71</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_acdd8ff833a34dba08ca2aa145eb92b44"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#acdd8ff833a34dba08ca2aa145eb92b44">INV_Y_GYRO</a></div><div class="ttdeci">#define INV_Y_GYRO</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00167">AP_InertialSensor_MPU9150.cpp:167</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a6ddc4d553b5ec3843d937e63ad77a08c"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a6ddc4d553b5ec3843d937e63ad77a08c">AP_InertialSensor_MPU9150::_accel_instance</a></div><div class="ttdeci">uint8_t _accel_instance</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00059">AP_InertialSensor_MPU9150.h:59</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a351ff236fd8f4b03d3d5327ba9b404d0"><div class="ttname"><a href="structgyro__reg__s.html#a351ff236fd8f4b03d3d5327ba9b404d0">gyro_reg_s::accel_cfg</a></div><div class="ttdeci">uint8_t accel_cfg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00049">AP_InertialSensor_MPU9150.cpp:49</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a1f3240d9f982c9e272c899ca7a367dcb"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a1f3240d9f982c9e272c899ca7a367dcb">AP_InertialSensor_MPU9150::_last_gyro_filter_hz</a></div><div class="ttdeci">uint8_t _last_gyro_filter_hz</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8h_source.html#l00037">AP_InertialSensor_MPU9150.h:37</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a83acdc0eb37e8bfe0c2ae2348ded0a90a50901470ff389927fd010081e2b8fd09"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a83acdc0eb37e8bfe0c2ae2348ded0a90a50901470ff389927fd010081e2b8fd09">INV_FSR_500DPS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00140">AP_InertialSensor_MPU9150.cpp:140</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a91fa10855a435daaf726596a270f73c7"><div class="ttname"><a href="structgyro__reg__s.html#a91fa10855a435daaf726596a270f73c7">gyro_reg_s::gyro_cfg</a></div><div class="ttdeci">uint8_t gyro_cfg</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00048">AP_InertialSensor_MPU9150.cpp:48</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a8467782bedc44051c95643e303543655"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a8467782bedc44051c95643e303543655">BIT_ACTL</a></div><div class="ttdeci">#define BIT_ACTL</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00215">AP_InertialSensor_MPU9150.cpp:215</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_abfa67633f34ad61dc8b049f3e9764597"><div class="ttname"><a href="structgyro__reg__s.html#abfa67633f34ad61dc8b049f3e9764597">gyro_reg_s::user_ctrl</a></div><div class="ttdeci">uint8_t user_ctrl</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00046">AP_InertialSensor_MPU9150.cpp:46</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_aa03f025a17ed491e70b88274e89c75c5"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#aa03f025a17ed491e70b88274e89c75c5">INV_XYZ_ACCEL</a></div><div class="ttdeci">#define INV_XYZ_ACCEL</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00170">AP_InertialSensor_MPU9150.cpp:170</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_a8e23f0002123e85dabbb2dbb5d17fab2"><div class="ttname"><a href="structgyro__reg__s.html#a8e23f0002123e85dabbb2dbb5d17fab2">gyro_reg_s::raw_gyro</a></div><div class="ttdeci">uint8_t raw_gyro</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00054">AP_InertialSensor_MPU9150.cpp:54</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_ae9440f48b6d70d900366dc040a8714d7"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#ae9440f48b6d70d900366dc040a8714d7">BIT_SLAVE_EN</a></div><div class="ttdeci">#define BIT_SLAVE_EN</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00211">AP_InertialSensor_MPU9150.cpp:211</a></div></div>
<div class="ttc" id="classAP__InertialSensor__Backend_html_a12e2c1d206fcd62c683165312c836a50"><div class="ttname"><a href="classAP__InertialSensor__Backend.html#a12e2c1d206fcd62c683165312c836a50">AP_InertialSensor_Backend::_rotate_and_correct_accel</a></div><div class="ttdeci">void _rotate_and_correct_accel(uint8_t instance, Vector3f &amp;accel)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__Backend_8cpp_source.html#l00012">AP_InertialSensor_Backend.cpp:12</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a6e1dbb9ed5a2d759db59071da683b0fc"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a6e1dbb9ed5a2d759db59071da683b0fc">AP_InertialSensor_MPU9150::mpu_set_sensors</a></div><div class="ttdeci">int16_t mpu_set_sensors(uint8_t sensors)</div><div class="ttdoc">Turn specific sensors on/off. sensors can contain a combination of the following flags:   INV_X_GYRO...</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00833">AP_InertialSensor_MPU9150.cpp:833</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9abdaaf85666fd6a490ee01dcd8a315678"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9abdaaf85666fd6a490ee01dcd8a315678">INV_FILTER_5HZ</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00130">AP_InertialSensor_MPU9150.cpp:130</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8h_html"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8h.html">AP_InertialSensor_MPU9150.h</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a30967a4efdf3c3f1e39814e72a4168b0"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a30967a4efdf3c3f1e39814e72a4168b0">BIT_STBY_ZG</a></div><div class="ttdeci">#define BIT_STBY_ZG</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00226">AP_InertialSensor_MPU9150.cpp:226</a></div></div>
<div class="ttc" id="structtest__s_html_a39b47c5b3de48bce1e59d7d2e775146d"><div class="ttname"><a href="structtest__s.html#a39b47c5b3de48bce1e59d7d2e775146d">test_s::reg_gyro_fsr</a></div><div class="ttdeci">uint8_t reg_gyro_fsr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00100">AP_InertialSensor_MPU9150.cpp:100</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a45eec9dbc46778c356703dcf90b9e0c3"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a45eec9dbc46778c356703dcf90b9e0c3">BIT_DATA_RDY_EN</a></div><div class="ttdeci">#define BIT_DATA_RDY_EN</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00194">AP_InertialSensor_MPU9150.cpp:194</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a94ab41309b1ff10b8b862b826e59c882"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">AP_HAL::HAL::scheduler</a></div><div class="ttdeci">AP_HAL::Scheduler * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00087">HAL.h:87</a></div></div>
<div class="ttc" id="structgyro__reg__s_html_ae12c2ec2e53ae52ccdfc8367e9573b4d"><div class="ttname"><a href="structgyro__reg__s.html#ae12c2ec2e53ae52ccdfc8367e9573b4d">gyro_reg_s::fifo_r_w</a></div><div class="ttdeci">uint8_t fifo_r_w</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00053">AP_InertialSensor_MPU9150.cpp:53</a></div></div>
<div class="ttc" id="structtest__s_html_a575a358ff497db504dd248f5081ca639"><div class="ttname"><a href="structtest__s.html#a575a358ff497db504dd248f5081ca639">test_s::reg_accel_fsr</a></div><div class="ttdeci">uint8_t reg_accel_fsr</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00101">AP_InertialSensor_MPU9150.cpp:101</a></div></div>
<div class="ttc" id="classAP__InertialSensor__MPU9150_html_a4ffc7c830891e19a289795dc80886b42"><div class="ttname"><a href="classAP__InertialSensor__MPU9150.html#a4ffc7c830891e19a289795dc80886b42">AP_InertialSensor_MPU9150::mpu_read_fifo</a></div><div class="ttdeci">int16_t mpu_read_fifo(int16_t *gyro, int16_t *accel, uint32_t *timestamp, uint8_t *sensors, uint8_t *more)</div><div class="ttdoc">Get one packet from the FIFO. If sensors does not contain a particular sensor, disregard the data ret...</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00957">AP_InertialSensor_MPU9150.cpp:957</a></div></div>
<div class="ttc" id="AP__InertialSensor__MPU9150_8cpp_html_a91c762a5bd71461f7911dc49ee7696e9"><div class="ttname"><a href="AP__InertialSensor__MPU9150_8cpp.html#a91c762a5bd71461f7911dc49ee7696e9">lpf_e</a></div><div class="ttdeci">lpf_e</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor__MPU9150_8cpp_source.html#l00123">AP_InertialSensor_MPU9150.cpp:123</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 14 2015 23:43:15 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
