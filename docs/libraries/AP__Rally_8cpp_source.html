<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>APM:Libraries: libraries/AP_Rally/AP_Rally.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_a13c6ed4fd97de966b0386f9b4eb86c6.html">AP_Rally</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_Rally.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__Rally_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// -*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*-</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Rally_8h.html">AP_Rally.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__Rally_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// storage object</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<a class="code" href="classStorageAccess.html">StorageAccess</a> <a class="code" href="classAP__Rally.html#a1712d3afc63c3815dfc08543d07c24ad">AP_Rally::_storage</a>(<a class="code" href="classStorageManager.html#a8a47a036f4478b1631984c9577d73a46a42e46109d6193f717d28cbc3c5f40c14">StorageManager::StorageRally</a>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// ArduCopter/defines.h sets this, and this definition will be moved into ArduPlane/defines.h when that is patched to use the lib</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#ifdef APM_BUILD_DIRECTORY</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">  #if APM_BUILD_TYPE(APM_BUILD_ArduCopter)</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">    #define RALLY_LIMIT_KM_DEFAULT 0.3f</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">    #define RALLY_INCLUDE_HOME_DEFAULT 1</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">  #elif APM_BUILD_TYPE(APM_BUILD_ArduPlane)</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">    #define RALLY_LIMIT_KM_DEFAULT 5.0f</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">    #define RALLY_INCLUDE_HOME_DEFAULT 0</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">  #elif APM_BUILD_TYPE(APM_BUILD_APMrover2)</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">    #define RALLY_LIMIT_KM_DEFAULT 0.5f</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">    #define RALLY_INCLUDE_HOME_DEFAULT 0</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#endif  // APM_BUILD_DIRECTORY</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef RALLY_LIMIT_KM_DEFAULT</span></div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="AP__Rally_8cpp.html#a9090efafdd1cacb7aa5646da3ef2bee0">   28</a></span>&#160;<span class="preprocessor">#define RALLY_LIMIT_KM_DEFAULT 1.0f</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#ifndef RALLY_INCLUDE_HOME_DEFAULT</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="AP__Rally_8cpp.html#a6cf8535f6d897b3dadefb50cf2d61e8a">   32</a></span>&#160;<span class="preprocessor">#define RALLY_INCLUDE_HOME_DEFAULT 0</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classAP__Rally.html#a906e63c18a936240cb1f85563e9ee9df">AP_Rally::var_info</a>[] = {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// @Param: TOTAL</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// @DisplayName: Rally Total</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// @Description: Number of rally points currently loaded</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;TOTAL&quot;</span>, 0, <a class="code" href="classAP__Rally.html">AP_Rally</a>, _rally_point_total_count, 0),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// @Param: LIMIT_KM</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// @DisplayName: Rally Limit</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// @Description: Maximum distance to rally point. If the closest rally point is more than this number of kilometers from the current position and the home location is closer than any of the rally points from the current position then do RTL to home rather than to the closest rally point. This prevents a leftover rally point from a different airfield being used accidentally. If this is set to 0 then the closest rally point is always used.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// @Units: kilometers</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// @Increment: 0.1</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;LIMIT_KM&quot;</span>, 1, <a class="code" href="classAP__Rally.html">AP_Rally</a>, _rally_limit_km, <a class="code" href="AP__Rally_8cpp.html#a9090efafdd1cacb7aa5646da3ef2bee0">RALLY_LIMIT_KM_DEFAULT</a>),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// @Param: INCL_HOME</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// @DisplayName: Rally Include Home</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// @Description: Controls if Home is included as a Rally point (i.e. as a safe landing place) for RTL</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// @Values: 0:DoNotIncludeHome,1:IncludeHome</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;INCL_HOME&quot;</span>, 2, <a class="code" href="classAP__Rally.html">AP_Rally</a>, _rally_incl_home, <a class="code" href="AP__Rally_8cpp.html#a6cf8535f6d897b3dadefb50cf2d61e8a">RALLY_INCLUDE_HOME_DEFAULT</a>),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;};</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// constructor</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="classAP__Rally.html#add46a641ab976409ed4e4be01c201dc7">   61</a></span>&#160;<a class="code" href="classAP__Rally.html#add46a641ab976409ed4e4be01c201dc7">AP_Rally::AP_Rally</a>(<a class="code" href="classAP__AHRS.html">AP_AHRS</a> &amp;<a class="code" href="AHRS__Test_8cpp.html#a0a15280249072432f8c559cc00d09dee">ahrs</a>) </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    : _ahrs(ahrs)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    , _last_change_time_ms(0xFFFFFFFF)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, <a class="code" href="classAP__Rally.html#a906e63c18a936240cb1f85563e9ee9df">var_info</a>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// get a rally point from EEPROM</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classAP__Rally.html#ad47b2b3a30b69eede58ad1f79cd61f11">   69</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__Rally.html#ad47b2b3a30b69eede58ad1f79cd61f11">AP_Rally::get_rally_point_with_index</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="structRallyLocation.html">RallyLocation</a> &amp;ret)<span class="keyword"> const</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (i &gt;= (uint8_t) <a class="code" href="classAP__Rally.html#a7df46c782c4d221590d48b720b9f6457">_rally_point_total_count</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classAP__Rally.html#a1712d3afc63c3815dfc08543d07c24ad">_storage</a>.<a class="code" href="classStorageAccess.html#ab2a8575d541549a15645edc360fdaa91">read_block</a>(&amp;ret, i * <span class="keyword">sizeof</span>(<a class="code" href="structRallyLocation.html">RallyLocation</a>), <span class="keyword">sizeof</span>(<a class="code" href="structRallyLocation.html">RallyLocation</a>));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (ret.<a class="code" href="structRallyLocation.html#aaaabfdf90e21cefd9dbeb234c7a5e251">lat</a> == 0 &amp;&amp; ret.<a class="code" href="structRallyLocation.html#a8227727c3c6fa6ef6739525c0a14bfb1">lng</a> == 0) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// sanity check</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">// save a rally point to EEPROM - this assumes that the RALLY_TOTAL param has been incremented beforehand, which is the case in Mission Planner</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classAP__Rally.html#a7d931e38aad349dec7ef42965f8d6a60">   85</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__Rally.html#a7d931e38aad349dec7ef42965f8d6a60">AP_Rally::set_rally_point_with_index</a>(uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <span class="keyword">const</span> <a class="code" href="structRallyLocation.html">RallyLocation</a> &amp;rallyLoc)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (i &gt;= (uint8_t) <a class="code" href="classAP__Rally.html#a7df46c782c4d221590d48b720b9f6457">_rally_point_total_count</a>) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classAP__Rally.html#a9db74353c18234a7cede605c47840e9f">get_rally_max</a>()) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classAP__Rally.html#a1712d3afc63c3815dfc08543d07c24ad">_storage</a>.<a class="code" href="classStorageAccess.html#aa527b50188a7138b173defe07b9b7bf6">write_block</a>(i * <span class="keyword">sizeof</span>(<a class="code" href="structRallyLocation.html">RallyLocation</a>), &amp;rallyLoc, <span class="keyword">sizeof</span>(<a class="code" href="structRallyLocation.html">RallyLocation</a>));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classAP__Rally.html#a44f72c79ead390458f8dee9d0d4ca458">_last_change_time_ms</a> = hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">millis</a>();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// helper function to translate a RallyLocation to a Location</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classAP__Rally.html#acbee4f7ffe79e701bd44c4c72e1c34d2">  103</a></span>&#160;<a class="code" href="structLocation.html">Location</a> <a class="code" href="classAP__Rally.html#acbee4f7ffe79e701bd44c4c72e1c34d2">AP_Rally::rally_location_to_location</a>(<span class="keyword">const</span> <a class="code" href="structRallyLocation.html">RallyLocation</a> &amp;rally_loc)<span class="keyword"> const</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="structLocation.html">Location</a> ret = {};</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// we return an absolute altitude, as we add homeloc.alt below</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    ret.<a class="code" href="structLocation.html#ad9759dba1fc13f13c531ebdcb2c9588e">flags</a>.<a class="code" href="structLocation__Option__Flags.html#a3f0f17e655550917bc3177e876d6dc14">relative_alt</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">//Currently can&#39;t do true AGL on the APM.  Relative altitudes are</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">//relative to HOME point&#39;s altitude.  Terrain on the board is inbound</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">//for the PX4, though.  This line will need to be updated when that happens:</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    ret.<a class="code" href="structLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a> = (rally_loc.<a class="code" href="structRallyLocation.html#adfdbf88bff5056e7c569909ba7ff67f5">alt</a>*100UL) + <a class="code" href="classAP__Rally.html#a554e80a07d4d838334c50d575e8b811f">_ahrs</a>.<a class="code" href="classAP__AHRS.html#aea45b16e6469a3b392b8bf52fb864732">get_home</a>().<a class="code" href="structLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ret.<a class="code" href="structLocation.html#ae51548c2cf32311043ca19b94b9a9223">lat</a> = rally_loc.<a class="code" href="structRallyLocation.html#aaaabfdf90e21cefd9dbeb234c7a5e251">lat</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    ret.<a class="code" href="structLocation.html#a5831f0aca9e51a15adb96fad465f72f8">lng</a> = rally_loc.<a class="code" href="structRallyLocation.html#a8227727c3c6fa6ef6739525c0a14bfb1">lng</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">// returns true if a valid rally point is found, otherwise returns false to indicate home position should be used</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classAP__Rally.html#a0b93e6b6133860929bbd7b68be633fa3">  122</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__Rally.html#a0b93e6b6133860929bbd7b68be633fa3">AP_Rally::find_nearest_rally_point</a>(<span class="keyword">const</span> <a class="code" href="structLocation.html">Location</a> &amp;current_loc, <a class="code" href="structRallyLocation.html">RallyLocation</a> &amp;return_loc)<span class="keyword"> const</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">float</span> min_dis = -1;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structLocation.html">Location</a> &amp;home_loc = <a class="code" href="classAP__Rally.html#a554e80a07d4d838334c50d575e8b811f">_ahrs</a>.<a class="code" href="classAP__AHRS.html#aea45b16e6469a3b392b8bf52fb864732">get_home</a>();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; (uint8_t) <a class="code" href="classAP__Rally.html#a7df46c782c4d221590d48b720b9f6457">_rally_point_total_count</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="structRallyLocation.html">RallyLocation</a> next_rally;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classAP__Rally.html#ad47b2b3a30b69eede58ad1f79cd61f11">get_rally_point_with_index</a>(<a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, next_rally)) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="structLocation.html">Location</a> rally_loc = <a class="code" href="classAP__Rally.html#acbee4f7ffe79e701bd44c4c72e1c34d2">rally_location_to_location</a>(next_rally);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">float</span> dis = <a class="code" href="AP__Math_8h.html#aa825a788804b8dd4cf1e3cfb42960a8b">get_distance</a>(current_loc, rally_loc);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (dis &lt; min_dis || min_dis &lt; 0) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            min_dis = dis;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            return_loc = next_rally;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// if home is included, return false (meaning use home) if it is closer than all rally points</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Rally.html#a254081bd2be797fea7ce7308503d9d88">_rally_incl_home</a> &amp;&amp; (<a class="code" href="AP__Math_8h.html#aa825a788804b8dd4cf1e3cfb42960a8b">get_distance</a>(current_loc, home_loc) &lt; min_dis)) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// if a limit is defined and all rally points are beyond that limit, use home if it is closer</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classAP__Rally.html#a4c33c19632fe49df12ed4cfdf55e35e9">_rally_limit_km</a> &gt; 0) &amp;&amp; (min_dis &gt; <a class="code" href="classAP__Rally.html#a4c33c19632fe49df12ed4cfdf55e35e9">_rally_limit_km</a>*1000.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>) &amp;&amp; (<a class="code" href="AP__Math_8h.html#aa825a788804b8dd4cf1e3cfb42960a8b">get_distance</a>(current_loc, home_loc) &lt; min_dis)) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// use home position</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// use home if no rally points found</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">return</span> min_dis &gt;= 0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">// return best RTL location from current position</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classAP__Rally.html#ae280e2921f301fa4cc3991bc85d91801">  156</a></span>&#160;<a class="code" href="structLocation.html">Location</a> <a class="code" href="classAP__Rally.html#ae280e2921f301fa4cc3991bc85d91801">AP_Rally::calc_best_rally_or_home_location</a>(<span class="keyword">const</span> <a class="code" href="structLocation.html">Location</a> &amp;current_loc, <span class="keywordtype">float</span> rtl_home_alt)<span class="keyword"> const</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="structRallyLocation.html">RallyLocation</a> ral_loc = {};</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="structLocation.html">Location</a> return_loc = {};</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structLocation.html">Location</a> &amp;home_loc = <a class="code" href="classAP__Rally.html#a554e80a07d4d838334c50d575e8b811f">_ahrs</a>.<a class="code" href="classAP__AHRS.html#aea45b16e6469a3b392b8bf52fb864732">get_home</a>();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Rally.html#a0b93e6b6133860929bbd7b68be633fa3">find_nearest_rally_point</a>(current_loc, ral_loc)) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">// valid rally point found</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        return_loc = <a class="code" href="classAP__Rally.html#acbee4f7ffe79e701bd44c4c72e1c34d2">rally_location_to_location</a>(ral_loc);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// no valid rally point, return home position</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        return_loc = home_loc;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        return_loc.<a class="code" href="structLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">alt</a> = rtl_home_alt;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        return_loc.<a class="code" href="structLocation.html#ad9759dba1fc13f13c531ebdcb2c9588e">flags</a>.<a class="code" href="structLocation__Option__Flags.html#a3f0f17e655550917bc3177e876d6dc14">relative_alt</a> = <span class="keyword">false</span>; <span class="comment">// read_alt_to_hold returns an absolute altitude</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">return</span> return_loc;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="classAP__Rally_html_a906e63c18a936240cb1f85563e9ee9df"><div class="ttname"><a href="classAP__Rally.html#a906e63c18a936240cb1f85563e9ee9df">AP_Rally::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00063">AP_Rally.h:63</a></div></div>
<div class="ttc" id="structRallyLocation_html_a8227727c3c6fa6ef6739525c0a14bfb1"><div class="ttname"><a href="structRallyLocation.html#a8227727c3c6fa6ef6739525c0a14bfb1">RallyLocation::lng</a></div><div class="ttdeci">int32_t lng</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00029">AP_Rally.h:29</a></div></div>
<div class="ttc" id="classAP__Rally_html_a554e80a07d4d838334c50d575e8b811f"><div class="ttname"><a href="classAP__Rally.html#a554e80a07d4d838334c50d575e8b811f">AP_Rally::_ahrs</a></div><div class="ttdeci">const AP_AHRS &amp; _ahrs</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00069">AP_Rally.h:69</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_a26b68339fc68a562d8d3a1238d0ec8c1"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">AP_HAL::Scheduler::millis</a></div><div class="ttdeci">virtual uint32_t millis()=0</div></div>
<div class="ttc" id="classAP__Rally_html"><div class="ttname"><a href="classAP__Rally.html">AP_Rally</a></div><div class="ttdoc">Object managing Rally Points. </div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00040">AP_Rally.h:40</a></div></div>
<div class="ttc" id="classAP__Rally_html_a0b93e6b6133860929bbd7b68be633fa3"><div class="ttname"><a href="classAP__Rally.html#a0b93e6b6133860929bbd7b68be633fa3">AP_Rally::find_nearest_rally_point</a></div><div class="ttdeci">bool find_nearest_rally_point(const Location &amp;myloc, RallyLocation &amp;ret) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00122">AP_Rally.cpp:122</a></div></div>
<div class="ttc" id="AP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="AP__Param_8h_html_abe1c2a65ce5455bf37f3c000b4241c00"><div class="ttname"><a href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, class, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00046">AP_Param.h:46</a></div></div>
<div class="ttc" id="structRallyLocation_html"><div class="ttname"><a href="structRallyLocation.html">RallyLocation</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00027">AP_Rally.h:27</a></div></div>
<div class="ttc" id="GCS__Console_2examples_2Console_2Console_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="GCS__Console_2examples_2Console_2Console_8cpp_source.html#l00055">Console.cpp:55</a></div></div>
<div class="ttc" id="classAP__Rally_html_a4c33c19632fe49df12ed4cfdf55e35e9"><div class="ttname"><a href="classAP__Rally.html#a4c33c19632fe49df12ed4cfdf55e35e9">AP_Rally::_rally_limit_km</a></div><div class="ttdeci">AP_Float _rally_limit_km</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00073">AP_Rally.h:73</a></div></div>
<div class="ttc" id="classAP__AHRS_html"><div class="ttname"><a href="classAP__AHRS.html">AP_AHRS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00048">AP_AHRS.h:48</a></div></div>
<div class="ttc" id="classAP__Rally_html_a44f72c79ead390458f8dee9d0d4ca458"><div class="ttname"><a href="classAP__Rally.html#a44f72c79ead390458f8dee9d0d4ca458">AP_Rally::_last_change_time_ms</a></div><div class="ttdeci">uint32_t _last_change_time_ms</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00076">AP_Rally.h:76</a></div></div>
<div class="ttc" id="classStorageAccess_html_ab2a8575d541549a15645edc360fdaa91"><div class="ttname"><a href="classStorageAccess.html#ab2a8575d541549a15645edc360fdaa91">StorageAccess::read_block</a></div><div class="ttdeci">bool read_block(void *dst, uint16_t src, size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="StorageManager_8cpp_source.html#l00130">StorageManager.cpp:130</a></div></div>
<div class="ttc" id="AP__Rally_8cpp_html_a9090efafdd1cacb7aa5646da3ef2bee0"><div class="ttname"><a href="AP__Rally_8cpp.html#a9090efafdd1cacb7aa5646da3ef2bee0">RALLY_LIMIT_KM_DEFAULT</a></div><div class="ttdeci">#define RALLY_LIMIT_KM_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00028">AP_Rally.cpp:28</a></div></div>
<div class="ttc" id="classAP__Rally_html_a7d931e38aad349dec7ef42965f8d6a60"><div class="ttname"><a href="classAP__Rally.html#a7d931e38aad349dec7ef42965f8d6a60">AP_Rally::set_rally_point_with_index</a></div><div class="ttdeci">bool set_rally_point_with_index(uint8_t i, const RallyLocation &amp;rallyLoc)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00085">AP_Rally.cpp:85</a></div></div>
<div class="ttc" id="structRallyLocation_html_adfdbf88bff5056e7c569909ba7ff67f5"><div class="ttname"><a href="structRallyLocation.html#adfdbf88bff5056e7c569909ba7ff67f5">RallyLocation::alt</a></div><div class="ttdeci">int16_t alt</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00030">AP_Rally.h:30</a></div></div>
<div class="ttc" id="classAP__Rally_html_ae280e2921f301fa4cc3991bc85d91801"><div class="ttname"><a href="classAP__Rally.html#ae280e2921f301fa4cc3991bc85d91801">AP_Rally::calc_best_rally_or_home_location</a></div><div class="ttdeci">Location calc_best_rally_or_home_location(const Location &amp;current_loc, float rtl_home_alt) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00156">AP_Rally.cpp:156</a></div></div>
<div class="ttc" id="structLocation_html_ae51548c2cf32311043ca19b94b9a9223"><div class="ttname"><a href="structLocation.html#ae51548c2cf32311043ca19b94b9a9223">Location::lat</a></div><div class="ttdeci">int32_t lat</div><div class="ttdoc">param 3 - Lattitude * 10**7 </div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00123">AP_Common.h:123</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aea45b16e6469a3b392b8bf52fb864732"><div class="ttname"><a href="classAP__AHRS.html#aea45b16e6469a3b392b8bf52fb864732">AP_AHRS::get_home</a></div><div class="ttdeci">const struct Location &amp; get_home(void) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00358">AP_AHRS.h:358</a></div></div>
<div class="ttc" id="classAP__Rally_html_a9db74353c18234a7cede605c47840e9f"><div class="ttname"><a href="classAP__Rally.html#a9db74353c18234a7cede605c47840e9f">AP_Rally::get_rally_max</a></div><div class="ttdeci">uint8_t get_rally_max(void) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00049">AP_Rally.h:49</a></div></div>
<div class="ttc" id="AP__Rally_8h_html"><div class="ttname"><a href="AP__Rally_8h.html">AP_Rally.h</a></div><div class="ttdoc">Handles rally point storage and retrieval. </div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00015">HAL.h:15</a></div></div>
<div class="ttc" id="structLocation_html_a89e532f5bcc13db2f51ff9eed667c2b6"><div class="ttname"><a href="structLocation.html#a89e532f5bcc13db2f51ff9eed667c2b6">Location::alt</a></div><div class="ttdeci">int32_t alt</div><div class="ttdoc">param 2 - Altitude in centimeters (meters * 100) </div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00122">AP_Common.h:122</a></div></div>
<div class="ttc" id="DerivativeFilter_8cpp_html_a357394e0f6f88c8a57bd893ab28dc8f8"><div class="ttname"><a href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a></div><div class="ttdeci">#define f(i)</div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00078">AP_Param.h:78</a></div></div>
<div class="ttc" id="structLocation_html_ad9759dba1fc13f13c531ebdcb2c9588e"><div class="ttname"><a href="structLocation.html#ad9759dba1fc13f13c531ebdcb2c9588e">Location::flags</a></div><div class="ttdeci">Location_Option_Flags flags</div><div class="ttdoc">options bitmask (1<<0 = relative altitude) </div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00115">AP_Common.h:115</a></div></div>
<div class="ttc" id="classAP__Rally_html_a1712d3afc63c3815dfc08543d07c24ad"><div class="ttname"><a href="classAP__Rally.html#a1712d3afc63c3815dfc08543d07c24ad">AP_Rally::_storage</a></div><div class="ttdeci">static StorageAccess _storage</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00066">AP_Rally.h:66</a></div></div>
<div class="ttc" id="AP__Rally_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__Rally_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00010">AC_PID_test.cpp:10</a></div></div>
<div class="ttc" id="structLocation_html_a5831f0aca9e51a15adb96fad465f72f8"><div class="ttname"><a href="structLocation.html#a5831f0aca9e51a15adb96fad465f72f8">Location::lng</a></div><div class="ttdeci">int32_t lng</div><div class="ttdoc">param 4 - Longitude * 10**7 </div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00124">AP_Common.h:124</a></div></div>
<div class="ttc" id="classStorageAccess_html_aa527b50188a7138b173defe07b9b7bf6"><div class="ttname"><a href="classStorageAccess.html#aa527b50188a7138b173defe07b9b7bf6">StorageAccess::write_block</a></div><div class="ttdeci">bool write_block(uint16_t dst, const void *src, size_t n) const </div><div class="ttdef"><b>Definition:</b> <a href="StorageManager_8cpp_source.html#l00170">StorageManager.cpp:170</a></div></div>
<div class="ttc" id="classStorageAccess_html"><div class="ttname"><a href="classStorageAccess.html">StorageAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="StorageManager_8h_source.html#l00077">StorageManager.h:77</a></div></div>
<div class="ttc" id="classAP__Rally_html_a254081bd2be797fea7ce7308503d9d88"><div class="ttname"><a href="classAP__Rally.html#a254081bd2be797fea7ce7308503d9d88">AP_Rally::_rally_incl_home</a></div><div class="ttdeci">AP_Int8 _rally_incl_home</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00074">AP_Rally.h:74</a></div></div>
<div class="ttc" id="classAP__Rally_html_ad47b2b3a30b69eede58ad1f79cd61f11"><div class="ttname"><a href="classAP__Rally.html#ad47b2b3a30b69eede58ad1f79cd61f11">AP_Rally::get_rally_point_with_index</a></div><div class="ttdeci">bool get_rally_point_with_index(uint8_t i, RallyLocation &amp;ret) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00069">AP_Rally.cpp:69</a></div></div>
<div class="ttc" id="AHRS__Test_8cpp_html_a0a15280249072432f8c559cc00d09dee"><div class="ttname"><a href="AHRS__Test_8cpp.html#a0a15280249072432f8c559cc00d09dee">ahrs</a></div><div class="ttdeci">AP_AHRS_DCM ahrs(ins, baro, gps)</div></div>
<div class="ttc" id="classAP__Rally_html_acbee4f7ffe79e701bd44c4c72e1c34d2"><div class="ttname"><a href="classAP__Rally.html#acbee4f7ffe79e701bd44c4c72e1c34d2">AP_Rally::rally_location_to_location</a></div><div class="ttdeci">Location rally_location_to_location(const RallyLocation &amp;ret) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00103">AP_Rally.cpp:103</a></div></div>
<div class="ttc" id="classAP__Rally_html_a7df46c782c4d221590d48b720b9f6457"><div class="ttname"><a href="classAP__Rally.html#a7df46c782c4d221590d48b720b9f6457">AP_Rally::_rally_point_total_count</a></div><div class="ttdeci">AP_Int8 _rally_point_total_count</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00072">AP_Rally.h:72</a></div></div>
<div class="ttc" id="AP__Math_8h_html_aa825a788804b8dd4cf1e3cfb42960a8b"><div class="ttname"><a href="AP__Math_8h.html#aa825a788804b8dd4cf1e3cfb42960a8b">get_distance</a></div><div class="ttdeci">float get_distance(const struct Location &amp;loc1, const struct Location &amp;loc2)</div><div class="ttdef"><b>Definition:</b> <a href="location_8cpp_source.html#l00058">location.cpp:58</a></div></div>
<div class="ttc" id="structRallyLocation_html_aaaabfdf90e21cefd9dbeb234c7a5e251"><div class="ttname"><a href="structRallyLocation.html#aaaabfdf90e21cefd9dbeb234c7a5e251">RallyLocation::lat</a></div><div class="ttdeci">int32_t lat</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8h_source.html#l00028">AP_Rally.h:28</a></div></div>
<div class="ttc" id="classAP__Rally_html_add46a641ab976409ed4e4be01c201dc7"><div class="ttname"><a href="classAP__Rally.html#add46a641ab976409ed4e4be01c201dc7">AP_Rally::AP_Rally</a></div><div class="ttdeci">AP_Rally(AP_AHRS &amp;ahrs)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00061">AP_Rally.cpp:61</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00053">AP_Param.h:53</a></div></div>
<div class="ttc" id="AP__Rally_8cpp_html_a6cf8535f6d897b3dadefb50cf2d61e8a"><div class="ttname"><a href="AP__Rally_8cpp.html#a6cf8535f6d897b3dadefb50cf2d61e8a">RALLY_INCLUDE_HOME_DEFAULT</a></div><div class="ttdeci">#define RALLY_INCLUDE_HOME_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Rally_8cpp_source.html#l00032">AP_Rally.cpp:32</a></div></div>
<div class="ttc" id="classStorageManager_html_a8a47a036f4478b1631984c9577d73a46a42e46109d6193f717d28cbc3c5f40c14"><div class="ttname"><a href="classStorageManager.html#a8a47a036f4478b1631984c9577d73a46a42e46109d6193f717d28cbc3c5f40c14">StorageManager::StorageRally</a></div><div class="ttdef"><b>Definition:</b> <a href="StorageManager_8h_source.html#l00051">StorageManager.h:51</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a94ab41309b1ff10b8b862b826e59c882"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">AP_HAL::HAL::scheduler</a></div><div class="ttdeci">AP_HAL::Scheduler * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00087">HAL.h:87</a></div></div>
<div class="ttc" id="structLocation__Option__Flags_html_a3f0f17e655550917bc3177e876d6dc14"><div class="ttname"><a href="structLocation__Option__Flags.html#a3f0f17e655550917bc3177e876d6dc14">Location_Option_Flags::relative_alt</a></div><div class="ttdeci">uint8_t relative_alt</div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00107">AP_Common.h:107</a></div></div>
<div class="ttc" id="classAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8cpp_source.html#l00929">AP_Param.cpp:929</a></div></div>
<div class="ttc" id="structLocation_html"><div class="ttname"><a href="structLocation.html">Location</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00113">AP_Common.h:113</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 14 2015 23:43:17 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
