<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>APM:Libraries: libraries/AP_BattMonitor/AP_BattMonitor.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_210b3cddc805c7c91973d20121d570cf.html">AP_BattMonitor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_BattMonitor.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__BattMonitor_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__BattMonitor_8h.html">AP_BattMonitor.h</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__BattMonitor__Analog_8h.html">AP_BattMonitor_Analog.h</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__BattMonitor__SMBus_8h.html">AP_BattMonitor_SMBus.h</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__BattMonitor__Bebop_8h.html">AP_BattMonitor_Bebop.h</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__BattMonitor_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classAP__BattMonitor.html#ace3b43a12479d442d931f85e7c8e5000">AP_BattMonitor::var_info</a>[] = {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <span class="comment">// @Param: _MONITOR</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="comment">// @DisplayName: Battery monitoring</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="comment">// @Description: Controls enabling monitoring of the battery&#39;s voltage and current</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="comment">// @Values: 0:Disabled,3:Analog Voltage Only,4:Analog Voltage and Current,5:SMBus,6:Bebop</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_MONITOR&quot;</span>, 0, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _monitoring[0], BattMonitor_TYPE_NONE),</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">// @Param: _VOLT_PIN</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// @DisplayName: Battery Voltage sensing pin</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">// @Description: Setting this to 0 ~ 13 will enable battery voltage sensing on pins A0 ~ A13. For the 3DR power brick on APM2.5 it should be set to 13. On the PX4 it should be set to 100. On the Pixhawk powered from the PM connector it should be set to 2.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">// @Values: -1:Disabled, 0:A0, 1:A1, 2:Pixhawk, 13:A13, 100:PX4</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_VOLT_PIN&quot;</span>, 1, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _volt_pin[0], <a class="code" href="AP__BattMonitor__Analog_8h.html#ad071e5f6f02fe9047f9ff601eaffb348">AP_BATT_VOLT_PIN</a>),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// @Param: _CURR_PIN</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// @DisplayName: Battery Current sensing pin</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// @Description: Setting this to 0 ~ 13 will enable battery current sensing on pins A0 ~ A13. For the 3DR power brick on APM2.5 it should be set to 12. On the PX4 it should be set to 101. On the Pixhawk powered from the PM connector it should be set to 3.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// @Values: -1:Disabled, 1:A1, 2:A2, 3:Pixhawk, 12:A12, 101:PX4</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_CURR_PIN&quot;</span>, 2, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _curr_pin[0], <a class="code" href="AP__BattMonitor__Analog_8h.html#a9b46f5bb27fdd1ebd697d4df5f050ca5">AP_BATT_CURR_PIN</a>),</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// @Param: _VOLT_MULT</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// @DisplayName: Voltage Multiplier</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// @Description: Used to convert the voltage of the voltage sensing pin (BATT_VOLT_PIN) to the actual battery&#39;s voltage (pin_voltage * VOLT_MULT). For the 3DR Power brick on APM2 or Pixhawk, this should be set to 10.1. For the Pixhawk with the 3DR 4in1 ESC this should be 12.02. For the PX4 using the PX4IO power supply this should be set to 1.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_VOLT_MULT&quot;</span>, 3, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _volt_multiplier[0], <a class="code" href="AP__BattMonitor__Analog_8h.html#ad30e2aa2e3f441e417b22744c8f90e8a">AP_BATT_VOLTDIVIDER_DEFAULT</a>),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// @Param: _AMP_PERVOLT</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// @DisplayName: Amps per volt</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// @Description: Number of amps that a 1V reading on the current sensor corresponds to. On the APM2 or Pixhawk using the 3DR Power brick this should be set to 17. For the Pixhawk with the 3DR 4in1 ESC this should be 17.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// @Units: Amps/Volt</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_AMP_PERVOLT&quot;</span>, 4, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _curr_amp_per_volt[0], <a class="code" href="AP__BattMonitor__Analog_8h.html#ac1f3bd8a99937361877fc91c0f50b965">AP_BATT_CURR_AMP_PERVOLT_DEFAULT</a>),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// @Param: _AMP_OFFSET</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// @DisplayName: AMP offset</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// @Description: Voltage offset at zero current on current sensor</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// @Units: Volts</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_AMP_OFFSET&quot;</span>, 5, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _curr_amp_offset[0], 0),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// @Param: _CAPACITY</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// @DisplayName: Battery capacity</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// @Description: Capacity of the battery in mAh when full</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// @Units: mAh</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// @Increment: 50</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;_CAPACITY&quot;</span>, 6, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _pack_capacity[0], <a class="code" href="AP__BattMonitor_8h.html#ad6e98ed4cdfab0858643a4a60a6af9f9">AP_BATT_CAPACITY_DEFAULT</a>),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// 7 &amp; 8 were used for VOLT2_PIN and VOLT2_MULT</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// 9..10 left for future expansion</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#if AP_BATT_MONITOR_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// @Param: 2_MONITOR</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// @DisplayName: Battery monitoring</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// @Description: Controls enabling monitoring of the battery&#39;s voltage and current</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// @Values: 0:Disabled,3:Analog Voltage Only,4:Analog Voltage and Current,5:SMBus,6:Bebop</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_MONITOR&quot;</span>, 11, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _monitoring[1], BattMonitor_TYPE_NONE),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// @Param: 2_VOLT_PIN</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// @DisplayName: Battery Voltage sensing pin</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// @Description: Setting this to 0 ~ 13 will enable battery voltage sensing on pins A0 ~ A13. For the 3DR power brick on APM2.5 it should be set to 13. On the PX4 it should be set to 100. On the Pixhawk powered from the PM connector it should be set to 2.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// @Values: -1:Disabled, 0:A0, 1:A1, 2:Pixhawk, 13:A13, 100:PX4</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_VOLT_PIN&quot;</span>, 12, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _volt_pin[1], <a class="code" href="AP__BattMonitor__Analog_8h.html#ad071e5f6f02fe9047f9ff601eaffb348">AP_BATT_VOLT_PIN</a>),</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// @Param: 2_CURR_PIN</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// @DisplayName: Battery Current sensing pin</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// @Description: Setting this to 0 ~ 13 will enable battery current sensing on pins A0 ~ A13. For the 3DR power brick on APM2.5 it should be set to 12. On the PX4 it should be set to 101. On the Pixhawk powered from the PM connector it should be set to 3.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// @Values: -1:Disabled, 1:A1, 2:A2, 3:Pixhawk, 12:A12, 101:PX4</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_CURR_PIN&quot;</span>, 13, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _curr_pin[1], <a class="code" href="AP__BattMonitor__Analog_8h.html#a9b46f5bb27fdd1ebd697d4df5f050ca5">AP_BATT_CURR_PIN</a>),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// @Param: 2_VOLT_MULT</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// @DisplayName: Voltage Multiplier</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// @Description: Used to convert the voltage of the voltage sensing pin (BATT_VOLT_PIN) to the actual battery&#39;s voltage (pin_voltage * VOLT_MULT). For the 3DR Power brick on APM2 or Pixhawk, this should be set to 10.1. For the Pixhawk with the 3DR 4in1 ESC this should be 12.02. For the PX4 using the PX4IO power supply this should be set to 1.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_VOLT_MULT&quot;</span>, 14, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _volt_multiplier[1], <a class="code" href="AP__BattMonitor__Analog_8h.html#ad30e2aa2e3f441e417b22744c8f90e8a">AP_BATT_VOLTDIVIDER_DEFAULT</a>),</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// @Param: 2_AMP_PERVOL</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// @DisplayName: Amps per volt</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// @Description: Number of amps that a 1V reading on the current sensor corresponds to. On the APM2 or Pixhawk using the 3DR Power brick this should be set to 17. For the Pixhawk with the 3DR 4in1 ESC this should be 17.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// @Units: Amps/Volt</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_AMP_PERVOL&quot;</span>, 15, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _curr_amp_per_volt[1], <a class="code" href="AP__BattMonitor__Analog_8h.html#ac1f3bd8a99937361877fc91c0f50b965">AP_BATT_CURR_AMP_PERVOLT_DEFAULT</a>),</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// @Param: 2_AMP_OFFSET</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// @DisplayName: AMP offset</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// @Description: Voltage offset at zero current on current sensor</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// @Units: Volts</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_AMP_OFFSET&quot;</span>, 16, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _curr_amp_offset[1], 0),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// @Param: 2_CAPACITY</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// @DisplayName: Battery capacity</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// @Description: Capacity of the battery in mAh when full</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// @Units: mAh</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// @Increment: 50</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// @User: Standard</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;2_CAPACITY&quot;</span>, 17, <a class="code" href="classAP__BattMonitor.html">AP_BattMonitor</a>, _pack_capacity[1], <a class="code" href="AP__BattMonitor_8h.html#ad6e98ed4cdfab0858643a4a60a6af9f9">AP_BATT_CAPACITY_DEFAULT</a>),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif // AP_BATT_MONITOR_MAX_INSTANCES &gt; 1</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;};</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">// Default constructor.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">// Note that the Vector/Matrix constructors already implicitly zero</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">// their values.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#aaed251d031fd70a8a10eeb41fc0bc901">  121</a></span>&#160;<a class="code" href="classAP__BattMonitor.html#aaed251d031fd70a8a10eeb41fc0bc901">AP_BattMonitor::AP_BattMonitor</a>(<span class="keywordtype">void</span>) :</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    _num_instances(0)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, <a class="code" href="classAP__BattMonitor.html#ace3b43a12479d442d931f85e7c8e5000">var_info</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">// init - instantiate the battery monitors</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#ac1a8593b0b20f9316f22084947bae7fe">  129</a></span>&#160;<a class="code" href="classAP__BattMonitor.html#ac1a8593b0b20f9316f22084947bae7fe">AP_BattMonitor::init</a>()</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// check init has not been called before</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a> != 0) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD_SUBTYPE == HAL_BOARD_SUBTYPE_LINUX_BEBOP</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// force monitor for bebop</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classAP__BattMonitor.html#a39b40297a07e247decc4179ed89d3619">_monitoring</a>[0] = <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea82dfa9215078a290a93b78b2e9c278cf">BattMonitor_TYPE_BEBOP</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// create each instance</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">for</span> (uint8_t instance=0; instance&lt;<a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a>; instance++) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        uint8_t monitor_type = <a class="code" href="classAP__BattMonitor.html#a39b40297a07e247decc4179ed89d3619">_monitoring</a>[instance];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">switch</span> (monitor_type) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea721c190313aa9821b12ee2a5d11015b6">BattMonitor_TYPE_ANALOG_VOLTAGE_ONLY</a>:</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4eaae3cc59e92d10ceeff91ae4029974118">BattMonitor_TYPE_ANALOG_VOLTAGE_AND_CURRENT</a>:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="structAP__BattMonitor_1_1BattMonitor__State.html#a8a170bff721c6e34803b4ca19408d6a9">instance</a> = instance;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] = <span class="keyword">new</span> <a class="code" href="classAP__BattMonitor.html#a374cde9bd46870b96bf6c56bed1e1f4b">AP_BattMonitor_Analog</a>(*<span class="keyword">this</span>, instance, <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance]);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a>++;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea8a5a6652f8338bef758684961260d9cb">BattMonitor_TYPE_SMBUS</a>:</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="structAP__BattMonitor_1_1BattMonitor__State.html#a8a170bff721c6e34803b4ca19408d6a9">instance</a> = instance;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_PX4</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] = <span class="keyword">new</span> <a class="code" href="classAP__BattMonitor.html#aee73f71d2fed25fdda14f23b2cd47d94">AP_BattMonitor_SMBus_PX4</a>(*<span class="keyword">this</span>, instance, <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance]);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] = <span class="keyword">new</span> <a class="code" href="classAP__BattMonitor.html#a733509d65c02a69120f2a35dea9c8f65">AP_BattMonitor_SMBus_I2C</a>(*<span class="keyword">this</span>, instance, <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance]);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a>++;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea82dfa9215078a290a93b78b2e9c278cf">BattMonitor_TYPE_BEBOP</a>:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD_SUBTYPE == HAL_BOARD_SUBTYPE_LINUX_BEBOP</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="structAP__BattMonitor_1_1BattMonitor__State.html#a8a170bff721c6e34803b4ca19408d6a9">instance</a> = instance;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] = <span class="keyword">new</span> <a class="code" href="classAP__BattMonitor__Bebop.html">AP_BattMonitor_Bebop</a>(*<span class="keyword">this</span>, instance, <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance]);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a>++;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// call init function for each backend</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] != NULL) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance]-&gt;<a class="code" href="classAP__BattMonitor__Backend.html#a333708b23c3532575284833ca4e4f058">init</a>();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">// read - read the voltage and current for all instances</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#a2275643d2998063448035e89cba6f549">  178</a></span>&#160;<a class="code" href="classAP__BattMonitor.html#a2275643d2998063448035e89cba6f549">AP_BattMonitor::read</a>()</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// exit immediately if no monitors setup</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a> == 0) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] != NULL &amp;&amp; <a class="code" href="classAP__BattMonitor.html#a39b40297a07e247decc4179ed89d3619">_monitoring</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] != <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4eae1cca70ba3ff7730316a34e6d5d4eda9">BattMonitor_TYPE_NONE</a>) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]-&gt;<a class="code" href="classAP__BattMonitor__Backend.html#a0aab3a98b369ed9e0e3bd2dae5a4e6ac">read</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">// healthy - returns true if monitor is functioning</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#a845847408c29df9244cfddb704467cde">  193</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__BattMonitor.html#a77fd8eb02078b6336c63be82f0f5b393">AP_BattMonitor::healthy</a>(uint8_t instance)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> instance &lt; <a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a> &amp;&amp; <a class="code" href="AP__BattMonitor_8h.html#a9217130e69cdf3f19505d4523eacf527">_BattMonitor_STATE</a>(instance).healthy;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#a94dc19b1a82878c886697ff062377fe7">  198</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__BattMonitor.html#a6dbd2de8640f4fc150b4af300b0b48d3">AP_BattMonitor::has_current</a>(uint8_t instance)<span class="keyword"> const</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// check for analog voltage and current monitor or smbus monitor</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (instance &lt; <a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a>) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] != NULL) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="classAP__BattMonitor.html#a39b40297a07e247decc4179ed89d3619">_monitoring</a>[instance] == <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4eaae3cc59e92d10ceeff91ae4029974118">BattMonitor_TYPE_ANALOG_VOLTAGE_AND_CURRENT</a> ||</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <a class="code" href="classAP__BattMonitor.html#a39b40297a07e247decc4179ed89d3619">_monitoring</a>[instance] == <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea8a5a6652f8338bef758684961260d9cb">BattMonitor_TYPE_SMBUS</a> ||</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    <a class="code" href="classAP__BattMonitor.html#a39b40297a07e247decc4179ed89d3619">_monitoring</a>[instance] == <a class="code" href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea82dfa9215078a290a93b78b2e9c278cf">BattMonitor_TYPE_BEBOP</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// not monitoring current</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#ab5789eb7d45ec25b685adfaaf9167284">  214</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__BattMonitor.html#a36c8688e0c08b8eac5e638fba94bf94d">AP_BattMonitor::voltage</a>(uint8_t instance)<span class="keyword"> const</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (instance &lt; <a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a>) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AP__BattMonitor_8h.html#a9217130e69cdf3f19505d4523eacf527">_BattMonitor_STATE</a>(instance).voltage;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">// voltage2 - returns the voltage of the second battery (helper function to send 2nd voltage to GCS)</span></div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#a08b53e709a3bd620196721e561afb6f3">  224</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__BattMonitor.html#a08b53e709a3bd620196721e561afb6f3">AP_BattMonitor::voltage2</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// exit immediately if one or fewer monitors</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a> &lt; 2) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// get next battery&#39;s voltage</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">for</span> (uint8_t <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=1; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a>; <a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[<a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] != NULL) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="AP__BattMonitor_8h.html#a9217130e69cdf3f19505d4523eacf527">_BattMonitor_STATE</a>(<a class="code" href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>).voltage;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// if we somehow got here, return zero</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#af73075a42b0aa50dca77e16625fb1122">  243</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__BattMonitor.html#a28dde9cd42525477feef95678df4466e">AP_BattMonitor::current_amps</a>(uint8_t instance)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">if</span> (instance &lt; <a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a>) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AP__BattMonitor_8h.html#a9217130e69cdf3f19505d4523eacf527">_BattMonitor_STATE</a>(instance).current_amps;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#a5744db673ce4cbaffe3da159451c3d5f">  252</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__BattMonitor.html#af39d7e98bbdb2a8dc89cc093cbac3e0b">AP_BattMonitor::current_total_mah</a>(uint8_t instance)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (instance &lt; <a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a>) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="AP__BattMonitor_8h.html#a9217130e69cdf3f19505d4523eacf527">_BattMonitor_STATE</a>(instance).current_total_mah;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#af18badc88524b2cf400fb43418daa8c9">  261</a></span>&#160;uint8_t <a class="code" href="classAP__BattMonitor.html#af708f7853d4d9f1eb84511527cc378d3">AP_BattMonitor::capacity_remaining_pct</a>(uint8_t instance)<span class="keyword"> const</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a> == 0 || instance &gt;= <a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a> || <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] == NULL) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance]-&gt;<a class="code" href="classAP__BattMonitor__Backend.html#a47fe3bc306e5ff449a93b3095fb915bb">capacity_remaining_pct</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classAP__BattMonitor.html#af4f82f91854e1a8b04745ab05f932c0f">  271</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__BattMonitor.html#af4f82f91854e1a8b04745ab05f932c0f">AP_BattMonitor::exhausted</a>(uint8_t instance, <span class="keywordtype">float</span> low_voltage, <span class="keywordtype">float</span> min_capacity_mah)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// exit immediately if no monitors setup</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">_num_instances</a> == 0 || instance &gt;= <a class="code" href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a> || <a class="code" href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">drivers</a>[instance] == NULL) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// get current time</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    uint32_t tnow = hal.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">millis</a>();</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// check voltage</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="classAP__BattMonitor.html#a36c8688e0c08b8eac5e638fba94bf94d">voltage</a> &gt; 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>) &amp;&amp; (low_voltage &gt; 0) &amp;&amp; (<a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="classAP__BattMonitor.html#a36c8688e0c08b8eac5e638fba94bf94d">voltage</a> &lt; low_voltage)) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">// this is the first time our voltage has dropped below minimum so start timer</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].low_voltage_start_ms == 0) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="structAP__BattMonitor_1_1BattMonitor__State.html#a03f7696810cc37fa1ef520e1a211a57c">low_voltage_start_ms</a> = tnow;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (tnow - <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].low_voltage_start_ms &gt; <a class="code" href="AP__BattMonitor_8h.html#a33062d7007b42121c6316f23004fda8c">AP_BATT_LOW_VOLT_TIMEOUT_MS</a>) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">// acceptable voltage so reset timer</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="structAP__BattMonitor_1_1BattMonitor__State.html#a03f7696810cc37fa1ef520e1a211a57c">low_voltage_start_ms</a> = 0;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// check capacity if current monitoring is enabled</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BattMonitor.html#a6dbd2de8640f4fc150b4af300b0b48d3">has_current</a>(instance) &amp;&amp; (min_capacity_mah&gt;0) &amp;&amp; (<a class="code" href="classAP__BattMonitor.html#ad57aef98521a5819d87d9dff057b9a65">_pack_capacity</a>[instance] - <a class="code" href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">state</a>[instance].<a class="code" href="classAP__BattMonitor.html#af39d7e98bbdb2a8dc89cc093cbac3e0b">current_total_mah</a> &lt; min_capacity_mah)) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// if we&#39;ve gotten this far battery is ok</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="ttc" id="classAP__BattMonitor__Backend_html_a333708b23c3532575284833ca4e4f058"><div class="ttname"><a href="classAP__BattMonitor__Backend.html#a333708b23c3532575284833ca4e4f058">AP_BattMonitor_Backend::init</a></div><div class="ttdeci">virtual void init()</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor__Backend_8h_source.html#l00035">AP_BattMonitor_Backend.h:35</a></div></div>
<div class="ttc" id="AP__BattMonitor__Analog_8h_html"><div class="ttname"><a href="AP__BattMonitor__Analog_8h.html">AP_BattMonitor_Analog.h</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_ac1a8593b0b20f9316f22084947bae7fe"><div class="ttname"><a href="classAP__BattMonitor.html#ac1a8593b0b20f9316f22084947bae7fe">AP_BattMonitor::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8cpp_source.html#l00129">AP_BattMonitor.cpp:129</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_af708f7853d4d9f1eb84511527cc378d3"><div class="ttname"><a href="classAP__BattMonitor.html#af708f7853d4d9f1eb84511527cc378d3">AP_BattMonitor::capacity_remaining_pct</a></div><div class="ttdeci">uint8_t capacity_remaining_pct() const </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00094">AP_BattMonitor.h:94</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_a26b68339fc68a562d8d3a1238d0ec8c1"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#a26b68339fc68a562d8d3a1238d0ec8c1">AP_HAL::Scheduler::millis</a></div><div class="ttdeci">virtual uint32_t millis()=0</div></div>
<div class="ttc" id="classAP__BattMonitor_html_a858d31069c24d1df9f54d5aa8f5ffa4ea721c190313aa9821b12ee2a5d11015b6"><div class="ttname"><a href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea721c190313aa9821b12ee2a5d11015b6">AP_BattMonitor::BattMonitor_TYPE_ANALOG_VOLTAGE_ONLY</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00041">AP_BattMonitor.h:41</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_ace3b43a12479d442d931f85e7c8e5000"><div class="ttname"><a href="classAP__BattMonitor.html#ace3b43a12479d442d931f85e7c8e5000">AP_BattMonitor::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00107">AP_BattMonitor.h:107</a></div></div>
<div class="ttc" id="AP__BattMonitor_8h_html"><div class="ttname"><a href="AP__BattMonitor_8h.html">AP_BattMonitor.h</a></div></div>
<div class="ttc" id="AP__BattMonitor__Analog_8h_html_a9b46f5bb27fdd1ebd697d4df5f050ca5"><div class="ttname"><a href="AP__BattMonitor__Analog_8h.html#a9b46f5bb27fdd1ebd697d4df5f050ca5">AP_BATT_CURR_PIN</a></div><div class="ttdeci">#define AP_BATT_CURR_PIN</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor__Analog_8h_source.html#l00017">AP_BattMonitor_Analog.h:17</a></div></div>
<div class="ttc" id="AP__Param_8h_html_abe1c2a65ce5455bf37f3c000b4241c00"><div class="ttname"><a href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, class, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00046">AP_Param.h:46</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a733509d65c02a69120f2a35dea9c8f65"><div class="ttname"><a href="classAP__BattMonitor.html#a733509d65c02a69120f2a35dea9c8f65">AP_BattMonitor::AP_BattMonitor_SMBus_I2C</a></div><div class="ttdeci">friend class AP_BattMonitor_SMBus_I2C</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00030">AP_BattMonitor.h:30</a></div></div>
<div class="ttc" id="GCS__Console_2examples_2Console_2Console_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="GCS__Console_2examples_2Console_2Console_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="GCS__Console_2examples_2Console_2Console_8cpp_source.html#l00055">Console.cpp:55</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a858d31069c24d1df9f54d5aa8f5ffa4ea82dfa9215078a290a93b78b2e9c278cf"><div class="ttname"><a href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea82dfa9215078a290a93b78b2e9c278cf">AP_BattMonitor::BattMonitor_TYPE_BEBOP</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00044">AP_BattMonitor.h:44</a></div></div>
<div class="ttc" id="AP__BattMonitor_8h_html_a9217130e69cdf3f19505d4523eacf527"><div class="ttname"><a href="AP__BattMonitor_8h.html#a9217130e69cdf3f19505d4523eacf527">_BattMonitor_STATE</a></div><div class="ttdeci">#define _BattMonitor_STATE(instance)</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00067">AP_BattMonitor.h:67</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_af4f82f91854e1a8b04745ab05f932c0f"><div class="ttname"><a href="classAP__BattMonitor.html#af4f82f91854e1a8b04745ab05f932c0f">AP_BattMonitor::exhausted</a></div><div class="ttdeci">bool exhausted(uint8_t instance, float low_voltage, float min_capacity_mah)</div><div class="ttdoc">exhausted - returns true if the battery&#39;s voltage remains below the low_voltage for 10 seconds or rem...</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8cpp_source.html#l00271">AP_BattMonitor.cpp:271</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a39b40297a07e247decc4179ed89d3619"><div class="ttname"><a href="classAP__BattMonitor.html#a39b40297a07e247decc4179ed89d3619">AP_BattMonitor::_monitoring</a></div><div class="ttdeci">AP_Int8 _monitoring[AP_BATT_MONITOR_MAX_INSTANCES]</div><div class="ttdoc">parameters </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00112">AP_BattMonitor.h:112</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_aee73f71d2fed25fdda14f23b2cd47d94"><div class="ttname"><a href="classAP__BattMonitor.html#aee73f71d2fed25fdda14f23b2cd47d94">AP_BattMonitor::AP_BattMonitor_SMBus_PX4</a></div><div class="ttdeci">friend class AP_BattMonitor_SMBus_PX4</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00031">AP_BattMonitor.h:31</a></div></div>
<div class="ttc" id="classAP__BattMonitor__Backend_html_a47fe3bc306e5ff449a93b3095fb915bb"><div class="ttname"><a href="classAP__BattMonitor__Backend.html#a47fe3bc306e5ff449a93b3095fb915bb">AP_BattMonitor_Backend::capacity_remaining_pct</a></div><div class="ttdeci">uint8_t capacity_remaining_pct() const </div><div class="ttdoc">capacity_remaining_pct - returns the % battery capacity remaining (0 ~ 100) </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor__Backend_8cpp_source.html#l00034">AP_BattMonitor_Backend.cpp:34</a></div></div>
<div class="ttc" id="AP__BattMonitor__Analog_8h_html_ad071e5f6f02fe9047f9ff601eaffb348"><div class="ttname"><a href="AP__BattMonitor__Analog_8h.html#ad071e5f6f02fe9047f9ff601eaffb348">AP_BATT_VOLT_PIN</a></div><div class="ttdeci">#define AP_BATT_VOLT_PIN</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor__Analog_8h_source.html#l00016">AP_BattMonitor_Analog.h:16</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a4c285c6eb509015e2004cc4f164269fa"><div class="ttname"><a href="classAP__BattMonitor.html#a4c285c6eb509015e2004cc4f164269fa">AP_BattMonitor::drivers</a></div><div class="ttdeci">AP_BattMonitor_Backend * drivers[AP_BATT_MONITOR_MAX_INSTANCES]</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00122">AP_BattMonitor.h:122</a></div></div>
<div class="ttc" id="classAP__BattMonitor__Bebop_html"><div class="ttname"><a href="classAP__BattMonitor__Bebop.html">AP_BattMonitor_Bebop</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor__Bebop_8h_source.html#l00024">AP_BattMonitor_Bebop.h:24</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00015">HAL.h:15</a></div></div>
<div class="ttc" id="AP__BattMonitor_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__BattMonitor_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00010">AC_PID_test.cpp:10</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a17993770720a5085d415370f56785b47"><div class="ttname"><a href="classAP__BattMonitor.html#a17993770720a5085d415370f56785b47">AP_BattMonitor::state</a></div><div class="ttdeci">BattMonitor_State state[AP_BATT_MONITOR_MAX_INSTANCES]</div><div class="ttdoc">battery pack capacity less reserve in mAh </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00121">AP_BattMonitor.h:121</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html"><div class="ttname"><a href="classAP__BattMonitor.html">AP_BattMonitor</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00025">AP_BattMonitor.h:25</a></div></div>
<div class="ttc" id="DerivativeFilter_8cpp_html_a357394e0f6f88c8a57bd893ab28dc8f8"><div class="ttname"><a href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a></div><div class="ttdeci">#define f(i)</div></div>
<div class="ttc" id="classAP__BattMonitor_html_a6dbd2de8640f4fc150b4af300b0b48d3"><div class="ttname"><a href="classAP__BattMonitor.html#a6dbd2de8640f4fc150b4af300b0b48d3">AP_BattMonitor::has_current</a></div><div class="ttdeci">bool has_current() const </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00075">AP_BattMonitor.h:75</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_af9262d5b2694e985e6e72cf81e15bb90"><div class="ttname"><a href="classAP__BattMonitor.html#af9262d5b2694e985e6e72cf81e15bb90">AP_BattMonitor::_num_instances</a></div><div class="ttdeci">uint8_t _num_instances</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00123">AP_BattMonitor.h:123</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a08b53e709a3bd620196721e561afb6f3"><div class="ttname"><a href="classAP__BattMonitor.html#a08b53e709a3bd620196721e561afb6f3">AP_BattMonitor::voltage2</a></div><div class="ttdeci">float voltage2() const </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8cpp_source.html#l00224">AP_BattMonitor.cpp:224</a></div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00078">AP_Param.h:78</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_ad57aef98521a5819d87d9dff057b9a65"><div class="ttname"><a href="classAP__BattMonitor.html#ad57aef98521a5819d87d9dff057b9a65">AP_BattMonitor::_pack_capacity</a></div><div class="ttdeci">AP_Int32 _pack_capacity[AP_BATT_MONITOR_MAX_INSTANCES]</div><div class="ttdoc">offset voltage that is subtracted from current pin before conversion to amps </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00118">AP_BattMonitor.h:118</a></div></div>
<div class="ttc" id="AP__BattMonitor_8h_html_ad6e98ed4cdfab0858643a4a60a6af9f9"><div class="ttname"><a href="AP__BattMonitor_8h.html#ad6e98ed4cdfab0858643a4a60a6af9f9">AP_BATT_CAPACITY_DEFAULT</a></div><div class="ttdeci">#define AP_BATT_CAPACITY_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00015">AP_BattMonitor.h:15</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a858d31069c24d1df9f54d5aa8f5ffa4ea8a5a6652f8338bef758684961260d9cb"><div class="ttname"><a href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4ea8a5a6652f8338bef758684961260d9cb">AP_BattMonitor::BattMonitor_TYPE_SMBUS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00043">AP_BattMonitor.h:43</a></div></div>
<div class="ttc" id="AP__BattMonitor__Bebop_8h_html"><div class="ttname"><a href="AP__BattMonitor__Bebop_8h.html">AP_BattMonitor_Bebop.h</a></div></div>
<div class="ttc" id="structAP__BattMonitor_1_1BattMonitor__State_html_a03f7696810cc37fa1ef520e1a211a57c"><div class="ttname"><a href="structAP__BattMonitor_1_1BattMonitor__State.html#a03f7696810cc37fa1ef520e1a211a57c">AP_BattMonitor::BattMonitor_State::low_voltage_start_ms</a></div><div class="ttdeci">uint32_t low_voltage_start_ms</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00055">AP_BattMonitor.h:55</a></div></div>
<div class="ttc" id="AP__BattMonitor_8h_html_a33062d7007b42121c6316f23004fda8c"><div class="ttname"><a href="AP__BattMonitor_8h.html#a33062d7007b42121c6316f23004fda8c">AP_BATT_LOW_VOLT_TIMEOUT_MS</a></div><div class="ttdeci">#define AP_BATT_LOW_VOLT_TIMEOUT_MS</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00016">AP_BattMonitor.h:16</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a77fd8eb02078b6336c63be82f0f5b393"><div class="ttname"><a href="classAP__BattMonitor.html#a77fd8eb02078b6336c63be82f0f5b393">AP_BattMonitor::healthy</a></div><div class="ttdeci">bool healthy() const </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00071">AP_BattMonitor.h:71</a></div></div>
<div class="ttc" id="AP__BattMonitor__Analog_8h_html_ad30e2aa2e3f441e417b22744c8f90e8a"><div class="ttname"><a href="AP__BattMonitor__Analog_8h.html#ad30e2aa2e3f441e417b22744c8f90e8a">AP_BATT_VOLTDIVIDER_DEFAULT</a></div><div class="ttdeci">#define AP_BATT_VOLTDIVIDER_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor__Analog_8h_source.html#l00018">AP_BattMonitor_Analog.h:18</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a858d31069c24d1df9f54d5aa8f5ffa4eaae3cc59e92d10ceeff91ae4029974118"><div class="ttname"><a href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4eaae3cc59e92d10ceeff91ae4029974118">AP_BattMonitor::BattMonitor_TYPE_ANALOG_VOLTAGE_AND_CURRENT</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00042">AP_BattMonitor.h:42</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a2275643d2998063448035e89cba6f549"><div class="ttname"><a href="classAP__BattMonitor.html#a2275643d2998063448035e89cba6f549">AP_BattMonitor::read</a></div><div class="ttdeci">void read()</div><div class="ttdoc">Read the battery voltage and current for all batteries. Should be called at 10hz. ...</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8cpp_source.html#l00178">AP_BattMonitor.cpp:178</a></div></div>
<div class="ttc" id="AP__BattMonitor__SMBus_8h_html"><div class="ttname"><a href="AP__BattMonitor__SMBus_8h.html">AP_BattMonitor_SMBus.h</a></div></div>
<div class="ttc" id="AP__BattMonitor__Analog_8h_html_ac1f3bd8a99937361877fc91c0f50b965"><div class="ttname"><a href="AP__BattMonitor__Analog_8h.html#ac1f3bd8a99937361877fc91c0f50b965">AP_BATT_CURR_AMP_PERVOLT_DEFAULT</a></div><div class="ttdeci">#define AP_BATT_CURR_AMP_PERVOLT_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor__Analog_8h_source.html#l00019">AP_BattMonitor_Analog.h:19</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a374cde9bd46870b96bf6c56bed1e1f4b"><div class="ttname"><a href="classAP__BattMonitor.html#a374cde9bd46870b96bf6c56bed1e1f4b">AP_BattMonitor::AP_BattMonitor_Analog</a></div><div class="ttdeci">friend class AP_BattMonitor_Analog</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00028">AP_BattMonitor.h:28</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a28dde9cd42525477feef95678df4466e"><div class="ttname"><a href="classAP__BattMonitor.html#a28dde9cd42525477feef95678df4466e">AP_BattMonitor::current_amps</a></div><div class="ttdeci">float current_amps() const </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00086">AP_BattMonitor.h:86</a></div></div>
<div class="ttc" id="structAP__BattMonitor_1_1BattMonitor__State_html_a8a170bff721c6e34803b4ca19408d6a9"><div class="ttname"><a href="structAP__BattMonitor_1_1BattMonitor__State.html#a8a170bff721c6e34803b4ca19408d6a9">AP_BattMonitor::BattMonitor_State::instance</a></div><div class="ttdeci">uint8_t instance</div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00049">AP_BattMonitor.h:49</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a858d31069c24d1df9f54d5aa8f5ffa4eae1cca70ba3ff7730316a34e6d5d4eda9"><div class="ttname"><a href="classAP__BattMonitor.html#a858d31069c24d1df9f54d5aa8f5ffa4eae1cca70ba3ff7730316a34e6d5d4eda9">AP_BattMonitor::BattMonitor_TYPE_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00040">AP_BattMonitor.h:40</a></div></div>
<div class="ttc" id="AP__BattMonitor_8h_html_aa8b2240f481c056b4e7d8991d5e09d8b"><div class="ttname"><a href="AP__BattMonitor_8h.html#aa8b2240f481c056b4e7d8991d5e09d8b">AP_BATT_MONITOR_MAX_INSTANCES</a></div><div class="ttdeci">#define AP_BATT_MONITOR_MAX_INSTANCES</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00010">AP_BattMonitor.h:10</a></div></div>
<div class="ttc" id="classAP__BattMonitor__Backend_html_a0aab3a98b369ed9e0e3bd2dae5a4e6ac"><div class="ttname"><a href="classAP__BattMonitor__Backend.html#a0aab3a98b369ed9e0e3bd2dae5a4e6ac">AP_BattMonitor_Backend::read</a></div><div class="ttdeci">virtual void read()=0</div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00053">AP_Param.h:53</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_a36c8688e0c08b8eac5e638fba94bf94d"><div class="ttname"><a href="classAP__BattMonitor.html#a36c8688e0c08b8eac5e638fba94bf94d">AP_BattMonitor::voltage</a></div><div class="ttdeci">float voltage() const </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00079">AP_BattMonitor.h:79</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a94ab41309b1ff10b8b862b826e59c882"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">AP_HAL::HAL::scheduler</a></div><div class="ttdeci">AP_HAL::Scheduler * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00087">HAL.h:87</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_af39d7e98bbdb2a8dc89cc093cbac3e0b"><div class="ttname"><a href="classAP__BattMonitor.html#af39d7e98bbdb2a8dc89cc093cbac3e0b">AP_BattMonitor::current_total_mah</a></div><div class="ttdeci">float current_total_mah() const </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8h_source.html#l00090">AP_BattMonitor.h:90</a></div></div>
<div class="ttc" id="classAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8cpp_source.html#l00929">AP_Param.cpp:929</a></div></div>
<div class="ttc" id="classAP__BattMonitor_html_aaed251d031fd70a8a10eeb41fc0bc901"><div class="ttname"><a href="classAP__BattMonitor.html#aaed251d031fd70a8a10eeb41fc0bc901">AP_BattMonitor::AP_BattMonitor</a></div><div class="ttdeci">AP_BattMonitor()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="AP__BattMonitor_8cpp_source.html#l00121">AP_BattMonitor.cpp:121</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 14 2015 23:43:12 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
