<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>APM:Libraries: libraries/AP_AHRS/AP_AHRS.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_85ad937bf7c11de5c2907a482c9c56bd.html">AP_AHRS</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_AHRS.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__AHRS_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  APM_AHRS.cpp</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  This program is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  (at your option) any later version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">  GNU General Public License for more details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__AHRS_8h.html">AP_AHRS.h</a>&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__AHRS_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// table of user settable parameters</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classAP__AHRS.html#ac88d8ea5756954941e568cc76670a674">AP_AHRS::var_info</a>[] = {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="comment">// index 0 and 1 are for old parameters that are no longer not used</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// @Param: GPS_GAIN</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// @DisplayName: AHRS GPS gain</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// @Description: This controls how how much to use the GPS to correct the attitude. This should never be set to zero for a plane as it would result in the plane losing control in turns. For a plane please use the default value of 1.0.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// @Range: 0.0 1.0</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// @Increment: .01</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;GPS_GAIN&quot;</span>,  2, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, gps_gain, 1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// @Param: GPS_USE</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// @DisplayName: AHRS use GPS for navigation</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// @Description: This controls whether to use dead-reckoning or GPS based navigation. If set to 0 then the GPS won&#39;t be used for navigation, and only dead reckoning will be used. A value of zero should never be used for normal flight.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;GPS_USE&quot;</span>,  3, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _gps_use, 1),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// @Param: YAW_P</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// @DisplayName: Yaw P</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// @Description: This controls the weight the compass or GPS has on the heading. A higher value means the heading will track the yaw source (GPS or compass) more rapidly.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// @Range: 0.1 0.4</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// @Increment: .01</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;YAW_P&quot;</span>, 4,    <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _kp_yaw, 0.2<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// @Param: RP_P</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// @DisplayName: AHRS RP_P</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// @Description: This controls how fast the accelerometers correct the attitude</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// @Range: 0.1 0.4</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// @Increment: .01</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;RP_P&quot;</span>,  5,    <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _kp, 0.2<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// @Param: WIND_MAX</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// @DisplayName: Maximum wind</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// @Description: This sets the maximum allowable difference between ground speed and airspeed. This allows the plane to cope with a failing airspeed sensor. A value of zero means to use the airspeed as is.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// @Range: 0 127</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// @Units: m/s</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;WIND_MAX&quot;</span>,  6,    <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _wind_max, 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// NOTE: 7 was BARO_USE</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// @Param: TRIM_X</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// @DisplayName: AHRS Trim Roll</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// @Description: Compensates for the roll angle difference between the control board and the frame. Positive values make the vehicle roll right.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// @Units: Radians</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// @Range: -0.1745 +0.1745</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// @User: User</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// @Param: TRIM_Y</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// @DisplayName: AHRS Trim Pitch</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// @Description: Compensates for the pitch angle difference between the control board and the frame. Positive values make the vehicle pitch up/back.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// @Units: Radians</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// @Range: -0.1745 +0.1745</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// @User: User</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// @Param: TRIM_Z</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// @DisplayName: AHRS Trim Yaw</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// @Description: Not Used</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// @Units: Radians</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// @Range: -0.1745 +0.1745</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// @Increment: 0.01</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;TRIM&quot;</span>, 8, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _trim, 0),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// @Param: ORIENTATION</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// @DisplayName: Board Orientation</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// @Description: Overall board orientation relative to the standard orientation for the board type. This rotates the IMU and compass readings to allow the board to be oriented in your vehicle at any 90 or 45 degree angle. This option takes affect on next boot. After changing you will need to re-level your vehicle.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw136,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENTATION&quot;</span>, 9, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _board_orientation, 0),</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// @Param: COMP_BETA</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// @DisplayName: AHRS Velocity Complementary Filter Beta Coefficient</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// @Description: This controls the time constant for the cross-over frequency used to fuse AHRS (airspeed and heading) and GPS data to estimate ground velocity. Time constant is 0.1/beta. A larger time constant will use GPS data less and a small time constant will use air data less.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// @Range: 0.001 0.5</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// @Increment: .01</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;COMP_BETA&quot;</span>,  10, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, beta, 0.1<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// @Param: GPS_MINSATS</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// @DisplayName: AHRS GPS Minimum satellites</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// @Description: Minimum number of satellites visible to use GPS for velocity based corrections attitude correction. This defaults to 6, which is about the point at which the velocity numbers from a GPS become too unreliable for accurate correction of the accelerometers.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// @Range: 0 10</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// @Increment: 1</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;GPS_MINSATS&quot;</span>, 11, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _gps_minsats, 6),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// NOTE: index 12 was for GPS_DELAY, but now removed, fixed delay</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// of 1 was found to be the best choice</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// 13 was the old EKF_USE</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#if AP_AHRS_NAVEKF_AVAILABLE</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// @Param: EKF_TYPE</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// @DisplayName: Use NavEKF Kalman filter for attitude and position estimation</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// @Description: This controls whether the NavEKF Kalman filter is used for attitude and position estimation and whether fallback to the DCM algorithm is allowed. Note that on copters &quot;disabled&quot; is not available, and will be the same as &quot;enabled - no fallback&quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled,2:Enable EKF2</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// @User: Advanced</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EKF_TYPE&quot;</span>,  14, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _ekf_type, 1),</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;};</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">// return airspeed estimate if available</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a39289d0dde31413ad172fcf2847fce4a">  130</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__AHRS.html#a39289d0dde31413ad172fcf2847fce4a">AP_AHRS::airspeed_estimate</a>(<span class="keywordtype">float</span> *airspeed_ret)<span class="keyword"> const</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a8691156c332da099e3f5952e72ae2a58">airspeed_sensor_enabled</a>()) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        *airspeed_ret = <a class="code" href="classAP__AHRS.html#a2aaf9d61606d9973dca3890ca7b91eb2">_airspeed</a>-&gt;<a class="code" href="classAP__Airspeed.html#a1027b15b91e0af1dbfe8b999a88c8a25">get_airspeed</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">_wind_max</a> &gt; 0 &amp;&amp; <a class="code" href="classAP__AHRS.html#a501ef95216a3f1bbbc97a4f6ba40d2dd">_gps</a>.<a class="code" href="classAP__GPS.html#a9093c8cf1d5a78ccd8677229bb314d37">status</a>() &gt;= <a class="code" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_OK_FIX_2D</a>) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="comment">// constrain the airspeed by the ground speed</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">// and AHRS_WIND_MAX</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordtype">float</span> gnd_speed = <a class="code" href="classAP__AHRS.html#a501ef95216a3f1bbbc97a4f6ba40d2dd">_gps</a>.<a class="code" href="classAP__GPS.html#a426041563da447ec6e9cde1926a88fdb">ground_speed</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordtype">float</span> true_airspeed = *airspeed_ret * <a class="code" href="classAP__AHRS.html#a2648b5fc68b22e83205161cf1274939c">get_EAS2TAS</a>();</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            true_airspeed = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(true_airspeed,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                            gnd_speed - <a class="code" href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">_wind_max</a>,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                            gnd_speed + <a class="code" href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">_wind_max</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            *airspeed_ret = true_airspeed / <a class="code" href="classAP__AHRS.html#a2648b5fc68b22e83205161cf1274939c">get_EAS2TAS</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">// set_trim</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a7dc27ba7ca4e7fe18a50c44c2c83845f">  150</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a7dc27ba7ca4e7fe18a50c44c2c83845f">AP_AHRS::set_trim</a>(<a class="code" href="classVector3.html">Vector3f</a> new_trim)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classVector3.html">Vector3f</a> trim;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(new_trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(new_trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.set_and_save(trim);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">// add_trim - adjust the roll and pitch trim up to a total of 10 degrees</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a783631a678ef9034b1357c9aa93e1280">  159</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a783631a678ef9034b1357c9aa93e1280">AP_AHRS::add_trim</a>(<span class="keywordtype">float</span> roll_in_radians, <span class="keywordtype">float</span> pitch_in_radians, <span class="keywordtype">bool</span> save_to_eeprom)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="classVector3.html">Vector3f</a> trim = <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.get();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// add new trim</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> + roll_in_radians, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> + pitch_in_radians, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// set new trim values</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.set(trim);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// save to eeprom</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">if</span>( save_to_eeprom ) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.save();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">// return a ground speed estimate in m/s</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#aa2fd48ce0265df723cc8d05bb2150749">  177</a></span>&#160;<a class="code" href="structVector2.html">Vector2f</a> <a class="code" href="classAP__AHRS.html#aa2fd48ce0265df723cc8d05bb2150749">AP_AHRS::groundspeed_vector</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// Generate estimate of ground speed vector using air data system</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="structVector2.html">Vector2f</a> gndVelADS;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="structVector2.html">Vector2f</a> gndVelGPS;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="Airspeed_8cpp.html#a304224bccd737323c9ee5b15cc9149ad">airspeed</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">bool</span> gotAirspeed = <a class="code" href="classAP__AHRS.html#a1c783993c43f6d833d67cebea7e82a2c">airspeed_estimate_true</a>(&amp;airspeed);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordtype">bool</span> gotGPS = (<a class="code" href="classAP__AHRS.html#a501ef95216a3f1bbbc97a4f6ba40d2dd">_gps</a>.<a class="code" href="classAP__GPS.html#a9093c8cf1d5a78ccd8677229bb314d37">status</a>() &gt;= <a class="code" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_OK_FIX_2D</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (gotAirspeed) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="classVector3.html">Vector3f</a> wind = <a class="code" href="classAP__AHRS.html#a4cdb54b496f9381a4c629cf0b10c8f8a">wind_estimate</a>();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="structVector2.html">Vector2f</a> wind2d = <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(wind.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, wind.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="structVector2.html">Vector2f</a> airspeed_vector = <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(cosf(<a class="code" href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">yaw</a>), sinf(<a class="code" href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">yaw</a>)) * <a class="code" href="Airspeed_8cpp.html#a304224bccd737323c9ee5b15cc9149ad">airspeed</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        gndVelADS = airspeed_vector - wind2d;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// Generate estimate of ground speed vector using GPS</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (gotGPS) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">float</span> cog = <a class="code" href="AP__Math_8h.html#a75b14352ec1c95a8276af9a0813cfdc3">radians</a>(<a class="code" href="classAP__AHRS.html#a501ef95216a3f1bbbc97a4f6ba40d2dd">_gps</a>.<a class="code" href="classAP__GPS.html#a94caaa8676fecb6c0c4a8a58eea3b106">ground_course_cd</a>()*0.01f);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        gndVelGPS = <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(cosf(cog), sinf(cog)) * <a class="code" href="classAP__AHRS.html#a501ef95216a3f1bbbc97a4f6ba40d2dd">_gps</a>.<a class="code" href="classAP__GPS.html#a426041563da447ec6e9cde1926a88fdb">ground_speed</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// If both ADS and GPS data is available, apply a complementary filter</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (gotAirspeed &amp;&amp; gotGPS) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">// The LPF is applied to the GPS and the HPF is applied to the air data estimate</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">// before the two are summed</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">//Define filter coefficients</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="comment">// alpha and beta must sum to one</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// beta = dt/Tau, where</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">// dt = filter time step (0.1 sec if called by nav loop)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">// Tau = cross-over time constant (nominal 2 seconds)</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">// More lag on GPS requires Tau to be bigger, less lag allows it to be smaller</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="comment">// To-Do - set Tau as a function of GPS lag.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> alpha = 1.0f - <a class="code" href="classAP__AHRS.html#a80d5ae913ca88ab8fbdcca779221c8cc">beta</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// Run LP filters</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">_lp</a> = gndVelGPS * <a class="code" href="classAP__AHRS.html#a80d5ae913ca88ab8fbdcca779221c8cc">beta</a>  + <a class="code" href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">_lp</a> * alpha;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">// Run HP filters</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">_hp</a> = (gndVelADS - <a class="code" href="classAP__AHRS.html#a8a371073599619698a9bad679a55b6d7">_lastGndVelADS</a>) + <a class="code" href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">_hp</a> * alpha;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment">// Save the current ADS ground vector for the next time step</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="classAP__AHRS.html#a8a371073599619698a9bad679a55b6d7">_lastGndVelADS</a> = gndVelADS;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// Sum the HP and LP filter outputs</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">_hp</a> + <a class="code" href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">_lp</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// Only ADS data is available return ADS estimate</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span> (gotAirspeed &amp;&amp; !gotGPS) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">return</span> gndVelADS;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// Only GPS data is available so return GPS estimate</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (!gotAirspeed &amp;&amp; gotGPS) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">return</span> gndVelGPS;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>, 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">// update_trig - recalculates _cos_roll, _cos_pitch, etc based on latest attitude</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">//      should be called after _dcm_matrix is updated</span></div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a34c0a28db3bc87426f69e34e5949bd8b">  231</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a34c0a28db3bc87426f69e34e5949bd8b">AP_AHRS::update_trig</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="structVector2.html">Vector2f</a> yaw_vector;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3f</a> &amp;<a class="code" href="RCOutput__Bebop_8cpp.html#a3cc119cb1a4beab046568bd21fcac3e5">temp</a> = <a class="code" href="classAP__AHRS.html#aeabf15a0103be3040fb4ff0de69658ab">get_dcm_matrix</a>();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// sin_yaw, cos_yaw</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    yaw_vector.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a> = temp.<a class="code" href="classMatrix3.html#acd7bf3421047fa155168a9c8e5164a2b">a</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    yaw_vector.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a> = temp.<a class="code" href="classMatrix3.html#ae16bed039ad87c3337f15837c33fe2fb">b</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    yaw_vector.<a class="code" href="structVector2.html#ace2a626eaa79412e2946216e9c3e63c6">normalize</a>();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(yaw_vector.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a>, -1.0, 1.0);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(yaw_vector.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a>, -1.0, 1.0);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// cos_roll, cos_pitch</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">float</span> cx2 = temp.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> * temp.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (cx2 &gt;= 1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a> = 0;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a> = 1.0f;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a> = <a class="code" href="AP__Math_8cpp.html#a7b812b7e8008b90ab24bcd9c3b0e8e3b">safe_sqrt</a>(1 - cx2);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a> = temp.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> / <a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(<a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a>, 0, 1.0);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a> = <a class="code" href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a>(<a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a>, -1.0, 1.0); <span class="comment">// this relies on constrain_float() of infinity doing the right thing</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// sin_roll, sin_pitch</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classAP__AHRS.html#a99bd2d830e0c1c57c6e4aba4b53d967d">_sin_pitch</a> = -temp.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AP__Math_8h.html#a108b79eeb35c5d58f324458ec9e1e9f2">is_zero</a>(<a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a>)) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">_sin_roll</a> = sinf(<a class="code" href="classAP__AHRS.html#a384a23e205126cf43e91bec9668b7ed0">roll</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">_sin_roll</a> = temp.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> / <a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// sanity checks</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (yaw_vector.<a class="code" href="structVector2.html#aa5e9fddaa1ce691bc6f3e9746e70acee">is_inf</a>() || yaw_vector.<a class="code" href="structVector2.html#a7be163e235660e630dd10600143b0374">is_nan</a>()) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        yaw_vector.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a> = 0.0f;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        yaw_vector.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a> = 0.0f;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a> = 0.0f;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a> = 1.0f;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (isinf(<a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a>) || isnan(<a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a>)) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a> = cosf(<a class="code" href="classAP__AHRS.html#a384a23e205126cf43e91bec9668b7ed0">roll</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (isinf(<a class="code" href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">_sin_roll</a>) || isnan(<a class="code" href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">_sin_roll</a>)) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <a class="code" href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">_sin_roll</a> = sinf(<a class="code" href="classAP__AHRS.html#a384a23e205126cf43e91bec9668b7ed0">roll</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">  update the centi-degree values</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a8bf3f8d2410b5456bc43b937c872e6bb">  283</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a8bf3f8d2410b5456bc43b937c872e6bb">AP_AHRS::update_cd_values</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="classAP__AHRS.html#a0c6e82280b005a339b04028b1f5ea70d">roll_sensor</a>  = <a class="code" href="AP__Math_8h.html#a420f396aeb3fce0177dead408c1c2da2">degrees</a>(<a class="code" href="classAP__AHRS.html#a384a23e205126cf43e91bec9668b7ed0">roll</a>) * 100;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classAP__AHRS.html#af3394de208d1f96457382d79ab7a8d01">pitch_sensor</a> = <a class="code" href="AP__Math_8h.html#a420f396aeb3fce0177dead408c1c2da2">degrees</a>(<a class="code" href="classAP__AHRS.html#a2aa61744614d8e0ef64803583359a56e">pitch</a>) * 100;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">yaw_sensor</a>   = <a class="code" href="AP__Math_8h.html#a420f396aeb3fce0177dead408c1c2da2">degrees</a>(<a class="code" href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">yaw</a>) * 100;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">yaw_sensor</a> &lt; 0)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">yaw_sensor</a> += 36000;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="ttc" id="classAP__AHRS_html_ac88d8ea5756954941e568cc76670a674"><div class="ttname"><a href="classAP__AHRS.html#ac88d8ea5756954941e568cc76670a674">AP_AHRS::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00344">AP_AHRS.h:344</a></div></div>
<div class="ttc" id="vector2_8h_html_a9f3739462b0605dcb64299fa289b6afe"><div class="ttname"><a href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a></div><div class="ttdeci">Vector2&lt; float &gt; Vector2f</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00163">vector2.h:163</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8691156c332da099e3f5952e72ae2a58"><div class="ttname"><a href="classAP__AHRS.html#a8691156c332da099e3f5952e72ae2a58">AP_AHRS::airspeed_sensor_enabled</a></div><div class="ttdeci">bool airspeed_sensor_enabled(void) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00262">AP_AHRS.h:262</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a384a23e205126cf43e91bec9668b7ed0"><div class="ttname"><a href="classAP__AHRS.html#a384a23e205126cf43e91bec9668b7ed0">AP_AHRS::roll</a></div><div class="ttdeci">float roll</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00194">AP_AHRS.h:194</a></div></div>
<div class="ttc" id="classAP__AHRS_html_acad24c37755823c587a684969b1cbf22"><div class="ttname"><a href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">AP_AHRS::_wind_max</a></div><div class="ttdeci">AP_Int8 _wind_max</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00427">AP_AHRS.h:427</a></div></div>
<div class="ttc" id="Airspeed_8cpp_html_a304224bccd737323c9ee5b15cc9149ad"><div class="ttname"><a href="Airspeed_8cpp.html#a304224bccd737323c9ee5b15cc9149ad">airspeed</a></div><div class="ttdeci">AP_Airspeed airspeed(aparm)</div></div>
<div class="ttc" id="classAP__AHRS_html_a4eb96371ee8cf2b4fb9f453aced2ac44"><div class="ttname"><a href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">AP_AHRS::_sin_roll</a></div><div class="ttdeci">float _sin_roll</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00488">AP_AHRS.h:488</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2648b5fc68b22e83205161cf1274939c"><div class="ttname"><a href="classAP__AHRS.html#a2648b5fc68b22e83205161cf1274939c">AP_AHRS::get_EAS2TAS</a></div><div class="ttdeci">float get_EAS2TAS(void) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00253">AP_AHRS.h:253</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2aaf9d61606d9973dca3890ca7b91eb2"><div class="ttname"><a href="classAP__AHRS.html#a2aaf9d61606d9973dca3890ca7b91eb2">AP_AHRS::_airspeed</a></div><div class="ttdeci">AP_Airspeed * _airspeed</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00455">AP_AHRS.h:455</a></div></div>
<div class="ttc" id="AP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="AP__Param_8h_html_abe1c2a65ce5455bf37f3c000b4241c00"><div class="ttname"><a href="AP__Param_8h.html#abe1c2a65ce5455bf37f3c000b4241c00">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, class, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00046">AP_Param.h:46</a></div></div>
<div class="ttc" id="AP__Common_8h_html_a728f9499baea61e7df3ae70a374f2512"><div class="ttname"><a href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a></div><div class="ttdeci">#define ToRad(x)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00065">AP_Common.h:65</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a501ef95216a3f1bbbc97a4f6ba40d2dd"><div class="ttname"><a href="classAP__AHRS.html#a501ef95216a3f1bbbc97a4f6ba40d2dd">AP_AHRS::_gps</a></div><div class="ttdeci">const AP_GPS &amp; _gps</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00464">AP_AHRS.h:464</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a75b14352ec1c95a8276af9a0813cfdc3"><div class="ttname"><a href="AP__Math_8h.html#a75b14352ec1c95a8276af9a0813cfdc3">radians</a></div><div class="ttdeci">static float radians(float deg)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00195">AP_Math.h:195</a></div></div>
<div class="ttc" id="AP__Math_8cpp_html_a7b812b7e8008b90ab24bcd9c3b0e8e3b"><div class="ttname"><a href="AP__Math_8cpp.html#a7b812b7e8008b90ab24bcd9c3b0e8e3b">safe_sqrt</a></div><div class="ttdeci">float safe_sqrt(float v)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8cpp_source.html#l00026">AP_Math.cpp:26</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2aa61744614d8e0ef64803583359a56e"><div class="ttname"><a href="classAP__AHRS.html#a2aa61744614d8e0ef64803583359a56e">AP_AHRS::pitch</a></div><div class="ttdeci">float pitch</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00195">AP_AHRS.h:195</a></div></div>
<div class="ttc" id="classMatrix3_html"><div class="ttname"><a href="classMatrix3.html">Matrix3&lt; float &gt;</a></div></div>
<div class="ttc" id="classAP__AHRS_html"><div class="ttname"><a href="classAP__AHRS.html">AP_AHRS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00048">AP_AHRS.h:48</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a27149a7dfbb14319088e8332705c0046"><div class="ttname"><a href="AP__Math_8h.html#a27149a7dfbb14319088e8332705c0046">constrain_float</a></div><div class="ttdeci">static float constrain_float(float amt, float low, float high)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00170">AP_Math.h:170</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8a371073599619698a9bad679a55b6d7"><div class="ttname"><a href="classAP__AHRS.html#a8a371073599619698a9bad679a55b6d7">AP_AHRS::_lastGndVelADS</a></div><div class="ttdeci">Vector2f _lastGndVelADS</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00481">AP_AHRS.h:481</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a63359ca9325c63642050bcf1c3e1cd63"><div class="ttname"><a href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">AP_AHRS::yaw</a></div><div class="ttdeci">float yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00196">AP_AHRS.h:196</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a39289d0dde31413ad172fcf2847fce4a"><div class="ttname"><a href="classAP__AHRS.html#a39289d0dde31413ad172fcf2847fce4a">AP_AHRS::airspeed_estimate</a></div><div class="ttdeci">virtual bool airspeed_estimate(float *airspeed_ret) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00130">AP_AHRS.cpp:130</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aa2fd48ce0265df723cc8d05bb2150749"><div class="ttname"><a href="classAP__AHRS.html#aa2fd48ce0265df723cc8d05bb2150749">AP_AHRS::groundspeed_vector</a></div><div class="ttdeci">virtual Vector2f groundspeed_vector(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00177">AP_AHRS.cpp:177</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a783631a678ef9034b1357c9aa93e1280"><div class="ttname"><a href="classAP__AHRS.html#a783631a678ef9034b1357c9aa93e1280">AP_AHRS::add_trim</a></div><div class="ttdeci">virtual void add_trim(float roll_in_radians, float pitch_in_radians, bool save_to_eeprom=true)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00159">AP_AHRS.cpp:159</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a0c6e82280b005a339b04028b1f5ea70d"><div class="ttname"><a href="classAP__AHRS.html#a0c6e82280b005a339b04028b1f5ea70d">AP_AHRS::roll_sensor</a></div><div class="ttdeci">int32_t roll_sensor</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00199">AP_AHRS.h:199</a></div></div>
<div class="ttc" id="classAP__AHRS_html_adedc7b6972ea5295658549c3a4d357cf"><div class="ttname"><a href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">AP_AHRS::_lp</a></div><div class="ttdeci">Vector2f _lp</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00479">AP_AHRS.h:479</a></div></div>
<div class="ttc" id="structVector2_html_aa5e9fddaa1ce691bc6f3e9746e70acee"><div class="ttname"><a href="structVector2.html#aa5e9fddaa1ce691bc6f3e9746e70acee">Vector2::is_inf</a></div><div class="ttdeci">bool is_inf(void) const </div><div class="ttdef"><b>Definition:</b> <a href="vector2_8cpp_source.html#l00073">vector2.cpp:73</a></div></div>
<div class="ttc" id="classAP__GPS_html_a426041563da447ec6e9cde1926a88fdb"><div class="ttname"><a href="classAP__GPS.html#a426041563da447ec6e9cde1926a88fdb">AP_GPS::ground_speed</a></div><div class="ttdeci">float ground_speed(uint8_t instance) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8h_source.html#l00203">AP_GPS.h:203</a></div></div>
<div class="ttc" id="structVector2_html_a6cfed8355591aa269f4dba43bd806ef9"><div class="ttname"><a href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">Vector2::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00040">vector2.h:40</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a4cdb54b496f9381a4c629cf0b10c8f8a"><div class="ttname"><a href="classAP__AHRS.html#a4cdb54b496f9381a4c629cf0b10c8f8a">AP_AHRS::wind_estimate</a></div><div class="ttdeci">virtual Vector3f wind_estimate(void)=0</div></div>
<div class="ttc" id="classAP__AHRS_html_a871b43cfe1eb9237ed763d83d4d3cbe2"><div class="ttname"><a href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">AP_AHRS::_hp</a></div><div class="ttdeci">Vector2f _hp</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00480">AP_AHRS.h:480</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a7dc27ba7ca4e7fe18a50c44c2c83845f"><div class="ttname"><a href="classAP__AHRS.html#a7dc27ba7ca4e7fe18a50c44c2c83845f">AP_AHRS::set_trim</a></div><div class="ttdeci">virtual void set_trim(Vector3f new_trim)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00150">AP_AHRS.cpp:150</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00015">HAL.h:15</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a99bd2d830e0c1c57c6e4aba4b53d967d"><div class="ttname"><a href="classAP__AHRS.html#a99bd2d830e0c1c57c6e4aba4b53d967d">AP_AHRS::_sin_pitch</a></div><div class="ttdeci">float _sin_pitch</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00488">AP_AHRS.h:488</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a1b78799772ad2c3adfd4ea2b422a704d"><div class="ttname"><a href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">AP_AHRS::_sin_yaw</a></div><div class="ttdeci">float _sin_yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00488">AP_AHRS.h:488</a></div></div>
<div class="ttc" id="classAP__AHRS_html_af3394de208d1f96457382d79ab7a8d01"><div class="ttname"><a href="classAP__AHRS.html#af3394de208d1f96457382d79ab7a8d01">AP_AHRS::pitch_sensor</a></div><div class="ttdeci">int32_t pitch_sensor</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00200">AP_AHRS.h:200</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8bf3f8d2410b5456bc43b937c872e6bb"><div class="ttname"><a href="classAP__AHRS.html#a8bf3f8d2410b5456bc43b937c872e6bb">AP_AHRS::update_cd_values</a></div><div class="ttdeci">void update_cd_values(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00283">AP_AHRS.cpp:283</a></div></div>
<div class="ttc" id="DerivativeFilter_8cpp_html_a357394e0f6f88c8a57bd893ab28dc8f8"><div class="ttname"><a href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a></div><div class="ttdeci">#define f(i)</div></div>
<div class="ttc" id="structVector2_html"><div class="ttname"><a href="structVector2.html">Vector2&lt; float &gt;</a></div></div>
<div class="ttc" id="classVector3_html_a561df88b28e106e337a25bb86554a569"><div class="ttname"><a href="classVector3.html#a561df88b28e106e337a25bb86554a569">Vector3::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00070">vector3.h:70</a></div></div>
<div class="ttc" id="classMatrix3_html_a7efa0e7bd4c621a7fe76cd9168960b94"><div class="ttname"><a href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">Matrix3::c</a></div><div class="ttdeci">Vector3&lt; T &gt; c</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00051">matrix3.h:51</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a108b79eeb35c5d58f324458ec9e1e9f2"><div class="ttname"><a href="AP__Math_8h.html#a108b79eeb35c5d58f324458ec9e1e9f2">is_zero</a></div><div class="ttdeci">static bool is_zero(const float fVal1)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00078">AP_Math.h:78</a></div></div>
<div class="ttc" id="classVector3_html_ab3e7f5401dd6e951978bfa746809f74f"><div class="ttname"><a href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">Vector3::z</a></div><div class="ttdeci">T z</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00070">vector3.h:70</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aeabf15a0103be3040fb4ff0de69658ab"><div class="ttname"><a href="classAP__AHRS.html#aeabf15a0103be3040fb4ff0de69658ab">AP_AHRS::get_dcm_matrix</a></div><div class="ttdeci">virtual const Matrix3f &amp; get_dcm_matrix(void) const  =0</div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00078">AP_Param.h:78</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a1c783993c43f6d833d67cebea7e82a2c"><div class="ttname"><a href="classAP__AHRS.html#a1c783993c43f6d833d67cebea7e82a2c">AP_AHRS::airspeed_estimate_true</a></div><div class="ttdeci">bool airspeed_estimate_true(float *airspeed_ret) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00244">AP_AHRS.h:244</a></div></div>
<div class="ttc" id="AP__AHRS_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__AHRS_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00010">AC_PID_test.cpp:10</a></div></div>
<div class="ttc" id="classAP__GPS_html_a9093c8cf1d5a78ccd8677229bb314d37"><div class="ttname"><a href="classAP__GPS.html#a9093c8cf1d5a78ccd8677229bb314d37">AP_GPS::status</a></div><div class="ttdeci">GPS_Status status(uint8_t instance) const </div><div class="ttdoc">Query GPS status. </div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8h_source.html#l00139">AP_GPS.h:139</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a420f396aeb3fce0177dead408c1c2da2"><div class="ttname"><a href="AP__Math_8h.html#a420f396aeb3fce0177dead408c1c2da2">degrees</a></div><div class="ttdeci">static float degrees(float rad)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00200">AP_Math.h:200</a></div></div>
<div class="ttc" id="classAP__GPS_html_a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_OK_FIX_2D</a></div><div class="ttdoc">Receiving valid messages and 2D lock. </div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8h_source.html#l00078">AP_GPS.h:78</a></div></div>
<div class="ttc" id="RCOutput__Bebop_8cpp_html_a3cc119cb1a4beab046568bd21fcac3e5"><div class="ttname"><a href="RCOutput__Bebop_8cpp.html#a3cc119cb1a4beab046568bd21fcac3e5">temp</a></div><div class="ttdeci">uint8_t temp</div><div class="ttdef"><b>Definition:</b> <a href="RCOutput__Bebop_8cpp_source.html#l00027">RCOutput_Bebop.cpp:27</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a80d5ae913ca88ab8fbdcca779221c8cc"><div class="ttname"><a href="classAP__AHRS.html#a80d5ae913ca88ab8fbdcca779221c8cc">AP_AHRS::beta</a></div><div class="ttdeci">AP_Float beta</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00425">AP_AHRS.h:425</a></div></div>
<div class="ttc" id="AP__AHRS_8h_html"><div class="ttname"><a href="AP__AHRS_8h.html">AP_AHRS.h</a></div></div>
<div class="ttc" id="structVector2_html_a7be163e235660e630dd10600143b0374"><div class="ttname"><a href="structVector2.html#a7be163e235660e630dd10600143b0374">Vector2::is_nan</a></div><div class="ttdeci">bool is_nan(void) const </div><div class="ttdef"><b>Definition:</b> <a href="vector2_8cpp_source.html#l00067">vector2.cpp:67</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a0bd52134b07d344dfef3dc94c72e9dff"><div class="ttname"><a href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">AP_AHRS::_cos_roll</a></div><div class="ttdeci">float _cos_roll</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00487">AP_AHRS.h:487</a></div></div>
<div class="ttc" id="structVector2_html_a78fa1f2ed5e261c7fbeb8f3536a1ee34"><div class="ttname"><a href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">Vector2::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00040">vector2.h:40</a></div></div>
<div class="ttc" id="AP__AHRS_8h_html_abb6a68205ef997ce848fafe7f22beb87"><div class="ttname"><a href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a></div><div class="ttdeci">#define AP_AHRS_TRIM_LIMIT</div><div class="ttdoc">-*- tab-width: 4; Mode: C++; c-basic-offset: 4; indent-tabs-mode: nil -*- </div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00036">AP_AHRS.h:36</a></div></div>
<div class="ttc" id="structVector2_html_ace2a626eaa79412e2946216e9c3e63c6"><div class="ttname"><a href="structVector2.html#ace2a626eaa79412e2946216e9c3e63c6">Vector2::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00127">vector2.h:127</a></div></div>
<div class="ttc" id="classAP__GPS_html_a94caaa8676fecb6c0c4a8a58eea3b106"><div class="ttname"><a href="classAP__GPS.html#a94caaa8676fecb6c0c4a8a58eea3b106">AP_GPS::ground_course_cd</a></div><div class="ttdeci">int32_t ground_course_cd(uint8_t instance) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8h_source.html#l00216">AP_GPS.h:216</a></div></div>
<div class="ttc" id="classVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="classMatrix3_html_ae16bed039ad87c3337f15837c33fe2fb"><div class="ttname"><a href="classMatrix3.html#ae16bed039ad87c3337f15837c33fe2fb">Matrix3::b</a></div><div class="ttdeci">Vector3&lt; T &gt; b</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00051">matrix3.h:51</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a34c0a28db3bc87426f69e34e5949bd8b"><div class="ttname"><a href="classAP__AHRS.html#a34c0a28db3bc87426f69e34e5949bd8b">AP_AHRS::update_trig</a></div><div class="ttdeci">void update_trig(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00231">AP_AHRS.cpp:231</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aa6a48349ade83ef20981f85bf5364cb5"><div class="ttname"><a href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">AP_AHRS::_trim</a></div><div class="ttdeci">AP_Vector3f _trim</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00467">AP_AHRS.h:467</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8a160130dd99016a19abab9d85917261"><div class="ttname"><a href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">AP_AHRS::yaw_sensor</a></div><div class="ttdeci">int32_t yaw_sensor</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00201">AP_AHRS.h:201</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a31317890a8768d2896b339e23147bada"><div class="ttname"><a href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">AP_AHRS::_cos_yaw</a></div><div class="ttdeci">float _cos_yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00487">AP_AHRS.h:487</a></div></div>
<div class="ttc" id="classMatrix3_html_acd7bf3421047fa155168a9c8e5164a2b"><div class="ttname"><a href="classMatrix3.html#acd7bf3421047fa155168a9c8e5164a2b">Matrix3::a</a></div><div class="ttdeci">Vector3&lt; T &gt; a</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00051">matrix3.h:51</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a7d767db49bc14c505049e93ab11e793c"><div class="ttname"><a href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">AP_AHRS::_cos_pitch</a></div><div class="ttdeci">float _cos_pitch</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00487">AP_AHRS.h:487</a></div></div>
<div class="ttc" id="classAP__Airspeed_html_a1027b15b91e0af1dbfe8b999a88c8a25"><div class="ttname"><a href="classAP__Airspeed.html#a1027b15b91e0af1dbfe8b999a88c8a25">AP_Airspeed::get_airspeed</a></div><div class="ttdeci">float get_airspeed(void) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__Airspeed_8h_source.html#l00070">AP_Airspeed.h:70</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00053">AP_Param.h:53</a></div></div>
<div class="ttc" id="classVector3_html_a1a0f7e168c71ca798099f0ba8a444244"><div class="ttname"><a href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">Vector3::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00070">vector3.h:70</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 14 2015 23:43:12 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
